(function(e){e.paramquery=e.paramquery||{};e.paramquery.pqgrid=e.paramquery.pqgrid||{};e.paramquery.xmlToArray=function(t,n){var r=n.itemParent;var i=n.itemNames;var s=[];var o=e(t).find(r);o.each(function(t,n){var r=e(n);var o=[];e(i).each(function(e,t){o.push(r.find(t).text())});s.push(o)});return s};e.paramquery.xmlToJson=function(t,n){var r=n.itemParent;var i=n.itemNames;var s=[];var o=e(t).find(r);o.each(function(t,n){var r=e(n);var o={};for(var u=0,a=i.length;u<a;u++){var f=i[u];o[f]=r.find(f).text()}s.push(o)});return s};e.paramquery.tableToArray=function(t){var n=e(t);var r=[];var i=[];var s=[];var o=[];var u=n.find("tr:first");var a=n.find("tr:eq(1)");u.find("th,td").each(function(t,n){var i=e(n);var s=i.html();var o=i.width();var u="string";var f=a.find("td:eq("+t+")");var l=f.text();var c=f.attr("align");l=l.replace(/,/g,"");if(parseInt(l)==l&&(parseInt(l)+"").length==l.length){u="integer"}else{if(parseFloat(l)==l){u="float"}}var h={title:s,width:o,dataType:u,align:c,dataIndx:t};r.push(h)});n.find("tr").each(function(t,n){if(t==0){return}var r=e(n);var s=[];r.find("td").each(function(t,n){s.push(e.trim(e(n).html()))});i.push(s)});return{data:i,colModel:r}};e.paramquery.formatCurrency=function(e){e=Math.round(e*10)/10;e=e+"";if(e.indexOf(".")==-1){e=e+".0"}var t=e.length;var n=e.substring(0,t-2),r=e.substring(t-2,t),i=n.match(/\d/g).reverse(),s=[];for(var o=0;o<i.length;o++){if(o>0&&o%3==0){s.push(",")}s.push(i[o])}s=s.reverse();n=s.join("");return n+r};e.paramquery.validation={is:function(e,t){if(e=="string"||!e){return true}e=e.substring(0,1).toUpperCase()+e.substring(1,e.length);return this["is"+e](t)},isFloat:function(e){var t=parseFloat(e);if(!isNaN(t)&&t==e){return true}else{return false}},isInteger:function(e){var t=parseInt(e);if(!isNaN(t)&&t==e){return true}else{return false}},isDate:function(e){var t=Date.parse(e);if(!isNaN(t)){return true}else{return false}}}})(jQuery);(function(e){var t={};t.options={curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20};t._regional={strDisplay:"Displaying {0} to {1} of {2} items.",strFirstPage:"First Page",strLastPage:"Last Page",strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"Records per page:{0}"};e.extend(t.options,t._regional);t._create=function(){var t=this,n=this.options;this.element.addClass("pq-pager");this.first=e("<button type='button' title='"+n.strFirstPage+"'></button>",{}).appendTo(this.element).button({icons:{primary:"ui-icon-seek-first"},text:false}).bind("click.paramquery",function(e){if(t.options.curPage>1){if(t._trigger("change",e,{curPage:1})!==false){t.option({curPage:1})}}});this.prev=e("<button type='button' title='"+n.strPrevPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-prev"},text:false}).bind("click",function(e){if(t.options.curPage>1){var n=t.options.curPage-1;if(t._trigger("change",e,{curPage:n})!==false){t.option({curPage:n})}}});e("<span class='pq-separator'></span>").appendTo(this.element);this.pageHolder=e("<span class='pq-page-placeholder'></span>").appendTo(this.element);e("<span class='pq-separator'></span>").appendTo(this.element);this.next=e("<button type='button' title='"+this.options.strNextPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-next"},text:false}).bind("click",function(e){var n=t.options.curPage+1;if(t._trigger("change",e,{curPage:n})!==false){t.option({curPage:n})}});this.last=e("<button type='button' title='"+this.options.strLastPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-end"},text:false}).bind("click",function(e){var n=t.options.totalPages;if(t._trigger("change",e,{curPage:n})!==false){t.option({curPage:n})}});e("<span class='pq-separator'></span>").appendTo(this.element);this.rPPHolder=e("<span class='pq-page-placeholder'></span>").appendTo(this.element);this.$refresh=e("<button type='button' title='"+this.options.strRefresh+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-refresh"},text:false}).bind("click",function(e){if(t._trigger("refresh",e)!==false){}});e("<span class='pq-separator'></span>").appendTo(this.element);this.$msg=e("<span class='pq-pager-msg'></span>").appendTo(this.element);this._refresh()};t._refreshPage=function(){var t=this;this.pageHolder.empty();var n=this.options,r=n.strPage,i=r.split(" "),s=[];for(var o=0,u=i.length;o<u;o++){var a=i[o];if(a=="{0}"){s.push("<input type='text' tabindex='0' class='ui-corner-all' />")}else{if(a=="{1}"){s.push("<span class='total'></span>")}else{s.push("<span>",a,"</span>")}}}var f=s.join("");var l=e(f).appendTo(this.pageHolder);this.page=l.filter("input").bind("change",function(r){var i=e(this),s=i.val();if(isNaN(s)||s<1){i.val(n.curPage);return false}s=parseInt(s);if(s>n.totalPages){i.val(n.curPage);return false}if(t._trigger("change",r,{curPage:s})!==false){t.option({curPage:s})}else{i.val(n.curPage);return false}});this.$total=l.filter("span.total")};t._refresh=function(){this._refreshPage();var t=this.$rPP,n=this,r=this.options;this.first.attr("title",r.strFirstPage);this.prev.attr("title",r.strPrevPage);this.next.attr("title",r.strNextPage);this.last.attr("title",r.strLastPage);this.$refresh.attr("title",r.strRefresh);this.rPPHolder.empty();if(r.strRpp){var i=r.rPPOptions,s=r.strRpp;if(s.indexOf("{0}")!=-1){var o=["<select class='ui-corner-all'>"];for(var u=0,a=i.length;u<a;u++){var f=i[u];o.push('<option value="',f,'">',f,"</option>")}o.push("</select>");var l=o.join("");s=s.replace("{0}","</span>"+l);s="<span>"+s+"<span class='pq-separator'></span>"}else{s="<span>"+s+"</span><span class='pq-separator'></span>"}this.$rPP=e(s).appendTo(this.rPPHolder).filter("select").val(r.rPP).change(function(t){var r=e(this).val();if(n._trigger("change",t,{rPP:r})!==false){n.options.rPP=r;return false}})}if(r.curPage>=r.totalPages){this.next.button({disabled:true});this.last.button({disabled:true})}else{this.next.button({disabled:false});this.last.button({disabled:false})}if(r.curPage<=1){this.first.button({disabled:true});this.prev.button({disabled:true})}else{this.first.button({disabled:false});this.prev.button({disabled:false})}this.page.val(r.curPage);this.$total.text(r.totalPages);if(this.options.totalRecords>0){var c=r.rPP;var h=r.curPage;var p=r.totalRecords;var d=(h-1)*c;var v=h*c;if(v>p){v=p}var m=r.strDisplay;m=m.replace("{0}",d+1);m=m.replace("{1}",v);m=m.replace("{2}",p);this.$msg.html(m)}else{this.$msg.html("")}};t._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()};t._setOption=function(e,t){if(e=="curPage"||e=="totalPages"){t=parseInt(t)}this._super.call(this,e,t)};t._setOptions=function(){this._super.apply(this,arguments);this._refresh()};e.widget("paramquery.pqPager",t);e.paramquery.pqPager.regional={};e.paramquery.pqPager.regional.en=t._regional})(jQuery);(function(e){var t={};t.options={length:200,num_eles:3,cur_pos:0,ratio:0,timeout:350,pace:"optimum",direction:"vertical",theme:false};t._destroy=function(){this.element.removeClass("pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty();this.element.removeData()};t._create=function(){this._createLayout()};t._createLayout=function(){var t=this,n=this.options,r=n.direction,i=n.theme;var s=this.element.empty();if(r=="vertical"){s.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb-vert");if(i){s.addClass("pq-sb-vert-t");s.html(["<div class='top-btn pq-sb-btn ui-state-default ui-corner-top'>","<div class='ui-icon ui-icon-triangle-1-n'></div></div>","<div class='pq-sb-slider ui-corner-all ui-state-default'>","</div>","<div class='bottom-btn pq-sb-btn ui-state-default ui-corner-bottom'>","<div class='ui-icon ui-icon-triangle-1-s'></div></div>"].join(""))}else{s.addClass("pq-sb-vert-wt");s.html(["<div class='top-btn pq-sb-btn'></div>","<div class='pq-sb-slider'>","<div class='vert-slider-top'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-center'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-bottom'></div>","</div>","<div class='bottom-btn pq-sb-btn'></div>"].join(""))}}else{s.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb-horiz");if(i){s.addClass("pq-sb-horiz-t");s.html(["<div class='left-btn pq-sb-btn ui-state-default ui-corner-left'>","<div class='ui-icon ui-icon-triangle-1-w'></div></div>","<div class='pq-sb-slider pq-sb-slider-h ui-state-default ui-corner-all'>","</div>","<div class='right-btn pq-sb-btn ui-state-default ui-corner-right'>","<div class='ui-icon ui-icon-triangle-1-e'></div></div>"].join(""))}else{s.addClass("pq-sb-horiz-wt");s.width(this.width);s.html(["<div class='left-btn pq-sb-btn'></div>","<div class='pq-sb-slider pq-sb-slider-h'>","<span class='horiz-slider-left'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-center'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-right'></span>","</div>","<div class='right-btn pq-sb-btn'></div>"].join(""))}}s.disableSelection().unbind(".pq-scrollbar").on("mouseup.pq-scrollbar",function(e){t._mouseup(e)}).on("mousedown.pq-scrollbar",function(e){if(n.disabled){return}if(t.$slider.is(":hidden")){return}if(r=="vertical"){var i=e.pageY,s=t.element.offset().top,o=s+n.length,u=t.$slider,a=u.offset().top,f=u.height(),l=a+f;if(i<a&&i>s+17){t.mousedownInterval=window.setInterval(function(){if(i>=u.offset().top){window.clearInterval(t.mousedownInterval);t.mousedownInterval=null}else{t._pageUp(e)}},0)}else{if(i>l&&i<o-17){t.mousedownInterval=window.setInterval(function(){if(i<=u.offset().top+f){window.clearInterval(t.mousedownInterval);t.mousedownInterval=null}else{t._pageDown(e)}},0)}}}else{var c=e.pageX,s=t.element.offset().left,o=s+n.length,a=t.$slider.offset().left,l=a+t.$slider.width();if(c<a&&c>s+17){t.$slider.css("left",c-t.element.offset().left);t._updateCurPosAndTrigger(e)}else{if(c>l&&c<o-17){t.$slider.css("left",c-t.element.offset().left-t.$slider.width());t._updateCurPosAndTrigger(e)}}}});var o=this.$slider=e("div.pq-sb-slider",this.element);if(i){o.attr("tabindex","0")}this._bindSliderEvents(o);this.$top_btn=e("div.top-btn,div.left-btn",this.element).click(function(e){if(t.options.disabled){return}t.decr_cur_pos(e);e.preventDefault();return false}).mousedown(function(e){if(t.options.disabled){return}t.mousedownTimeout=window.setTimeout(function(){t.mousedownInterval=window.setInterval(function(){t.decr_cur_pos(e)},0)},t.options.timeout)}).bind("mouseup mouseout",function(e){t._mouseup(e)});this.$bottom_btn=e("div.bottom-btn,div.right-btn",this.element).click(function(e){if(t.options.disabled){return}t.incr_cur_pos(e);e.preventDefault();return false}).mousedown(function(e){if(t.options.disabled){return}t.mousedownTimeout=window.setTimeout(function(){t.mousedownInterval=window.setInterval(function(){t.incr_cur_pos(e)},0)},t.options.timeout)}).bind("mouseup mouseout",function(e){t._mouseup(e)});this._refresh()};t._bindSliderEvents=function(t){var n=this,r=this.options.direction,i="x";if(r=="vertical"){i="y"}t.draggable({axis:i,helper:function(e,t){n._setDragLimits();return this},start:function(e){n.topWhileDrag=null},drag:function(e){n.dragging=true;var t=n.options.pace;if(t=="optimum"){n._setNormalPace(e)}else{if(t=="fast"){n._updateCurPosAndTrigger(e)}}},stop:function(e){n._updateCurPosAndTrigger(e);n.dragging=false}}).on("keydown.pq-scrollbar",function(t){var r=t.keyCode,i=n.options,s=i.cur_pos,o=i.ratio,u=i.num_eles,a=e.ui.keyCode;if(n.keydownTimeout==null){n.keydownTimeout=window.setTimeout(function(){if(r==a.DOWN||r==a.RIGHT){n.incr_cur_pos(t)}else{if(r==a.UP||r==a.LEFT){n.decr_cur_pos(t)}else{if(r==a.HOME){if(i.steps){if(s>0){i.cur_pos=0;n.updateSliderPos();n.scroll(t)}}else{if(o>0){i.ratio=0;n.updateSliderPos();n.drag(t)}}}else{if(r==a.END){if(i.steps){if(s<u){i.cur_pos=u;n.updateSliderPos();n.scroll(t)}}else{if(o<1){i.ratio=1;n.updateSliderPos();n.drag(t)}}}else{if(i.direction=="vertical"){if(r==a.PAGE_DOWN){n._pageDown(t)}else{if(r==a.PAGE_UP){n._pageUp(t)}}}}}}}n.keydownTimeout=null},0)}if(r==a.DOWN||r==a.RIGHT||r==a.UP||r==a.LEFT||r==a.PAGE_DOWN||r==a.PAGE_UP||r==a.HOME||r==a.END){t.preventDefault();return false}})};t.decr_cur_pos=function(e){var t=this,n=t.options,r=n.steps;if(r){if(n.cur_pos>0){n.cur_pos--;t.updateSliderPos();t.scroll(e)}}else{if(n.ratio>0){var i=n.ratio-1/(n.num_eles-1);if(i<0){i=0}n.ratio=i;t.updateSliderPos();t.drag(e)}}};t.incr_cur_pos=function(e){var t=this,n=t.options,r=n.steps;if(r){if(n.cur_pos<n.num_eles-1){n.cur_pos++}t.updateSliderPos();t.scroll(e)}else{if(n.ratio<1){var i=n.ratio+1/(n.num_eles-1);if(i>1){i=1}n.ratio=i}t.updateSliderPos();t.drag(e)}};t._mouseup=function(e){if(this.options.disabled){return}var t=this;window.clearTimeout(t.mousedownTimeout);t.mousedownTimeout=null;window.clearInterval(t.mousedownInterval);t.mousedownInterval=null};t._setDragLimits=function(){var e=this.options;if(e.direction=="vertical"){var t=this.element.offset().top+17;var n=t+e.length-34-this.slider_length;this.$slider.draggable("option","containment",[0,t,0,n])}else{t=this.element.offset().left+17;n=t+e.length-34-this.slider_length;this.$slider.draggable("option","containment",[t,0,n,0])}};t._refresh=function(){var e=this.options;if(e.num_eles<=1){this.element.css("display","none")}else{this.element.css("display","")}this._validateCurPos();this.$slider.css("display","");if(e.direction=="vertical"){this.element.height(e.length);this._setSliderBgLength();this.scroll_space=e.length-34-this.slider_length;if(this.scroll_space<4||e.num_eles<=1){this.$slider.css("display","none")}this.updateSliderPos(e.cur_pos)}else{this.element.width(e.length);this._setSliderBgLength();this.scroll_space=e.length-34-this.slider_length;if(this.scroll_space<4||e.num_eles<=1){this.$slider.css("display","none")}this.updateSliderPos(e.cur_pos)}};t._setSliderBgLength=function(){var t=this.options,n=t.theme,r=t.length,i=t.num_eles*40+r,s=r-34,o=s*r/i,u=Math.round((o-(8+3+3))/2);if(u<1){u=1}this.slider_length=8+3+3+2*u;if(t.direction=="vertical"){if(n){this.$slider.height(this.slider_length-2)}else{e("div.vert-slider-bg",this.element).height(u);this.$slider.height(this.slider_length)}}else{if(n){this.$slider.width(this.slider_length-2)}else{e(".horiz-slider-bg",this.element).width(u);this.$slider.width(this.slider_length)}}};t._updateCurPosAndTrigger=function(e,t){var n=this,r=this.options,i=r.direction,s=n.$slider;if(t==null){t=i=="vertical"?parseInt(s[0].style.top,10):parseInt(s[0].style.left,10)}var o=r.length-34-this.slider_length;var u=(t-17)/o;if(r.steps){var a=u*(r.num_eles-1);a=Math.round(a);if(r.cur_pos!=a){if(this.dragging){if(this.topWhileDrag!=null){if(this.topWhileDrag<t&&r.cur_pos>a){return}else{if(this.topWhileDrag>t&&r.cur_pos<a){return}}}this.topWhileDrag=t}n.options.cur_pos=a;this.scroll(e)}}else{r.ratio=u;this.drag(e)}};t._setNormalPace=function(e){if(this.timer){window.clearInterval(this.timer);this.timer=null}var t=this,n=this.options,r=n.direction;t.timer=window.setInterval(function(){var n=t.$slider;var i=r=="vertical"?parseInt(n[0].style.top,10):parseInt(n[0].style.left,10);if(t.prev_top==i){t._updateCurPosAndTrigger(e,i);window.clearInterval(t.timer);t.timer=null}t.prev_top=i},20)};t.setNumEles=function(e){this.options.num_eles=e;this.updateSliderPos()};t._validateCurPos=function(){var e=this.options;if(e.cur_pos>=e.num_eles){e.cur_pos=e.num_eles-1}if(e.cur_pos<0){e.cur_pos=0}};t._updateSliderPosRatio=function(){var e=this,t=this.options,n=t.direction,r=t.ratio,i=e.$slider,s=t.length-34-this.slider_length;if(r==null){throw"ration N/A"}var o=r*s+17;if(n=="vertical"){i.css("top",o)}else{i.css("left",o)}};t._updateSliderPosCurPos=function(){var e=this.options;var t=this.scroll_space*e.cur_pos/(e.num_eles-1);if(e.direction=="vertical"){this.$slider.css("top",17+t)}else{this.$slider.css("left",17+t)}};t.updateSliderPos=function(){var e=this.options;if(e.steps===undefined){throw"assert failed. steps N/A"}if(e.steps){this._updateSliderPosCurPos()}else{this._updateSliderPosRatio()}};t.scroll=function(e){var t=this.options;this._trigger("scroll",e,{cur_pos:t.cur_pos,num_eles:t.num_eles})};t.drag=function(e){var t=this,n=t.options;this._trigger("drag",e,{ratio:n.ratio})};t._pageDown=function(e){this._trigger("pageDown",e,null)};t._pageUp=function(e){this._trigger("pageUp",e,null)};t._setOption=function(e,t){if(e=="disabled"){this._super.call(this,e,t);if(t==true){this.$slider.draggable("disable")}else{this.$slider.draggable("enable")}}else{if(e=="theme"){this._super.call(this,e,t);this._createLayout()}else{if(e=="ratio"){if(t>=0&&t<=1){this._super.call(this,e,t)}else{}}else{this._super.call(this,e,t)}}}};t._setOptions=function(){this._super.apply(this,arguments);this._refresh()};e.widget("paramquery.pqScrollBar",t)})(jQuery);(function(e){var t=function(){};t.prototype.belongs=function(e){if(e.target==this.that.element[0]){return true}};e.paramquery.cClass=t;var n=function(e){this.that=e;this.hidearrHS1=[];this.options=e.options;this.offset=null};e.paramquery.cGenerateView=n;var r=n.prototype;r.generateView=function(t){var n=this,r=this.that,i=r.options,s=i.freezeCols,o=i.virtualX,u=i.virtualY,a=r.colModel,l,c,h=r.initH,p=r.finalH,d=i.groupModel,v=r.pqpanes;if(t){var m=this._generateTables(null,null,t),g=t.$cont;g.empty();if(v.v){g.append(["<div class='pq-cont-inner'>",m,"</div>","<div class='pq-cont-inner'>",m,"</div>"].join(""))}else{g.append("<div class='pq-cont-inner'>"+m+"</div>")}var y=g.children("div"),b=y.children("table"),w=b[0].scrollHeight-1;g.height(w);if(v.v){var E=e(y[0]),S=b[0].scrollWidth,x=e(y[1]);var T=e(b[1]);var N=f.call(r,-1,s);var C=f.call(r,s,h);E.css({width:N,zIndex:1});x.css({left:N-1,width:S,position:"absolute",height:w});T.css({left:-1*(C+N)})}if(!r.tables){r.tables=[]}var k=-1;for(var L=0;L<r.tables.length;L++){var A=r.tables[L].cont;if(A==t.$cont[0]){k=L}}if(k==-1){r.tables.push({$tbl:b,cont:t.$cont[0]})}else{r.tables[k].$tbl=b}}else{r._bufferObj_calcInitFinal();l=r.initV;c=r.finalV;var O=d?r.dataGM:r.data;var g=r.$cont;if(i.editModel.indices!=null){r.blurEditor({force:true})}var m=n._generateTables(l,c,t);g.empty();if(r.totalVisibleRows===0){g.append("<div class='pq-cont-inner pq-grid-norows' >"+i.strNoRows+"</div>")}else{if(v.h&&v.v){g.append(["<div class='pq-cont-inner'>",m,"</div>","<div class='pq-cont-inner'>",m,"</div>","<div class='pq-cont-inner'>",m,"</div>","<div class='pq-cont-inner'>",m,"</div>"].join(""))}else{if(v.h||v.v){g.append(["<div class='pq-cont-inner'>",m,"</div>","<div class='pq-cont-inner'>",m,"</div>"].join(""))}else{g.append("<div class='pq-cont-inner'>"+m+"</div>")}}}r.$tbl=g.children("div").children("table");r._fixTableViewPort();r._trigger("afterTable",null,{dataModel:i.dataModel,colModel:a,pageData:O,initV:l,finalV:c,initH:h,finalH:p})}r._saveDims();this.scrollView();if(!t){r._trigger("refresh",null,{dataModel:i.dataModel,colModel:a,pageData:O,initV:l,finalV:c,initH:h,finalH:p})}r._saveDims();this.scrollView()};r.scrollView=function(){var e=this.that,t=this.options,n=t.virtualX,r=t.virtualY;if(!n){e.$hscroll.pqScrollBar("drag")}if(!r){e.$vscroll.pqScrollBar("drag")}};r.setPanes=function(){var t=this.that,n=t.$cont,r=t.pqpanes,i=n.children("div"),s=t.$tbl,o=t.options,u=parseInt(o.freezeCols),a=t.initH,l,c,h;if(s&&s.length){var p=s[0].scrollWidth;if(r.h&&r.v){var d=e(i[0]),v=e(i[1]),m=e(s[1]),g=e(i[2]),y=e(s[2]),b=e(i[3]),w=e(s[3]);l=f.call(t,-1,u);var h=t.calcHeightFrozenRows();d.css({width:l,height:h,zIndex:2});v.css({left:l,width:p,height:h,position:"absolute"});m.css({left:-1*l});g.css({width:l,zIndex:1,top:h,position:"absolute"});y.css({top:-h});b.css({left:l,width:p,zIndex:1,top:h,position:"absolute"});w.css({top:-h,left:-1*l})}else{if(r.v){var E=e(i[0]);var S=e(i[1]);var x=e(s[1]);l=f.call(t,-1,u);c=f.call(t,u,a);E.css({width:l,zIndex:1});S.css({left:l,width:p,position:"absolute"});x.css({left:-1*(c+l)})}else{if(r.h){var T=e(i[0]);var N=e(i[1]);var C=e(s[1]);h=t.calcHeightFrozenRows();T.css({height:h,zIndex:1});N.css({width:p,top:h,position:"absolute"});C.css({top:-1*h})}else{}}}}};r._generateTables=function(e,t,n){var r=this.that,i=r.colModel,s=i.length,o=r.options,u=o.virtualX,a=r.initH,f=r.finalH,l=o.numberCell,c=o.columnBorders,h=o.rowBorders,p=o.wrap,d=o.scrollModel,v=o.groupModel,m=r.hidearrHS,g=o.freezeCols,y=parseInt(o.freezeRows),b=false,w=0,E=n?n.data.length-1:t,S="",x=v?true:false,T=o.treeModel,N=n&&n.data?n.data:x?r.dataGM:r.data,C=r.rowIndxOffset;if(!n&&(e==null||E==null)){return}if(!n){r._trigger("beforeTableView",null,{pageData:N,initV:e,finalV:t,initH:a,finalH:f,colModel:i})}var k="pq-grid-table ";if(c){k+="pq-td-border-right "}if(h){k+="pq-td-border-bottom "}if(p){k+="pq-wrap "}else{k+="pq-no-wrap "}var L=["<table class='"+k+"' cellpadding=0 cellspacing=0 >"];this.hidearrHS1=[];if(1===1){L.push("<tr class='pq-row-hidden'>");if(l.show){var A=l.width+1;L.push("<td style='width:"+A+"px;' ></td>")}for(var O=0;O<=f;O++){if(O<a&&O>=g&&(u||n)){O=a;if(O>f){throw"initH>finalH";break}}var M=i[O];if(M.hidden){continue}A=M.outerWidth;L.push("<td style='width:",A,"px;' pq-col-indx='",O,"'></td>")}L.push("</tr>")}this.offsetRow=null;for(var w=0;w<=E;w++){if(w<e&&w>=y){w=e}var _=N[w],D=x?_.rowIndx-C:w,P=_?_.pq_hidden:false;if(P){continue}var b=r.lastFrozenRow===D;if(v&&_.groupTitle){this._generateTitleRow(v,_,L,b)}else{if(v&&_.groupSummary){this._generateSummaryRow(_.data,i,L,b)}else{var H=_.pq_detail&&_.pq_detail.show;this._generateRow(_,D,i,L,n,b,H);if(H){this._generateDetailRow(_,D,i,L,n,b)}}}}r.scrollMode=false;L.push("</table>");var B=L.join("");return B};r._renderCell=function(e,t){var n=this.that,r=this.options,i=e.rowData,s=e.column,o=s.type,u=s.dataIndx,a=i[u];if(!i){return}var f;if(t!=undefined){f=t}else{if(o=="checkBoxSelection"){f="<input type='checkbox' "+(a?"checked='checked'":"")+" />"}else{if(o=="detail"){var l=r.detailModel;var c=a&&a.show?l.expandIcon:l.collapseIcon;f="<div class='ui-icon "+c+"'></div>"}else{f=a}}}if(f===""||f==undefined){f="&nbsp;"}var h="",p;if(e.tree&&(p=r.treeModel)&&p.labelIndx==u){var d=i.pq_leaf,v=i.pq_level,m=!i.pq_collapse,g=(v+1)*p.indent,y="";if(d){y=p.leafIcon}else{if(m){y=p.expandIcon+" pq-tree-expand-icon"}else{y=p.collapseIcon+" pq-tree-expand-icon"}}var b=["<div class='pq-tree-icon-container' style='width:",g,"px;'>","<div class='ui-icon ",y," pq-tree-icon' ></div></div>"].join("");h="<div class='"+cls+"'>"+b+f+"</div>"}else{h=f}return h};r.renderCell=function(e){var t=this.that,n=this.options,r=e.rowData,i=e.rowIndx,s=e.rowIndxPage,o=e.column,u=e.colIndx,a=o.dataIndx,f=n.freezeCols,l=n.columnBorders,c="pq-col-indx='"+u+"'",h=false;var p="pq-grid-cell ";if(o.align=="right"){p+=" pq-align-right"}else{if(o.align=="center"){p+=" pq-align-center"}}if(u==f-1&&l){p+=" pq-last-freeze-col"}var d=o.cls;if(d){p=p+" "+d}var v=r.pq_cellselect;if(v){h=v[a]}if(h){p=p+" pq-cell-select ui-state-highlight"}var m;if(o.render){m=o.render.call(t.element[0],{data:t.data,dataModel:n.dataModel,rowData:r,cellData:r[a],rowIndxPage:s,rowIndx:i,colIndx:u,column:o,dataIndx:a})}var g=r.pq_cellcls;if(g){var y=g[a];if(y){p+=" "+y}}var b=["<td class='",p,"' ",c," >",this._renderCell(e,m),"</td>"].join("");return b};r.refreshRow=function(e,t,n){var r=this.that,i=r.data[e];var s=r.lastFrozenRow===e,o=i.pq_detail&&i.pq_detail.show;this._generateRow(i,e,t,n,null,s,o)};r._generateRow=function(e,t,n,r,i,s,o){var u="pq-grid-row";if(s){u+=" pq-last-freeze-row"}if(o){u+=" pq-detail-master"}var a=this.that,f=this.options,l=f.freezeCols,c=f.numberCell,h=f.treeModel,p=h.labelIndx?true:false,d=f.virtualX,v=a.initH,m=a.finalH,g=this.offset;if(f.stripeRows&&t/2==parseInt(t/2)){u+=" pq-grid-oddRow"}if(e.pq_rowselect){u+=" pq-row-select ui-state-highlight"}var y=e.pq_rowcls;if(y!=null){u+=" "+y}r.push("<tr pq-row-indx='",t,"' class='",u,"' >");if(c.show){r.push(["<td class='pq-grid-number-cell ui-state-default'>",i?"&nbsp;":t+1,"</td>"].join(""))}var b={rowIndx:t+g,rowIndxPage:t,rowData:e};for(var w=0;w<=m;w++){if(w<v&&w>=l&&(d||i)){w=v;if(w>m){throw"initH>finalH";break}}var E=n[w];if(E.hidden){continue}b.column=E;b.colIndx=w;b.tree=p;r.push(this.renderCell(b))}r.push("</tr>");return r};var i={widgetEventPrefix:"pqgrid"};i.options={cancel:"input,textarea,button,select,option,.ui-resizable-handle,div[contenteditable],.pq-draggable",distance:3,collapsible:{on:true,collapsed:false,_collapsed:false,refreshAfterExpand:true},colModel:null,columnBorders:true,dataModel:{cache:false,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:false,editable:true,editModel:{cellBorderWidth:0,clicksToEdit:1,filterKeys:true,keyUpDown:true,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^(([\-]?[1-9][0-9]*\.?[0-9]*)|([\-]?[0-9]\.[0-9]*)|([0-9]?))$/,onBlur:"validate",saveKey:""},editor:{select:false,type:"textbox"},validation:{icon:"ui-icon-alert",cls:"ui-state-error"},flexHeight:false,flexWidth:false,freezeCols:0,freezeRows:0,getDataIndicesFromColIndices:true,height:400,hoverMode:"null",_maxColWidth:"100%",_minColWidth:50,minWidth:100,numberCell:{width:30,title:"",resizable:false,minWidth:30,show:true},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:false,roundCorners:true,rowBorders:true,scrollModel:{pace:"fast",horizontal:true,autoFit:false,theme:false},selectionModel:{type:"row",mode:"range"},swipeModel:{on:true,speed:50,ratio:.15,repeat:20},showBottom:true,showHeader:true,showTitle:true,showToolbar:true,showTop:true,sortable:true,sql:false,stripeRows:true,title:"&nbsp;",treeModel:null,virtualX:false,virtualY:false,width:"auto",wrap:true,hwrap:true};i._regional={strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strLoading:"Loading",strNextResult:"Next Result",strNoRows:"No rows to display.",strNothingFound:"Nothing found",strPrevResult:"Previous Result",strSearch:"Search",strSelectedmatches:"Selected {0} of {1} match(es)"};e.extend(i.options,i._regional);i._destroyResizable=function(){if(this.element.data("resizable")){this.element.resizable("destroy")}};i._disable=function(){if(this.$disable==null){this.$disable=e("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element)}};i._enable=function(){if(this.$disable){this.element[0].removeChild(this.$disable[0]);this.$disable=null}};i._destroy=function(){this._destroyResizable();this._destroyDraggable();this._mouseDestroy();this.element.off(this.eventNamespace);e(window).unbind(this.eventNamespace);this.element.empty();this.element.css("height","");this.element.css("width","");this.element.removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()};i.decidePanes=function(){this.pqpanes={v:false,h:false};var e=this.pqpanes;var t=this.options,n=t.virtualX,r=t.virtualY,i=t.flexHeight,s=t.flexWidth,o=t.numberCell,u=t.freezeRows,a=t.freezeCols;if(u&&!i&&(a||o.show)&&!s){if(!r){e.h=true}if(!n){e.v=true}}else{if(u&&!i){if(!r){e.h=true}}else{if((a||o.show)&&!s){if(!n){e.v=true}}}}};i.collapse=function(e){var t=this,n=this.element,r=this.options,i=r.collapsible,s=i.$collapsible.children("span"),o=function(){s.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n");if(n.hasClass("ui-resizable")){n.resizable("destroy")}t.$toolbar.pqToolbar("disable");i.collapsed=true;i._collapsed=true;i.animating=false;t._trigger("collapse")};e=e?e:{};if(i._collapsed){return false}i.htCapture=n.height();if(e.animate===false){n.height(23);o()}else{i.animating=true;n.animate({height:"23px"},function(){o()})}};i.expand=function(e){var t=this,n=this.element,r=this.options,i=r.collapsible,s=i.htCapture,o=i.$collapsible.children("span"),u=function(){i._collapsed=false;i.collapsed=false;if(i.refreshAfterExpand){t.refresh()}else{t._refreshResizable()}o.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s");t.$toolbar.pqToolbar("enable");i.animating=false;t._trigger("expand")};e=e?e:{};if(i._collapsed===false){return false}if(e.animate===false){n.height(s);u()}else{i.animating=true;n.animate({height:s},function(){u()})}};i._createCollapse=function(){var t=this,n=this.$top,r=this.options,i=r.collapsible;if(i.on&&!i.$collapsible){var s=e(["<div class='pq-slider-icon' style='z-index:5;' >","<span class='ui-icon ui-icon-circle-triangle-n'></span>","</div>"].join("")).appendTo(n);i.$collapsible=s;s.mouseover(function(e){s.addClass("ui-state-hover")}).mouseout(function(e){s.removeClass("ui-state-hover")}).click(function(e){if(i.collapsed){t.expand()}else{t.collapse()}})}else{if(!i.on&&i.$collapsible){i.$collapsible.remove();delete i.$collapsible}}if(i.collapsed&&!i._collapsed){t.collapse({animate:false})}else{if(!i.collapsed&&i._collapsed){t.expand({animate:false})}}};i._create=function(){var t=this;this.decidePanes();this.setEditorPosTimer();this.iGenerateView=new n(this);this.iKeyNav=new u(this);this.iRefreshColumn=new l(this);this.rowHeight=22;this.hidearr=[];this.hidearrHS=[];this.tables=[];var t=this,r=this.options;this.$tbl=null;this._refreshGridWidthAndHeight();this._calcThisColModel();this.iSort=new e.paramquery.cSort(this);this.iSort._refreshSorters();this._initTypeColumns();var i=this.element;i.empty().addClass("pq-grid ui-widget ui-widget-content"+(r.roundCorners?" ui-corner-all":"")).append(["<div class='pq-grid-top ui-widget-header",r.roundCorners?" ui-corner-top":"","'>","<div class='pq-grid-title",r.roundCorners?" ui-corner-top":"","'>&nbsp;</div>","</div>","<div class='pq-grid-inner' >","<div class='pq-header-outer ui-widget-header'>","</div>","<div class='pq-cont-right' >","<div class='pq-cont'></div>","</div>","</div>","<div class='pq-grid-bottom ui-widget-header",r.roundCorners?" ui-corner-bottom":"","'>","<div class='pq-grid-footer'>&nbsp;</div>","</div>"].join(""));this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel});this.$top=e("div.pq-grid-top",i);this.$title=e("div.pq-grid-title",i);if(!r.showTitle){this.$title.css("display","none")}this.$toolbar=e("div.pq-grid-toolbar",i);this.$grid_inner=e("div.pq-grid-inner",i);this.$header_o=e("div.pq-header-outer",this.$grid_inner);if(!r.showTop){this.$top.css("display","none")}this.$bottom=e("div.pq-grid-bottom",i);if(!r.showBottom){this.$bottom.css("display","none")}this.$footer=e("div.pq-grid-footer",i);this.$cont_o=e("div.pq-cont-right",this.$grid_inner);this.$cont_fixed=e("div.pq-cont-fixed",this.$grid_inner);var s=this.$cont=e("div.pq-cont",this.$grid_inner);e(window).bind("resize"+t.eventNamespace,function(e){t._onWindowResize(e)});s.on("click","td.pq-grid-cell",function(n){if(e.data(n.target,t.widgetName+".preventClickEvent")===true){return}if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onClickCell(n)}});s.on("click","tr.pq-grid-row",function(n){if(e.data(n.target,t.widgetName+".preventClickEvent")===true){return}if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onClickRow(n)}});s.on("contextmenu","td.pq-grid-cell",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onRightClickCell(n)}});s.on("contextmenu","tr.pq-grid-row",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onRightClickRow(n)}});s.on("dblclick","td.pq-grid-cell",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onDblClickCell(n)}});s.on("dblclick","tr.pq-grid-row",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onDblClickRow(n)}});s.on("mousedown","td.pq-grid-cell",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onCellMouseDown(n)}});s.on("mousedown","tr.pq-grid-row",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onRowMouseDown(n)}});s.on("mousedown",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onContMouseDown(n)}});s.on("mouseenter","td.pq-grid-cell",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onCellMouseEnter(n,e(this))}});s.on("mouseenter","tr.pq-grid-row",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onRowMouseEnter(n,e(this))}});s.on("mouseleave","td.pq-grid-cell",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onCellMouseLeave(n,e(this))}});s.on("mouseleave","tr.pq-grid-row",function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){return t._onRowMouseLeave(n,e(this))}});s.bind("mousewheel DOMMouseScroll",function(e){return t._onMouseWheel(e)});var o=0;this.$hvscroll=e("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(this.$grid_inner);this.$vscroll=e("<div class='pq-vscroll'></div>").appendTo(this.$grid_inner);this.prevVScroll=0;var a=r.scrollModel;if(a.lastColumn===undefined){if(r.virtualX){a.lastColumn="auto"}}this.$vscroll.pqScrollBar({pace:a.pace,theme:a.theme,steps:r.virtualY,direction:"vertical",cur_pos:0,pageDown:function(e,n){t.iKeyNav.pageDown()},pageUp:function(e,n){t.iKeyNav.pageUp()},drag:function(e,n){var i=r.virtualY;if(!i){var s=n.ratio;t._syncViewWithScrollBarVert(s)}},scroll:function(e,n){var i=r.virtualY;if(i){t.scrollMode=true;t.setFlexWHCallback(function(){t.iGenerateView.generateView()});var s;if(e.originalEvent&&e.originalEvent.type=="drag"){s=t._setScrollVNumEles()}else{s=t._setScrollVNumEles(true)}if(s<=1){t._setScrollHLength();t._setScrollHVLength()}}}});var f=0;this.$hscroll=e("<div class='pq-hscroll'></div>").appendTo(this.$grid_inner);this.$hscroll.pqScrollBar({direction:"horizontal",pace:a.pace,theme:a.theme,steps:r.virtualX,cur_pos:0,drag:function(e,n){var i=r.virtualX;if(!i){var s=n.ratio;t._syncViewWithScrollBarHor(s)}},scroll:function(e,n){var i=r.virtualX;if(i){t.refresh()}}});this.element.height("");this.disableSelection();if(window.opera){this.$grid_inner.bind("keypress.pq-grid",{that:this},function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){t._onKeyPressDown(n)}})}else{this.$grid_inner.bind("keydown.pq-grid",{that:this},function(n){if(e(n.target).closest(".pq-grid")[0]==t.element[0]){t._onKeyPressDown(n)}})}this._refreshOptions();this._refreshTitle();this._refreshDataIndices();this.iRows=new e.paramquery.cRows(this);this.iCells=new e.paramquery.cCells(this);this.generateLoading();this._initPager();this._refreshResizable();this._refreshDraggable();this._mouseInit()};i._mouseCapture=function(t){var n=this,r=this.options;if(r.virtualX&&r.virtualY){return false}if(!t.target){return false}if(e(t.target).closest(".pq-grid")[0]==this.element[0]){if(r.flexHeight&&r.flexWidth){return false}var i=r.swipeModel;if(i.on==false||i.on=="touch"&&!e.support.touch){return false}return true}return false};i._saveDims=function(){var t=this.$cont;t.data("offsetWidth",t[0].offsetWidth);t.data("offsetHeight",t[0].offsetHeight);var n=this.$tbl;if(n){for(var r=0;r<n.length;r++){var i=n[r],s=e(i);s.data("offsetHeight",i.offsetHeight);s.data("scrollWidth",i.scrollWidth)}}var o=this.$tbl_header;if(o){for(var r=0;r<o.length;r++){var i=o[r],u=e(i).parent();u.data("offsetHeight",i.offsetHeight);u.data("scrollWidth",i.scrollWidth)}}};i._mouseDown=function(e){this._saveDims();return this._super.call(this,e)};i._mouseStart=function(e){this.blurEditor({force:true});return true};i._mouseDrag=function(e){if(this._trigger("mouseDrag",e,null)==false){return false}return true};i._mouseStop=function(e){if(this._trigger("mouseStop",e,null)==false){return false}return true};i._refreshGridWidthAndHeight=function(){var t=this.options,n,r,i=(t.width+"").indexOf("%")>-1?true:false,s=(t.height+"").indexOf("%")>-1?true:false,o=this.element;if(i||s){var u=o.parent();if(!u.length){return}var a=u.width(),f=u[0]==document.body?e(document).height():u.height(),l=null,c=function(e){var t=/(-|\+)([0-9]+)/;var n=t.exec(e);if(n&&n.length==3){return parseInt(n[1]+n[2])}else{return 0}},h=i?c(t.width):0,p=s?c(t.height):0;if(a==0){while(u[0].tagName.toUpperCase()!="BODY"){var d=u.parent();if(d[0]==null){l=u;break}else{u=d}}if(l){var v=l.css("position"),m=l.css("left"),g=l.css("top");l.css({position:"absolute",left:"-2000",top:"-2000"}).appendTo(e(document.body));u=o.parent();if(i){a=u.width()}if(s){f=u.height()}l.css({position:v,left:m,top:g})}}if(i){n=parseInt(t.width)*a/100+h}if(s){r=parseInt(t.height)*f/100+p}}if(!i){n=t.width}if(!s){r=t.height}if(n!="auto"&&n<t.minWidth){n=t.minWidth}if(r<t.minHeight){r=t.minHeight}o.width(n);o.height(r)};var s,o;i._onWindowResize=function(t){var n=this.options,r=this.element,i=r.parent(),u,a;if(!i.length){return}u=i.height();a=i.width();if(s!=null&&(u==s||!i.closest(".ui-resizable").length)&&a==o){return}else{s=u;o=a}if(e.support.touch&&n.editModel.indices&&e(document.activeElement).is(".pq-editor-focus")){return}var f=this,l=n.autoSizeInterval,l=l===undefined?0:l;if(this.autoResizeTimeout){clearTimeout(this.autoResizeTimeout);delete this.autoResizeTimeout}this.autoResizeTimeout=window.setTimeout(function(){f._refreshAfterResize();delete f.autoResizeTimeout},l)};i._onMouseWheel=function(e){this._saveDims();var t=this.options;if(t.flexHeight){return true}var n=this,r=n.$vscroll;var i=0;var e=e.originalEvent;if(e.wheelDelta){i=e.wheelDelta/120}else{if(e.detail){i=e.detail*-1/3}}var s=r.pqScrollBar("option"),o=parseInt(s.cur_pos),u=parseInt(s.num_eles),a=s.ratio,f=o-i;if(t.virtualY){if(f>=0){r.pqScrollBar("option","cur_pos",o-i);r.pqScrollBar("scroll")}}else{var l=a-i/(u-1);if(l>1){l=1}else{if(l<0){l=0}}r.pqScrollBar("option","ratio",l);r.pqScrollBar("drag")}return false};i._onDblClickCell=function(t){var n=this;var r=e(t.currentTarget);var i=n.getCellIndices({$td:r});var s=i.rowIndxPage,o=n.rowIndxOffset,u=s+o,a=i.colIndx;if(a==null){return}if(n._trigger("cellDblClick",t,{$td:r,rowIndxPage:s,rowIndx:u,colIndx:a,column:n.colModel[a],rowData:n.data[s]})==false){return false}if(n.options.editModel.clicksToEdit>1&&this.isEditableRow({rowIndx:u})&&this.isEditableCell({colIndx:a,rowIndx:u})){n.editCell({rowIndxPage:s,colIndx:a})}};i._onClickCont=function(e){var t=this};i._onClickRow=function(t){var n=this;var r=e(t.currentTarget);var i=parseInt(r.attr("pq-row-indx")),s=n.rowIndxOffset,o=i+s;if(isNaN(i)){return}var u={rowIndx:o,evt:t},a=this.options;if(n._trigger("rowClick",t,{$tr:r,rowIndxPage:i,rowIndx:o,rowData:n.data[i]})==false){return false}return};i._onRightClickRow=function(t){var n=this,r=e(t.currentTarget),i=parseInt(r.attr("pq-row-indx")),s=n.rowIndxOffset,o=i+s;if(isNaN(i)){return}var u=this.options;if(n._trigger("rowRightClick",t,{$tr:r,rowIndxPage:i,rowIndx:o,rowData:n.data[i]})==false){return false}};i._onDblClickRow=function(t){var n=this;var r=e(t.currentTarget);var i=parseInt(r.attr("pq-row-indx")),s=n.getRowIndxOffset(),o=i+s;if(n._trigger("rowDblClick",t,{$tr:r,rowIndxPage:i,rowIndx:o,rowData:n.data[i]})==false){return false}};i._isValidCell=function(t){var n=this,r=t.rowData,i=e.trim(t.value),s=t.valueOrig,o=t.column,u=t.silent,a=o.dataIndx,f=this.options,l=f.validation,c=o.validations,h=document.activeElement;if(c&&c.length>0){for(var p=0;p<c.length;p++){var d=c[p],d=e.extend({},l,d),v=d.type,m=d.msg,m=m?m:"&nbsp;",g=d.icon,y=d.cls,y=y?y:"",b="padding:3px 10px;"+d.style,w=d.css,E=true,S={valid:false,msg:m,dataIndx:a},x=d.value;if(v=="minLen"&&i.length<x){E=false}else{if(v=="maxLen"&&i.length>x){E=false}else{if(v=="gt"&&i<=x){E=false}else{if(v=="gte"&&i<x){E=false}else{if(v=="lt"&&i>=x){E=false}else{if(v=="lte"&&i>x){E=false}else{if(v=="regexp"&&(new RegExp(x)).test(i)==false){E=false}else{if(typeof v=="function"){var T={column:o,value:i,rowData:r,msg:m};if(v.call(n.element[0],T)==false){E=false;if(T.msg!=m){m=T.msg}}}}}}}}}}if(!E&&u===true){return S}if(!E){var N=this.getRowIndx({rowData:r}).rowIndx;if(s===undefined){if(N==null){throw"incorrect usage of isValid"}this.goToPage({rowIndx:N});this.editCell({rowIndx:N,dataIndx:a})}else{if(e(h).hasClass("pq-editor-focus")){var C=f.editModel.indices;if(C){var k=C.rowIndx,L=C.dataIndx;if(N!=null&&N!=k){throw"incorrect usage of isValid rowIndx: "+N}if(a!=L){throw"incorrect usage of isValid dataIndx: "+a}this.editCell({rowIndx:k,dataIndx:a})}}}var A=this.getEditCell();if(A&&A.$cell){var O=A.$cell;O.attr("title",m);try{O.tooltip("destroy")}catch(M){}O.tooltip({position:{my:"left center+5",at:"right center"},content:function(){var t=e(this),n=g==""?"":"<span class='ui-icon "+g+" pq-tooltip-icon'></span>";return n+m},open:function(e,t){if(y){t.tooltip.addClass(y)}if(b){var n=t.tooltip.attr("style");t.tooltip.attr("style",n+";"+b)}if(w){t.tooltip.css(w)}}}).tooltip("open")}return S}}}if(s!==undefined){var A=this.getEditCell();if(A&&A.$cell){var O=A.$cell;O.removeAttr("title");try{O.tooltip("destroy")}catch(M){}}}return{valid:true}};i.isValid=function(e){var t=this.getRowData(e),n=e.dataIndx;if(n==null){var r=this.colModel;for(var i=0,s=r.length;i<s;i++){var o=r[i],u=o.hidden;if(u){continue}var n=o.dataIndx,a=t[n],f=this._isValidCell({rowData:t,value:a,column:o,silent:e.silent});if(!f.valid){return f}}}else{var o=this.getColumn({dataIndx:n}),a=e.value===undefined?t[n]:e.value,f=this._isValidCell({rowData:t,value:a,valueOrig:e.value,column:o,silent:e.silent});if(!f.valid){return f}}return{valid:true}};i.isEditableRow=function(e){var t=this.options,n=t.editable;if(n!=null){if(typeof n=="function"){var r=e.rowIndx,i=t.dataModel.data[r];return n.call(this.element[0],{rowData:i,rowIndx:r})}else{return n}}else{return true}};i.isEditableCell=function(e){var t=e.colIndx,n=e.dataIndx,t=t==null?this.getColIndx({dataIndx:n}):t,r=this.colModel[t],n=n==null?r.dataIndx:n,i=r.editable;if(e.checkVisible&&r.hidden){return false}if(i!=null){if(typeof i=="function"){var s=e.rowIndx,o=this.getRowData(e);return i.call(this.element[0],{rowIndx:s,rowData:o,column:r,dataIndx:n})}else{return i}}else{return true}};i._getRowPQData=function(e,t,n){var n=n==null?this.data[e]:n;return n?n[t]:null};i._setRowPQData=function(e,t,n){var n=n==null?this.data[e]:n;if(!n){return}for(var r in t){n[r]=t[r]}};i._onContMouseDown=function(e){this.blurEditor({blurIfFocus:true});var t=this;var n={dataModel:t.options.dataModel};if(t._trigger("contMouseDown",e,n)===false){return false}return true};i._onCellMouseDown=function(t){var n=this;var r=e(t.currentTarget);var i=n.getCellIndices({$td:r});i.$td=r;i.dataModel=n.options.dataModel;if(n._trigger("cellMouseDown",t,i)==false){return false}return true};i._onRowMouseDown=function(t){var n=this;var r=e(t.currentTarget);var i=n.getRowIndx({$tr:r});i.$tr=r;i.dataModel=n.options.dataModel;if(n._trigger("rowMouseDown",t,i)==false){return false}return true};i._onCellMouseEnter=function(e,t){var n=t,r=this.options,i=this.getCellIndices({$td:n}),s=this;if(s._trigger("cellMouseEnter",e,i)===false){return false}if(r.hoverMode=="cell"){s.highlightCell(n)}return true};i._onRowMouseEnter=function(e,t){var n=t,r=this.options,i=this;var s=i.getRowIndx({$tr:n});var o=s.rowIndxPage;if(i._trigger("rowMouseEnter",e,s)===false){return false}if(r.hoverMode=="row"){i.highlightRow(o)}return true};i._onCellMouseLeave=function(e,t){var n=t,r=this;if(r.options.hoverMode=="cell"){r.unHighlightCell(n)}return true};i._onRowMouseLeave=function(e,t){var n=t,r=this;var i=r.getRowIndx({$tr:n});var s=i.rowIndxPage;if(r.options.hoverMode=="row"){r.unHighlightRow(s)}return true};i._onCellMouseUp=function(t){var n=this;var r=e(t.currentTarget);var i=n.getCellIndices({$td:r});i.$td=r;i.dataModel=n.options.dataModel;if(n._trigger("cellMouseUp",t,i)==false){return false}return true};i._onRowMouseUp=function(t){var n=this;var r=e(t.currentTarget);var i=n.getRowIndx({$tr:r});if(n._trigger("rowMouseUp",t,i)==false){return false}return true};i._onClickCell=function(t){var n=this,r=this.options,i=this.colModel,s=r.editModel,o=r.selectionModel;var u=e(t.currentTarget);var a=n.getCellIndices({$td:u});var f=a.rowIndxPage,l=n.rowIndxOffset,c=f+l,h=a.colIndx;a.rowIndx=c;if(h==null){return}var p=i[h],d=p.dataIndx;a.dataIndx=d;a.evt=t;if(n._trigger("cellClick",t,{$td:u,rowIndxPage:f,rowIndx:c,colIndx:h,dataIndx:d,column:p,rowData:n.data[f]})==false){return false}if(s.clicksToEdit==1&&this.isEditableRow({rowIndx:c})&&this.isEditableCell({colIndx:h,rowIndx:c})){n.editCell(a);return}};i._onRightClickCell=function(t){var n=e(t.currentTarget);var r=this.getCellIndices({$td:n});var i=this,s=r.rowIndxPage,o=this.rowIndxOffset,u=s+o,a=r.colIndx,f=this.colModel,l=this.options,c=l.DM;if(a==null){return}var h=f[a],p=h.dataIndx;if(this._trigger("cellRightClick",t,{$td:n,rowIndxPage:s,rowIndx:u,colIndx:a,dataIndx:p,column:h,rowData:i.data[s]})==false){return false}};i.highlightCell=function(e){e.addClass("pq-grid-cell-hover ui-state-hover")};i.unHighlightCell=function(e){e.removeClass("pq-grid-cell-hover ui-state-hover")};i.highlightRow=function(e){if(isNaN(e)){}else{var t=this.getRow({rowIndxPage:e});if(t){t.addClass("pq-grid-row-hover ui-state-hover")}}};i.unHighlightRow=function(e){if(isNaN(e)){}else{var t=this.getRow({rowIndxPage:e});if(t){t.removeClass("pq-grid-row-hover ui-state-hover")}}};i._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.data,colModel:this.options.colModel}};i._refreshOptions=function(){this._refreshDataOptions()};i._refreshDataOptions=function(){};i.enableSelection=function(){this.$cont.enableSelection()};i.disableSelection=function(){this.$cont.disableSelection();this.$header_o.find("tr.pq-grid-title-row").disableSelection()};i._findCellFromEvt=function(t){var n=e(t.target);var r=n.closest(".pq-grid-cell");if(r==null||r.length==0){return{rowIndxPage:null,colIndx:null,$td:null}}else{var i=this.getCellIndices({$td:r});i.$td=r;return i}};i._initPager=function(){var e=this.options.pageModel;var t=this;var n={change:function(e,n){t.blurEditor({force:true});var r=t.options.pageModel;if(n.curPage!=undefined){r.prevPage=r.curPage;r.curPage=n.curPage}if(n.rPP!=undefined){r.rPP=n.rPP}if(r.type=="remote"){t.remoteRequest({callback:function(){t._onDataAvailable({apply:true})}})}else{t.refreshView()}},refresh:function(e){t.refreshDataAndView()}};if(e.type){this.$footer.pqPager(n)}else{}};i._refreshHideArrHS=function(){var e=this,t=this.colModel,n=e.hidearrHS,r=e.initH,i=e.finalH,s=parseInt(this.options.freezeCols);for(var o=0;o<s;o++){n[o]=false}for(var o=s;o<r;o++){n[o]=true}for(var o=r;o<=i;o++){n[o]=false}for(var o=i+1,u=t.length;o<u;o++){n[o]=true}};i.generateLoading=function(){if(this.$loading){this.$loading.remove()}this.$loading=e("<div class='pq-loading'></div>").appendTo(this.element);e(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading);this.$loading.find("div.pq-loading-bg").css("opacity",.2)};i._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)};i.showLoading=function(){if(this.showLoadingCounter==null){this.showLoadingCounter=0}this.showLoadingCounter++;this.$loading.show()};i.hideLoading=function(){if(this.showLoadingCounter>0){this.showLoadingCounter--}if(!this.showLoadingCounter){this.$loading.hide()}};i.refreshDataFromDataModel=function(){this._trigger("beforeRefreshData",null,{});var e=this.options,t=e.dataModel,n=e.pageModel,r=t.data,i=n.type;this.rowIndxOffset=0;if(r==null||r.length==0){if(i){n.curPage=0;n.totalPages=0;n.totalRecords=0}this.data=r;return}if(i&&i=="local"){n.totalRecords=r.length;n.totalPages=Math.ceil(r.length/n.rPP);if(n.curPage>n.totalPages){n.curPage=n.totalPages}if(n.curPage<1&&n.totalPages>0){n.curPage=1}var s=(n.curPage-1)*n.rPP;var o=n.curPage*n.rPP;if(o>r.length){o=r.length}this.data=r.slice(s,o)}else{if(i=="remote"){var u=Math.ceil(n.totalRecords/n.rPP);n.totalPages=u;if(u&&!n.curPage){n.curPage=1}var o=n.rPP;if(o>r.length){o=r.length}this.data=r.slice(0,o)}else{this.data=r.slice(0)}}if(i=="local"||i=="remote"){this.rowIndxOffset=n.rPP*(n.curPage-1)}};e.paramquery.filter=function(){var e={begin:{text:"Begins With",TR:true,string:true},between:{text:"Between",TR:true,string:true,date:true,number:true},notbegin:{text:"Does not begin with",TR:true,string:true},contain:{text:"Contains",TR:true,string:true},notcontain:{text:"Does not contain",TR:true,string:true},equal:{text:"Equal To",TR:true,string:true,bool:true},notequal:{text:"Not Equal To",TR:true,string:true},empty:{text:"Empty",TR:false,string:true,bool:true},notempty:{text:"Not Empty",TR:false,string:true,bool:true},end:{text:"Ends With",TR:true,string:true},notend:{text:"Does not end with",TR:true,string:true},less:{text:"Less Than",TR:true,number:true,date:true},lte:{text:"Less than or equal",TR:true,number:true,date:true},range:{TR:true,string:true,number:true,date:true},regexp:{TR:true,string:true,number:true,date:true},great:{text:"Great Than",TR:true,number:true,date:true},gte:{text:"Greater than or equal",TR:true,number:true,date:true}};return{conditions:e,getAllConditions:function(){var t=[];for(var n in e){t.push(n)}return t}(),getConditions:function(t){var n=[];for(var r in e){if(e[r][t]){n.push(r)}}return n},getTRConditions:function(){var t=[];for(var n in e){if(e[n].TR){t.push(n)}}return t}(),getWTRConditions:function(){var t=[];for(var n in e){if(!e[n].TR){t.push(n)}}return t}()}}();e.paramquery.filter.rules={};e.paramquery.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",less:"Less Than",lte:"Less than or equal",great:"Great Than",gte:"Greater than or equal"};i.getQueryStringSort=function(){var e=this.iSort.sorters,t="",n=this.options,r=n.sql,i=n.stringify;if(r){for(var s=0;s<e.length;s++){var o=e[s],u=o.dataIndx,a=o.dir=="up"?"asc":"desc";t+=(s>0?", ":"")+u+" "+a}return t}else{if(e.length){if(i===false){return e}else{return JSON.stringify(e)}}else{return""}}};i.getQueryStringCRUD=function(){return""};i.getQueryStringFilter=function(){var t=this.options,n=t.sql,r=t.stringify,i=t.filterModel,s=i.mode,o=this.colModel,u=this.getFilterData({CM:o,location:"remote"}),a="";if(i&&i.on&&u){if(n){a=[];for(var f=0;f<u.length;f++){var l=u[f],c=l.condition,h=l.dataIndx,p=e.trim(l.value);if(c==="contain"){a.push(h+" like '%"+p+"%'")}else{if(c==="notcontain"){a.push(h+" not like '%"+p+"%'")}else{if(c==="begin"){a.push(h+" like '"+p+"%'")}else{if(c==="end"){a.push(h+" like '%"+p+"'")}else{if(c==="equal"){a.push(h+"='"+p+"'")}else{if(c==="notequal"){a.push(h+"!='"+p+"'")}else{if(c==="empty"){a.push("isnull("+h+",'')=''")}else{if(c==="notempty"){a.push("isnull("+h+",'')!=''")}else{if(c==="less"){a.push(h+"<'"+p+"'")}else{if(c==="great"){a.push(h+">'"+p+"'")}}}}}}}}}}}a=a.join(" "+s+" ")}else{if(u.length){var d={mode:s,data:u};if(r===false){a=d}else{a=JSON.stringify(d)}}else{a=""}}}return a};i.remoteRequest=function(t){if(this.loading){this.xhr.abort()}var n=this,r="",i="",s=this.options,o=false,u=this.colModel,a=s.dataModel,f=s.filterModel,l=s.pageModel;if(typeof a.getUrl=="function"){var c={colModel:u,dataModel:a,groupModel:s.groupModel,pageModel:l,filterModel:f};var h=a.getUrl.call(this.element[0],c);if(h&&h.url){r=h.url}if(h&&h.data){i=h.data}}else{if(typeof a.url=="string"){r=a.url;var p={},d={},v={};if(a.sorting=="remote"){var m=this.getQueryStringSort();if(m){p={pq_sort:m}}}if(l.type=="remote"){v={pq_curpage:l.curPage,pq_rpp:l.rPP}}var g;if(f.type!="local"){g=this.getQueryStringFilter();if(g){o=true;d={pq_filter:g}}}var y=a.postData,b=a.postDataOnce;if(y&&typeof y=="function"){y=y.call(this.element[0],{colModel:u,dataModel:a})}i=e.extend({pq_datatype:a.dataType},d,v,p,y,b)}}if(!r){return}this.loading=true;this.showLoading();this.xhr=e.ajax({url:r,dataType:a.dataType,async:a.async==null?true:a.async,cache:a.cache,contentType:a.contentType,type:a.method,data:i,beforeSend:function(e,t){if(typeof a.beforeSend=="function"){return a.beforeSend.call(n.element[0],e,t)}},success:function(e,r,i){if(typeof a.getData=="function"){var s=a.getData.call(n.element[0],e,r,i);a.data=s.data;if(l.type&&l.type=="remote"){if(s.curPage){l.curPage=s.curPage}if(s.totalRecords){l.totalRecords=s.totalRecords}}}else{a.data=e.data;if(l.type&&l.type=="remote"){if(e.curPage){l.curPage=e.curPage}if(e.totalRecords){l.totalRecords=e.totalRecords}}}n.hideLoading();n.loading=false;n._trigger("load",null,{dataModel:a,colModel:u});if(o){n._trigger("filter",null,{type:"remote",dataModel:a,colModel:u,filterModel:f})}if(t&&t.callback){t.callback()}},error:function(e,t,r){n.hideLoading();n.loading=false;if(typeof a.error=="function"){a.error.call(n.element[0],e,t,r)}else{if(r!="abort"){throw"Error : "+r}}}})};i._fixFireFoxContentEditableIssue=function(){if(window.postMessage){}};i.setFlexWHCallback=function(e){var t=this;e.call(t);var n=this.options;if(n.flexHeight){this._setGridHeightFromTable()}if(n.flexWidth){this._setGridWidthFromTable()}};i._refreshTitle=function(){this.$title.html(this.options.title)};i._destroyDraggable=function(){var e=this.element;var t=e.parent(".pq-wrapper");if(t.length&&t.data("draggable")){t.draggable("destroy");this.$title.removeClass("pq-draggable");e.unwrap(".pq-wrapper")}};i._refreshDraggable=function(){var e=this.options,t=this.element,n=this.$title;if(e.draggable){n.addClass("pq-draggable");var r=t.parent(".pq-wrapper");if(!r.length){t.wrap("<div class='pq-wrapper' />")}t.parent(".pq-wrapper").draggable({handle:n})}else{this._destroyDraggable()}};i._refreshResizable=function(){var t=this,n=this.element,r=this.options,i=(r.width+"").indexOf("%")>-1,s=(r.height+"").indexOf("%")>-1,o=r.width=="auto",u=r.flexWidth,a=r.flexHeight;if(r.resizable&&(!(a||s)||!(u||i||o))){var f="e,s,se";if(a||s){f="e"}else{if(u||i||o){f="s"}}var l=true;if(n.hasClass("ui-resizable")){var c=n.resizable("option","handles");if(f==c){l=false}else{this._destroyResizable()}}if(l){n.resizable({helper:"ui-state-default",handles:f,minWidth:r.minWidth,minHeight:r.minHeight?r.minHeight:100,delay:0,start:function(t,n){e(n.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(e,t){},stop:function(n,u){if(!s){r.height=t.element.height()}if(!i&&!o){r.width=t.element.width()}t.refresh();t.element.css("position","relative");e(window).trigger("resize")}})}}else{this._destroyResizable()}};i._refreshAfterResize=function(){var e=this.options,t=e.width,n=e.height,r=(t+"").indexOf("%")!=-1?true:false,i=t==="auto",s=(n+"").indexOf("%")!=-1?true:false;if(r||i||s){this.refresh()}};i.refresh=function(e){this._refresh(e)};i._refreshDataIndices=function(){if(this.options.getDataIndicesFromColIndices==false){return}var e=this.colModel,t=e.length;for(var n=0;n<t;n++){var r=e[n];if(r.dataIndx==null){r.dataIndx=n}}};i.refreshView=function(e){if(this.options.editModel.indices!=null){this.blurEditor({force:true})}this.refreshDataFromDataModel();this.refresh(e)};i._refresh=function(e){e=e||{};var t=e.header,n=e.table,r=this.element;if(!r[0].offsetWidth){return}this.$grid_inner[0].scrollTop=0;var i=this.options;if(!i.virtualX||!i.virtualY){this.decidePanes()}else{this.pqpanes={v:false,h:false}}i.collapsible._collapsed=false;var s=this;this._refreshGridWidthAndHeight();this._refreshDataIndices();this.iRefreshColumn.refreshColumnWidths();this._setScrollHNumEles();this._bufferObj_calcInitFinalH();this._refreshHideArrHS();if(t!==false){this._createHeader()}this._refreshHeaderSortIcons();this._refreshPager();this._setInnerGridHeight();this._setRightGridHeight();r.height("");this.setFlexWHCallback(function(){if(n!==false){s.iGenerateView.generateView()}else{s._saveDims();s.iGenerateView.scrollView()}});this._refreshScrollbars();this._refreshFreezeLine();this._createCollapse();i.dataModel.postDataOnce=undefined};i._refreshScrollbars=function(e){this._setScrollHLength();this._setScrollVLength();this._setScrollVNumEles(true);this._setScrollHLength();this._setScrollHVLength()};i._setScrollHVLength=function(){var e=this.options;if(this.$hscroll.is(":hidden")||e.flexHeight||e.flexWidth){this.$hvscroll.css("visibility","hidden")}};i._refreshPager=function(){var e=this.options,t=e.pageModel,n=this.$footer,r=t.type?true:false,i=t.rPP,s=t.totalRecords;if(r){var o=e.pageModel;if(n.hasClass("pq-pager")==false){this._initPager()}n.pqPager("option",o);if(s>i){this.$bottom.css("display","")}}else{if(n.hasClass("pq-pager")){n.pqPager("destroy")}if(e.showBottom){this.$bottom.css("display","")}else{this.$bottom.css("display","none")}}};i.getThis=function(){return{that:this}};i._addRowsData=function(e){var t=e.data,n=this.options.dataModel.data,r=e.rowIndx;if(n==null){n=[]}if(r==null){for(var i=0,s=t.length;i<s;i++){var o=t[i];n.push(o)}}else{if(r<n.length){for(var i=0,s=t.length;i<s;i++){var o=t[i];n.splice(r,0,o);r++}}else{return false}}return true};i.addRows=function(e){if(this._addRowsData(e)){this.refreshDataFromDataModel();this.refresh();return true}else{return false}};i.refreshDataAndView=function(e){var t=this.options.dataModel;this.iSort._refreshSorters();if(t.location=="remote"){var n=this;this.remoteRequest({callback:function(){n._onDataAvailable(e)}})}else{this._onDataAvailable(e)}};i.getColIndx=function(e){var t=e.dataIndx;if(t===undefined){throw"dataIndx NA"}var n=this.colModel;for(var r=0,i=n.length;r<i;r++){if(n[r].dataIndx==t){return r}}};i.getColumn=function(e){if(e.dataIndx===undefined){throw"dataIndx N/A"}var t=e.dataIndx;var n=this.colModel;for(var r=0,i=n.length;r<i;r++){var s=n[r];if(s.dataIndx==t){return s}}return null};i._onDataAvailable=function(){};i._setOption=function(e,t){var n=this.options;if(e=="height"){this._super.call(this,e,t)}else{if(e=="width"){this._super.call(this,e,t)}else{if(e=="title"){this._super.call(this,e,t);this._refreshTitle()}else{if(e=="roundCorners"){this._super.call(this,e,t);if(t){this.element.addClass("ui-corner-all");this.$top.addClass("ui-corner-top");this.$bottom.addClass("ui-corner-bottom")}else{this.element.removeClass("ui-corner-all");this.$top.removeClass("ui-corner-top");this.$bottom.removeClass("ui-corner-bottom")}}else{if(e=="freezeCols"){t=parseInt(t);if(!isNaN(t)&&t>=0&&t<=this.colModel.length-2){this._super.call(this,e,t)}}else{if(e=="freezeRows"){t=parseInt(t);if(!isNaN(t)&&t>=0){this._super.call(this,e,t)}}else{if(e=="resizable"){this._super.call(this,e,t);this._refreshResizable()}else{if(e=="draggable"){this._super.call(this,e,t);this._refreshDraggable()}else{if(e=="scrollModel"){this._super.call(this,e,t)}else{if(e=="dataModel"){this._super.call(this,e,t)}else{if(e=="pageModel"){this._super.call(this,e,t)}else{if(e==="selectionModel"){this._super.call(this,e,t)}else{if(e==="colModel"||e=="columnTemplate"){this._super.call(this,e,t);this._calcThisColModel()}else{if(e==="disabled"){this._super.call(this,e,t);if(t===true){this._disable()}else{this._enable()}}else{if(e==="numberCell"){this._super.call(this,e,t);this.decidePanes()}else{if(e==="strLoading"){this._super.call(this,e,t);this._refreshLoadingString()}else{if(e==="showTop"){this._super.call(this,e,t);if(t===true){this.$top.css("display","")}else{this.$top.css("display","none")}}else{if(e==="showTitle"){this._super.call(this,e,t);if(t===true){this.$title.css("display","")}else{this.$title.css("display","none")}}else{if(e==="showToolbar"){this._super.call(this,e,t);if(t===true){this.$toolbar.css("display","")}else{this.$toolbar.css("display","none")}}else{if(e=="toolbar"){this._super.call(this,e,t);this.$toolbar.remove();this._super.call(this,e,t);this._createToolbar()}else{if(e==="collapsible"){this._super.call(this,e,t);this._createCollapse()}else{if(e==="showBottom"){this._super.call(this,e,t);if(t===true){this.$bottom.css("display","")}else{this.$bottom.css("display","none")}}else{if(e==="flexHeight"){this._super.call(this,e,t);var r=this.$vscroll;if(t&&r&&r.hasClass("pq-sb-vert")){if(n.virtualY){r.pqScrollBar("option","cur_pos",0)}else{r.pqScrollBar("option","ratio",0)}}}else{if(e==="flexWidth"){this._super.call(this,e,t);var i=this.$hscroll;if(t&&i&&i.hasClass("pq-sb-horiz")){if(n.virtualX){i.pqScrollBar("option","cur_pos",0)}else{i.pqScrollBar("option","ratio",0)}}}else{this._super.call(this,e,t)}}}}}}}}}}}}}}}}}}}}}}}}};i._setOptions=function(){this._super.apply(this,arguments)};i._generateCellRowOutline=function(){var t=this.options,n=t.editModel;if(this.$div_focus){if(t.debug){throw"this.$div_focus already present assert failed"}return}else{var r=this.element;if(n.inline){r=this.getCell(n.indices);r.css("padding",0).empty()}this.$div_focus=e(["<div class='pq-editor-outer'>","<div class='pq-editor-inner'>","</div>","</div>"].join("")).appendTo(r)}var i=e.extend({all:true},n.indices);var s=this.getCell(i);s.css("height",s.height());s.empty();this.refreshEditorPos()};i._removeCellRowOutline=function(t){function n(e){if(e.hasClass("hasDatepicker")){e.datepicker("hide").datepicker("destroy")}}if(this.$div_focus){var r=this.$div_focus.find(".pq-editor-focus");n(r);if(r[0]==document.activeElement){var i=this._blurEditMode;this._blurEditMode=true;r.blur();this._blurEditMode=i}this.$div_focus.remove();delete this.$div_focus;var s=this.options.editModel;var o=e.extend({},s.indices);s.indices=null;this.refreshCell(o)}};i.refreshEditorPos=function(){var e=this.options,t=e.editModel,n=t.cellBorderWidth,r=this.$div_focus,i=this.getCell(t.indices);var s=i[0].offsetWidth-(n?n*2:1);var o=i[0].offsetHeight-(n?n*2:1),u=this.element.offset(),a=i.offset(),f=a.left-u.left-1,l=a.top-u.top-1;r.css({height:o,width:s,borderWidth:n,left:f,top:l})};i.setEditorPosTimer=function(){var e=this,t,n=this.options;if(this._refreshEditorPosTimer){window.clearInterval(this._refreshEditorPosTimer);this._refreshEditorPosTimer=null}this._refreshEditorPosTimer=window.setInterval(function(){var t=n.editModel;if(t.indices){e.refreshEditorPos()}},200)};i._onHeaderCellClick=function(e,t){var n=this,r=n.colModel[e],i=this.options,s=i.dataModel,o=r.dataIndx,u=r.dataType;if(n._trigger("headerCellClick",t,{column:r,colIndx:e,dataIndx:o})===false){return}if(!i.sortable){return}if(r.sortable==false){return}this.sort({colIndx:e,column:r,dataIndx:o})};i._selectRow=function(e,t){this.selectRow(e,t)};i._findfirstUnhiddenColIndx=function(){for(var e=0;e<this.colModel.length;e++){if(!this.colModel[e].hidden){return e}}};i.selectRow=function(e){var t=e.rowIndx,n=e.evt,r=e.offset;if(n&&(n.type=="keydown"||n.type=="keypress")){if(this.iRows.replace(e)==false){return false}}else{if(this.iRows.add(e)==false){return false}}if(n!=null){}return true};i.get$Tbl=function(t,n){var r=this.$tbl,i=[];if(!r||!r.length){return}var s=this.pqpanes,o=this.options,u=o.freezeRows,a=o.freezeCols;if(s.h&&s.v){if(n==null){if(t>=u){i.push(r[2],r[3])}else{i.push(r[0],r[1])}}else{if(n>=a&&t>=u){i=r[3]}else{if(n<a&&t>=u){i=r[2]}else{if(n>=a&&t<u){i=r[1]}else{i=r[0]}}}}}else{if(s.v){if(n==null){i=r}else{if(n>=a){i=r[1]}else{i=r[0]}}}else{if(s.h){if(t>=u){i=r[1]}else{i=r[0]}}else{i=r[0]}}}if(i){return e(i)}};i.scrollCell=function(e){this.scrollRow(e);this.scrollColumn(e)};i.scrollY=function(e){this.$vscroll.pqScrollBar("option","cur_pos",e).pqScrollBar("scroll")};i.scrollRow=function(e){var t=this.options;if(t.virtualY){this._scrollRowVirtualY(e)}else{this._scrollRowNonVirtualY(e)}};i._scrollRowNonVirtualY=function(e){var t=this.options,n=e.rowIndxPage,r=this.iHierarchy?true:false,i=e.rowIndx,s=this.$cont.data("offsetHeight")-this._getScollBarHorizontalHeight(),n=n==null?i-this.rowIndxOffset:n,o=parseInt(t.freezeRows);if(n<o){return}var u=this.get$Tbl(n),a=this.getRow({rowIndxPage:n}),f=a[0];var l=f.offsetTop+parseInt(u.css("marginTop")),c=f.offsetHeight;if(r){var h=a.next("tr.pq-detail-child");if(h&&h.length){c+=h[0].offsetHeight}}var p=f.offsetTop+u[0].offsetTop;if(f.offsetTop<-1*u[0].offsetTop){var d=-1*f.offsetTop-parseInt(u.css("top"));u.css("marginTop",d);this._syncScrollBarVert()}else{if(l+c>=s){var d=s-c-f.offsetTop;u.css("marginTop",d);this._syncScrollBarVert()}}};i._scrollRowVirtualY=function(e){var t=this.options,n=e.rowIndxPage,r=this.iHierarchy?true:false,i=e.rowIndx,s=this.scrollCurPos,n=n==null?i-this.rowIndxOffset:n,o=parseInt(t.freezeRows);if(n<o){return}var u=this._calcCurPosFromRowIndxPage(n);if(u==null){return}if(u<s){this.$vscroll.pqScrollBar("option","cur_pos",u).pqScrollBar("scroll")}var a=this.get$Tbl(n);var f=a.children("tbody").children("tr[pq-row-indx="+n+"]"),l=f.last(),c=l;if(f.length>1){c=f.first()}var h=l[0],p=parseInt(a.css("marginTop"));if(h==undefined){this.$vscroll.pqScrollBar("option","cur_pos",u).pqScrollBar("scroll")}else{var d=h.offsetTop+h.offsetHeight,v=this.$cont[0].offsetHeight,m=p,g=this._getScollBarHorizontalHeight(),y=c.prev("tr");if(y.hasClass("pq-row-hidden")||y.hasClass("pq-last-freeze-row")){return}else{if(d>v-g-m){var b=d-(v-g-m);var f=a.children().children("tr");var w=0,E=0;var S;if(o){S=f.filter("tr.pq-last-freeze-row").last().next();if(S.length==0){S=f.filter("tr.pq-row-hidden").next()}}else{S=f.filter("tr.pq-row-hidden").next()}do{w+=S[0].offsetHeight;if(S[0]==l[0]){break}else{if(!r||S.hasClass("pq-detail-child")==false){E++;if(w>=b){break}}else{if(w>=b){break}}}S=S.next()}while(1===1);var x=s+E;if(x>u){x=u}var T=this.$vscroll.pqScrollBar("option","num_eles");if(T<x+1){T=x+1}this.$vscroll.pqScrollBar("option",{num_eles:T,cur_pos:x}).pqScrollBar("scroll")}}}};i.getTableForVertScroll=function(){var t=this,n=t.pqpanes,r=t.$tbl;if(!r||!r.length){return}if(n.h&&n.v){r=e([r[2],r[3]])}else{if(n.v){r=e([r[0],r[1]])}else{if(n.h){r=e(r[1])}}}return r};i.getTableForHorScroll=function(){var t=this,n=t.pqpanes,r=[],i=t.$tbl;if(!i||!i.length){return}if(n.h&&n.v){r.push(i[1],i[3])}else{if(n.v){r.push(i[1])}else{if(n.h){r.push(i[0],i[1])}else{r.push(i[0])}}}if(this.tables.length){var s=this.tables[0].$tbl;if(n.v){r.push(s[1])}else{r.push(s[0])}}return e(r)};i.getTableHeaderForHorScroll=function(){var t=this,n=t.pqpanes,r=t.$tbl_header;if(!r||!r.length){return}if(n.v){r=e(r[1])}else{r=e(r[0])}return r.parent()};i.blurEditor=function(e){if(this.$div_focus){var t=this.$div_focus.find(".pq-editor-focus");if(e&&e.blurIfFocus){if(document.activeElement==t[0]){t.blur()}}else{return t.triggerHandler("blur",e)}}};i._syncViewWithScrollBarVert=function(e){if(e==null){return}var t=this,n=t.getTableForVertScroll();if(!n||!n.length){return}var r=this.options;if(r.editModel.indices){this.blurEditor({force:true})}var i=n.data("offsetHeight"),s=t.$cont.data("offsetHeight")-t._getScollBarHorizontalHeight(),o=i-s,u=o*e,u=-1*u-1;if(!i||!s){if(r.debug){throw"_syncViewWithScrollBarVert !tblHt || !contHt"}}if(u>-1){u=-1}n.css({marginTop:u})};i._syncViewWithScrollBarHor=function(e){if(e==null){return}var t=this,n=t.getTableForHorScroll();var r=t.getTableHeaderForHorScroll();if(!n&&!r){return}var i=this.options;if(i.editModel.indices){this.blurEditor({force:true})}var s=n?n:r,o=s.data("scrollWidth"),u=t.$cont.data("offsetWidth")-t._getSBWidth(),a=o-u,f=a*e,f=-1*f;if(!o||!u){if(i.debug){}return}if(f>0){f=0}if(n){n.css("marginLeft",f)}if(r){r.css("marginLeft",f)}};i._syncScrollBarVert=function(){var e=this,t=e.getTableForVertScroll();if(!t||!t.length){return}var n=t.data("offsetHeight"),r=e.$cont.data("offsetHeight")-e._getScollBarHorizontalHeight(),i=n-r,s=-1*parseInt(t.css("marginTop")),o=(s-1)/(i-1);if(o>=0&&o<=1){if(e.$vscroll.hasClass("pq-sb-vert")){e.$vscroll.pqScrollBar("option","ratio",o)}}};i._syncScrollBarHor=function(){var e=this,t=e.getTableForHorScroll(),n=e.getTableHeaderForHorScroll();if(!t&&!n){return}var r=t?t:n;var i=r.data("scrollWidth"),s=e.$cont.data("offsetWidth")-e._getSBWidth(),o=i-s,u=-1*parseInt(r.css("marginLeft")),a=u/o;if(a>=0&&a<=1){if(e.$hscroll.hasClass("pq-sb-horiz")){e.$hscroll.pqScrollBar("option","ratio",a)}}};i._scrollColumnNonVirtual=function(e){var t=e.colIndx,t=t==null?this.getColIndx({dataIndx:e.dataIndx}):t,n=this.options.freezeCols;if(t<n){return}var r=this._calcRightEdgeCol(t).width,i=this._calcRightEdgeCol(t-1).width,s=this._calcRightEdgeCol(n-1).width,o=this._getSBWidth(),u=this.getTableForHorScroll(),a=this.getTableHeaderForHorScroll(),f=this.$cont[0].offsetWidth-o;var l,c;if(u){l=parseInt(u.css("marginLeft"));c=u[0].offsetLeft}else{if(a){l=parseInt(a.css("marginLeft"));c=a[0].offsetLeft-s}else{return}}if(r+l>f){l=f-r;if(u){u.css("marginLeft",l)}if(a){a.css("marginLeft",l)}this._syncScrollBarHor()}else{if(i<-1*c){l=-1*i+s;if(u){u.css("marginLeft",l)}if(a){a.css("marginLeft",l)}this._syncScrollBarHor()}}};i._scrollColumnVirtual=function(e){var t=e.colIndx,t=t==null?this.getColIndx({dataIndx:e.dataIndx}):t,n=this.options.freezeCols;var r=this._calcRightEdgeCol(t).width,i=this._getSBWidth(),s=this.$cont[0].offsetWidth;if(r>s-i){var o=f.call(this,-1,t+1)-(s-i),u=this.colModel,a=u.length,l=0,c=0;for(var h=n;h<a;h++){var p=u[h];if(!p.hidden){l+=p.outerWidth}if(h==t){c=h-n-this._calcNumHiddenUnFrozens(h);break}else{if(l>=o){c=h-n-this._calcNumHiddenUnFrozens(h)+1;break}}}this.$hscroll.pqScrollBar("option","cur_pos",c).pqScrollBar("scroll");return true}else{if(this.hidearrHS[t]){this.hidearrHS[t]=false;var d=t-n-this._calcNumHiddenUnFrozens(t);this.$hscroll.pqScrollBar("option","cur_pos",d).pqScrollBar("scroll");return true}}return false};i.scrollColumn=function(e){var t=this.options,n=t.virtualX;if(n){return this._scrollColumnVirtual(e)}else{return this._scrollColumnNonVirtual(e)}};i.selection=function(e){var t=e.rowIndx,n=e.colIndx,r=e.method,i=e.type;if(i=="row"){return this["iRows"][r](e)}else{if(i=="cell"){return this["iCells"][r](e)}}return};i._bringPageIntoView=function(e){var t=e.rowIndx,n=this;var r=this.options.pageModel;if(r.type=="local"&&t>=0){var i=r.curPage;var s=r.rPP;var o=(i-1)*s;var u=i*s;if(t>=o&&t<u){}else{r.curPage=Math.ceil((t+1)/s);this.refreshDataFromDataModel();this.refresh()}}};i.goToPage=function(e){var t=this.options.pageModel;if(t.type=="local"||t.type=="remote"){var n=e.rowIndx,r=t.rPP,i=e.page==null?Math.ceil((n+1)/r):e.page,s=t.curPage;if(i!=s){t.curPage=i;if(t.type=="local"){this.refreshDataFromDataModel();this.refresh()}else{this.refreshDataAndView()}}}};i.setSelection=function(e){if(e==null){this.iRows.removeAll({raiseEvent:true});this.iCells.removeAll({raiseEvent:true});return false}var t=this.data,n,r;if(e.rowData){var i=this.getRowIndx(e);n=i.rowIndx}else{var s=this.rowIndxOffset,n=e.rowIndx,r=e.rowIndxPage,n=n==null?r+s:n}var o=e.colIndx==null&&e.dataIndx!==undefined?this.getColIndx({dataIndx:e.dataIndx}):e.colIndx,u=e.evt;if(n<0||o<0||o>=this.colModel.length){return false}if(t==null||t.length==0){return false}e.rowIndx=n;e.colIndx=o;this._bringPageIntoView(e);r=n-this.rowIndxOffset;e.rowIndxPage=r;this.scrollRow({rowIndxPage:r});if(o==null){return this._selectRow(e)}else{this.scrollColumn({colIndx:o});return this.selectCell(e)}};i.getColModel=function(){return this.colModel};i.saveEditCell=function(t){var n=this.options;var r=n.editModel;if(!r.indices){return null}var i=e.extend({},r.indices),s=t?t.evt:null,o=this.rowIndxOffset,u=i.colIndx,a=i.rowIndxPage,f=a+o,l=this.colModel,c=l[u],h=c.dataIndx,p=this.data[a],d=n.dataModel,v;if(p==null){return null}else{v=p[h]}if(a!=null){var m=this.getEditCellData();if(m=="<br>"){m=""}if(v==null&&m===""){m=null}var g={rowIndx:f,rowIndxPage:a,dataIndx:h,column:c,newVal:m,value:m,oldVal:v,rowData:p,dataModel:d};if(this._trigger("cellBeforeSave",s,g)===false){return false}if(m!=v){p[h]=m;if(n.track){var p=this.getRowData({rowIndx:f});this.iUCData.update({rowData:p,dataIndx:h,oldVal:v,newVal:m})}this._trigger("cellSave",s,g);var y=this;if(n.flexHeight){y._setGridHeightFromTable();y._fixIEFooterIssue()}else{if(t){y.scrollRow({rowIndxPage:a})}}}return true}};i._fixTableViewPort=function(){var e=this.element[0];e.scrollTop=0;e.scrollLeft=0;var t=this.$header_o[0];t.scrollLeft=0;t.scrollTop=0;this.iGenerateView.setPanes()};i._fixIEFooterIssue=function(){e(".pq-grid-footer").css({position:"absolute"});e(".pq-grid-footer").css({position:"relative"})};i.refreshColumn=function(e){var t=this.colModel,n=e.colIndx,r=e.dataIndx,n=n==null?this.getColIndx({dataIndx:r}):n,r=r==null?t[n]:r,i=this.rowIndxOffset;e.colIndx=n;var s=this.initV,o=this.finalV;for(var u=s;u<=o;u++){var a=u;e.rowIndx=a+i;e.rowIndxPage=a;e.colIndx=n;e.column=t[n];e.skip=true;this.refreshCell(e)}this._fixTableViewPort();this._refreshScrollbars();this._trigger("refreshColumn",null,{dataModel:this.options.dataModel,colModel:t,initV:s,finalV:o,colIndx:n,dataIndx:r})};i.refreshCell=function(e){if(!this.data){return}var t=this.rowIndxOffset,n=e.skip,r=e.rowIndx,i=e.rowIndxPage,r=e.rowIndx=r==null?i+t:r,i=e.rowIndxPage=i==null?r-t:i,s=e.dataIndx,o=e.colIndx,o=e.colIndx=o==null?this.getColIndx({dataIndx:s}):o,u=this.getCell({all:true,rowIndxPage:i,colIndx:o}),a=e.column,f=this.colModel,a=e.column=a?a:f[o],l=this.options,c=l.treeModel,h=this.data[i];if(!h){return}var p=e;p.tree=c.labelIndx?true:false,p.rowData=h;if(u&&u.length>0){var d=this.iGenerateView.renderCell(p);u.replaceWith(d);if(!n){this._fixTableViewPort();this._refreshScrollbars();this._trigger("refreshCell",null,{dataModel:this.options.dataModel,colModel:f,rowData:h,rowIndx:r,rowIndxPage:i,colIndx:o,dataIndx:s})}}};i.refreshRow=function(e){if(!this.data){return}var t=this,n=this.rowIndxOffset,r=e.rowIndx,i=e.rowIndxPage,r=r==null?i+n:r,i=i==null?r-n:i,s=this.getRow({all:true,rowIndxPage:i}),o=this.colModel,u=this.data[i];if(!u||!s||!s.length){return null}var a=[];t.iGenerateView.refreshRow(i,o,a);var f=a.join("");s.replaceWith(f);this._fixTableViewPort();this._refreshScrollbars();this._trigger("refreshRow",null,{rowData:u,rowIndx:r,rowIndxPage:i});return true};i.quitEditMode=function(e){if(this._quitEditMode){return}var t=this,n=false,r=false,i=false,s=this.options,o=s.editModel,u=o.indices,a=undefined;t._quitEditMode=true;if(e){n=e.old;r=e.silent;i=e.fireOnly;a=e.evt}if(u){if(!r&&!n){this._trigger("editorEnd",a,u)}if(!i){this._removeCellRowOutline(e);o.indices=null}}t._quitEditMode=null};i._fixIE=function(){var e=this.$cont[0];e.scrollLeft=0;e.scrollTop=0};i.getData=function(){return this.data};i.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}};i.getViewPortIndx=function(){return{initV:this.initV,finalV:this.finalV,initH:this.initH,finalH:this.finalH}};i.getRowIndxOffset=function(){return this.rowIndxOffset};i.selectCell=function(e){var t=e.rowIndx,n=e.colIndx,r=e.evt;if(r&&(r.type=="keydown"||r.type=="keypress")){if(this.iCells.replace(e)==false){return false}}else{if(this.iCells.add(e)===false){return false}}if(r!=null){}return true};i.getEditCell=function(){var e=this.options.editModel;if(e.indices){var t=this.getCell(e.indices);var n=this.$div_focus.children(".pq-editor-inner");var r=n.find(".pq-editor-focus");return{$td:t,$cell:n,$editor:r}}else{return null}};i.editCell=function(e){this.scrollRow(e);this.scrollColumn(e);return this._editCell(e)};i.getFirstEditableColIndx=function(e){if(e.rowIndx==null){throw"rowIndx NA"}if(!this.isEditableRow(e)){return-1}var t=this.colModel;for(var n=0;n<t.length;n++){e.colIndx=n;if(!this.isEditableCell(e)){continue}else{if(t[n].hidden){continue}}return n}return-1};i.editFirstCellInRow=function(e){var t=this,n=this.rowIndxOffset,r=e.rowIndx,i=e.rowIndxPage,r=r==null?i+n:r,i=i==null?r-n:i,s=this.getFirstEditableColIndx({rowIndx:r});if(s!=-1){this.editCell({rowIndxPage:i,colIndx:s})}};i._editCell=function(t){var n=this,r=t.evt,i=this.rowIndxOffset,s=t.rowIndxPage,o=t.rowIndx,o=o==null?s+i:o,s=s==null?o-i:s,u=t.colIndx,a=t.dataIndx,u=u==null?this.getColIndx({dataIndx:a}):u,f=this.colModel,l=f[u],a=l.dataIndx,c=l.editor,h=this.options,p=h.editModel,d=h.editor,v=c?e.extend({},d,c):d,m=n.data[s],g=false;if(p.indices){var y=p.indices;if(y.rowIndxPage==s&&y.colIndx==u){this.refreshEditorPos();var b=this.$div_focus.find(".pq-editor-focus");window.setTimeout(function(){b.focus()},0);return false}else{if(this.blurEditor({evt:r})===false){return false}this.quitEditMode({evt:r})}}p.indices={rowIndxPage:s,rowIndx:o,colIndx:u,column:l,dataIndx:a};this._generateCellRowOutline();var w=this.$div_focus,E=w.children(".pq-editor-inner");if(l.align=="right"){E.addClass("pq-align-right")}else{if(l.align=="center"){E.addClass("pq-align-center")}else{E.addClass("pq-align-left")}}var S=m[a],x;var T=v.type,N=v.select,C=v.init,k=v.cls?v.cls:"",L="pq-editor-focus "+k,A=L+" pq-cell-editor ",O=v.attr?v.attr:"",M=v.style,M=M?M:"",_=M?"style='"+M+"'":"",D=E.width()-8,P="style='width:"+D+"px;"+M+"'",H=M?"style='"+M+"'":"";var B={rowIndx:o,rowIndxPage:s,$cell:E,cellData:S,rowData:m,cls:L,dataIndx:a,column:l};if(typeof T=="function"){x=T.call(n.element[0],B)}else{if(T=="checkbox"){var j=v.subtype;var F=S?"checked='checked'":"";x="<input "+F+" class='"+A+"' "+O+" "+H+" type=checkbox name='"+a+"' />";E.html(x);var I=E.children("input");if(j=="triple"){I.pqval({val:S});E.click(function(t){e(this).children("input").pqval({incr:true})})}}else{if(T=="textarea"||T=="select"||T=="textbox"){if(T=="textarea"){x="<textarea class='"+A+"' "+O+" "+P+" name='"+a+"' ></textarea>"}else{if(T=="select"){var q=v.options;var q=q?q:[];if(typeof q==="function"){q=q.call(n.element[0],{column:l,rowData:m})}var R=[O," class='",A,"' ",P," name='",a,"'"].join("");x=e.paramquery.select({options:q,attr:R,prepend:v.prepend,labelIndx:v.labelIndx,valueIndx:v.valueIndx,groupIndx:v.groupIndx})}else{x="<input class='"+A+"' "+O+" "+P+" type=text name='"+a+"' />"}}e(x).appendTo(E).width(D).val(S)}else{x="<div contenteditable='true' tabindx='0' "+_+" "+O+" class='pq-editor-default "+L+"'></div>";E.html(x);E.children().html(S);g=true}}}if(typeof C=="function"){C.call(n.element[0],B)}var n=this;var b=E.children(".pq-editor-focus"),U=p.filterKeys,z=l.editModel;if(z&&z.filterKeys!==undefined){U=z.filterKeys}var W={$cell:E,$editor:b,dataIndx:a,column:l,colIndx:u,rowIndx:o,rowIndxPage:s,rowData:m};p.indices=W;b.data({FK:U}).on("click",function(t){e(this).focus()}).on("keydown",function(e){n.iKeyNav._keyDownInEdit(e)}).on("keypress",function(e){return n.iKeyNav._keyPressInEdit(e,{FK:U})}).on("keyup",function(e){return n.iKeyNav._keyUpInEdit(e,{FK:U})}).on("blur",function(t,r){var i=n.options,s=i.editModel,o=s.onBlur,u=o=="save",a=o=="validate",f=s.cancelBlurCls,l=r?r.force:false;if(n._quitEditMode||n._blurEditMode){if(l&&i.debug){}return}if(!s.indices){return}var c=e(t.target);if(!l){if(n._trigger("editorBlur",t,W)===false){return}if(!o){return}if(f&&c.hasClass(f)){return}if(c.hasClass("hasDatepicker")){var h=c.datepicker("widget");if(h.is(":visible")){return false}}else{if(c.hasClass("ui-autocomplete-input")){if(c.autocomplete("widget").is(":visible")){return}}}}n._blurEditMode=true;var p=l||u||!a;if(!n.saveEditCell({evt:t,silent:p})){if(!l&&a){n._deleteBlurEditMode();return false}}n.quitEditMode({evt:t});n._deleteBlurEditMode()}).on("focus",function(e){n._trigger("editorFocus",e,W)});n._trigger("editorBegin",r,W);b.focus();window.setTimeout(function(){var t=e(document.activeElement);if(t.hasClass("pq-editor-focus")===false){var r=n.element.find(".pq-editor-focus");r.focus()}},0);n.element[0].scrollLeft=0;n.element[0].scrollTop=0;if(N){if(g){try{var X=b[0];var V=document.createRange();V.selectNodeContents(X);var J=window.getSelection();J.removeAllRanges();J.addRange(V)}catch(K){}}else{b.select()}}};i._deleteBlurEditMode=function(e){var t=this,e=e?e:{};if(t._blurEditMode){if(e.timer){window.setTimeout(function(){delete t._blurEditMode},0)}else{delete t._blurEditMode}}};i.getRow=function(e){var t=e.rowIndxPage,n=e.rowIndx,r=this.rowIndxOffset,t=t==null?n-r:t,i=e.all?this.$tbl:this.get$Tbl(t),s;if(i&&i.length){var o=i.children("tbody");if(t!=null){s=o.children("tr[pq-row-indx="+t+"]");if(s.length>i.length){s=s.filter(".pq-detail-master")}}}return s};i.getCell=function(e){var t=e.rowIndxPage,n=e.rowIndx,t=t==null?n-this.rowIndxOffset:t,r=e.colIndx,i=e.dataIndx,r=r==null?this.getColIndx({dataIndx:i}):r,s=e.all?this.$tbl:this.get$Tbl(t,r),o;if(s!=undefined){var o=s.children().children("tr[pq-row-indx="+t+"]").children("td[pq-col-indx="+r+"]");if(o.length==0){return null}}return o};i.getCellHeader=function(t){var n=t.colIndx,r=t.dataIndx,n=n==null?this.getColIndx({dataIndx:r}):n,i=this.$tbl_header,s,o=this.options,u=o.freezeCols;if(i!=undefined){if(i.length>1){if(n>=u){i=e(i[1])}else{i=e(i[0])}}var s=i.children().children("tr:last").children("td[pq-col-indx="+n+"]")}if(s.length==0||s[0].style.visibility=="hidden"){return null}return s};i.getEditorIndices=function(){var t=this.options.editModel.indices;if(!t){return null}else{return e.extend({},t)}};i.getEditCellData=function(){var t=this.options,n=t.editModel.indices;if(!n){return null}var r=n.colIndx,i=n.rowIndxPage,s=n.rowIndx,o=this.colModel[r],u=o.editor,a=t.editor,f=u?e.extend({},a,u):a,l=o.dataIndx,c=this.$div_focus,h=c.children(".pq-editor-inner"),p;var d=f.getData;if(typeof d=="function"){p=f.getData.call(this.element[0],{$cell:h,dataIndx:l,rowIndx:s,rowIndxPage:i,column:o})}else{var v=f.type;if(v=="checkbox"){var m=h.children();if(f.subtype=="triple"){p=m.pqval()}else{p=m.is(":checked")?true:false}}else{if(v=="contenteditable"){p=h.children().html()}else{var g=h.find('*[name="'+l+'"]');if(g&&g.length){p=g.val()}else{var g=h.find(".pq-editor-focus");if(g&&g.length){p=g.val()}}}}}return p};i.getCellIndices=function(e){var t=e.$td;if(t==null||t.length==0||t.closest(".pq-grid")[0]!=this.element[0]){return{rowIndxPage:null,colIndx:null}}var n=t.parent("tr");var r=n.attr("pq-row-indx"),i;if(r!=null){r=parseInt(r);i=r+this.rowIndxOffset}var s=t.attr("pq-col-indx"),o;if(s!=null){s=parseInt(s);o=this.colModel[s].dataIndx}return{rowIndxPage:r,rowIndx:i,colIndx:s,dataIndx:o}};i.getRowsByClass=function(e){var t=this.options,n=t.dataModel,r=t.pageModel,i=r.type,s=i=="remote"?true:false,o=this.rowIndxOffset,u=n.data,a=[];if(u==null){return a}for(var f=0,l=u.length;f<l;f++){var c=u[f];e.rowData=c;if(this.hasClass(e)){var h={rowData:c};if(s){h.rowIndx=f+o}else{h.rowIndx=f}a.push(h)}}return a};i.getCellsByClass=function(e){var t=this.options,n=t.dataModel,r=t.pageModel,i=r.type,s=i=="remote"?true:false,o=this.rowIndxOffset,u=n.data,a=this.colModel,f=a.length,l=[];if(u==null){return l}for(var c=0,h=u.length;c<h;c++){var p=u[c];e.rowData=p;for(var d=0;d<f;d++){var v=a[d],m=v.dataIndx;e.dataIndx=m;if(this.hasClass(e)){var g={rowData:p,dataIndx:m,colIndx:d};if(s){g.rowIndx=c+o}else{g.rowIndx=c}l.push(g)}}}return l};i.addClass=function(t){var n=t.rowIndx,r=t.dataIndx,i=t.cls,s=this.rowIndxOffset,o=this.getRowData(t);if(!o){return}if(n==null){n=this.getRowIndx({rowData:o}).rowIndx}var u=i.split(" ");for(var a=0;a<u.length;a++){var f=u[a];if(r==null&&this.hasClass({rowData:o,cls:f})===false){var l=o.pq_rowcls;if(l){o.pq_rowcls=e.trim(l)+" "+f}else{o.pq_rowcls=f}if(n!=null&&t.refresh!==false){var c=this.getRow({rowIndxPage:n-s});if(c){c.addClass(f)}}}else{if(this.hasClass({rowData:o,dataIndx:r,cls:f})===false){var h=o.pq_cellcls;if(h){var p=h[r];if(p){h[r]=e.trim(p)+" "+f}else{h[r]=f}}else{var h={};h[r]=f;o.pq_cellcls=h}if(n!=null&&t.refresh!==false){var d=this.getCell({rowIndxPage:n-s,dataIndx:r});if(d){d.addClass(f)}}}}}};i.removeClass=function(e){var t=e.rowIndx,n=this.getRowData(e),r=e.dataIndx,i=e.cls,s=r!=null&&n?n.pq_cellcls:null,o=n?n.pq_rowcls:null;if(n==null){return}if(t==null){t=this.getRowIndx({rowData:n}).rowIndx}if(r==null){if(o){n.pq_rowcls=this._removeClass(o,i)}if(t!=null&&e.refresh!==false){var u=this.getRow({rowIndx:t});if(u){u.removeClass(i)}}}else{if(s){var a=s[r];if(a){n.pq_cellcls[r]=this._removeClass(a,i)}if(t!=null&&e.refresh!==false){var f=this.getCell({rowIndx:t,dataIndx:r});if(f){f.removeClass(i)}}}}};i.hasClass=function(e){var t=e.dataIndx,n=e.cls,r=this.getRowData(e),i=new RegExp("\\b"+n+"\\b"),s;if(r){if(t==null){s=r.pq_rowcls;if(s&&i.test(s)){return true}else{return false}}else{var o=r.pq_cellcls;if(o&&o[t]&&i.test(o[t])){return true}else{return false}}}else{return null}};i._removeClass=function(e,t){if(e){var n=e.split(" "),r=t.split(" "),i=[];for(var s=0,o=n.length;s<o;s++){var u=n[s],a=false;for(var f=0,l=r.length;f<l;f++){var c=r[f];if(u===c){a=true;break}}if(!a){i.push(u)}}if(i.length>1){return i.join(" ")}else{if(i.length===1){return i[0]}else{return null}}}};i.getRowIndx=function(e){var t=e.$tr,n=e.rowData;if(n){var r=this.options,i=r.dataModel,s=r.pageModel,o=s.type,u=o=="remote"?true:false,a=i.data,f=false;if(a){for(var l=0,c=a.length;l<c;l++){if(a[l]==n){f=true;break}}}if(f){var h=this.rowIndxOffset,p=u?l:l-h,d=u?l+h:l;return{rowIndxPage:p,rowIndx:d}}else{return{}}}else{if(t==null||t.length==0){return{rowIndxPage:null}}var p=t.attr("pq-row-indx");if(p==null){return{rowIndxPage:null}}p=parseInt(p);return{rowIndxPage:p,rowIndx:p+this.rowIndxOffset}}};var u=function(e){this.options=e.options;this.that=e;var t=this;var n=e.widgetEventPrefix.toLowerCase(),r=e.eventNamespace;e.element.on(n+"celleditkeyup"+r,function(e,n){return t.filterKeys(e,n)})};var a=u.prototype;a._incrRowIndx=function(e,t){var n=this.that,r=e,t=t==null?1:t,i=n.data,s=0;for(var o=e+1,u=i.length;o<u;o++){var a=i[o].pq_hidden;if(!a){s++;r=o;if(s==t){return r}}}return r};a._decrRowIndx=function(e,t){var n=this.that,r=e,i=n.data,t=t==null?1:t,s=0;for(var o=e-1;o>=0;o--){var u=i[o].pq_hidden;if(!u){s++;r=o;if(s==t){return r}}}return r};i.addColumn=function(e,t){var n=this.options,r=n.colModel,i=n.dataModel.data;r.push(e);this._calcThisColModel();for(var s=0;s<i.length;s++){var o=i[s];o.push("")}};i.rowNextSelect=function(){var e=this.selection({type:"row",method:"getSelection"}),t,n,r=this.rowIndxOffset;if(e&&e[0]){t=e[0].rowIndx;n=t-r;n=this.iKeyNav._incrRowIndx(n)}if(n!=null){this.setSelection(null);this._setSelection({rowIndxPage:n})}return n};i.rowPrevSelect=function(){var e=this.selection({type:"row",method:"getSelection"}),t,n,r=this.rowIndxOffset;if(e&&e[0]){t=e[0].rowIndx;n=t-r;n=this.iKeyNav._decrRowIndx(n)}if(n!=null){this.setSelection(null);this.setSelection({rowIndxPage:n})}return n};a._incrIndx=function(e,t){var n=this.that,r=n._getLastVisibleRowIndxPage(n.data),i=n.colModel,s=i.length;if(t==null){if(e==r){return null}e=this._incrRowIndx(e);return{rowIndxPage:e}}var o;do{t++;if(t>=s){if(e==r){return null}e=this._incrRowIndx(e);t=0}o=i[t]}while(o&&o.hidden);return{rowIndxPage:e,colIndx:t}};a._decrIndx=function(e,t){var n=this.that,r=n.colModel,i=r.length,s=n._getFirstVisibleRowIndxPage(n.data);if(t==null){if(e==s){return null}e=this._decrRowIndx(e);return{rowIndxPage:e}}var o;do{t--;if(t<0){if(e==s){return null}e=this._decrRowIndx(e);t=i-1}o=r[t]}while(o&&o.hidden);return{rowIndxPage:e,colIndx:t}};a._incrEditIndx=function(e,t){var n=this.that,r=n.colModel,i=r.length,s,o=n.rowIndxOffset,u=n._getLastVisibleRowIndxPage(n.data);do{t++;if(t>=i){if(e==u){return null}do{e=this._incrRowIndx(e);var a=e+o,f=n.isEditableRow({rowIndx:a});if(e==u&&f==false){return null}}while(f==false);t=0}s=r[t];var a=e+o,l=n.isEditableCell({rowIndx:a,colIndx:t,checkVisible:true})}while(s&&(s.hidden||l==false));return{rowIndxPage:e,colIndx:t}};a._decrEditIndx=function(e,t){var n=this.that,r=n.colModel,i=r.length,s,o=n.rowIndxOffset,u=n._getFirstVisibleRowIndxPage(n.data);do{t--;if(t<0){if(e==u){return null}do{e=this._decrRowIndx(e);var a=e+o,f=n.isEditableRow({rowIndx:a});if(e==u&&f==false){return null}}while(f==false);t=i-1}s=r[t];var a=e+o,l=n.isEditableCell({rowIndx:a,colIndx:t,checkVisible:true})}while(s&&(s.hidden||l==false));return{rowIndxPage:e,colIndx:t}};a._incrEditRowIndx=function(e,t){var n=this.that,r=n.rowIndxOffset,i=n._getLastVisibleRowIndxPage(n.data);if(e==i){return null}do{e=this._incrRowIndx(e);var s=e+r,o=n.isEditableRow({rowIndx:s}),u=n.isEditableCell({rowIndx:s,colIndx:t}),a=o&&u;if(e==i&&!a){return null}}while(!a);return{rowIndxPage:e,colIndx:t}};a._decrEditRowIndx=function(e,t){var n=this.that,r=n.rowIndxOffset,i=n._getFirstVisibleRowIndxPage(n.data);if(e==i){return null}do{e=this._decrRowIndx(e);var s=e+r,o=n.isEditableRow({rowIndx:s}),u=n.isEditableCell({rowIndx:s,colIndx:t}),a=o&&u;if(e==i&&!a){return null}}while(!a);return{rowIndxPage:e,colIndx:t}};i._onKeyPressDown=function(t){var n=e(t.target).closest(".pq-grid-header");if(n.length>0){if(this._trigger("headerKeyDown",t,{dataModel:this.options.dataModel})==false){return false}else{return true}}else{var r=this.iKeyNav._bodyKeyPressDown(t);if(r===false){return false}if(this._trigger("keyDown",t,{dataModel:this.options.dataModel})==false){return false}}};a._saveAndMove=function(e,t){if(e==null){t.preventDefault();return false}var n=this.that,r=this.options,i=r.selectionModel,s=r.editModel,o=n.colModel,u=e.rowIndxPage,a=e.colIndx;n._blurEditMode=true;if(n.saveEditCell({evt:t})===false){n._deleteBlurEditMode({timer:true,msg:"_saveAndMove saveEditCell"});t.preventDefault();return false}n.quitEditMode(t);if(i.type=="row"){n.setSelection(null);n.setSelection({rowIndxPage:u});n.scrollColumn({colIndx:a})}else{if(i.type=="cell"){n.setSelection(null);n.setSelection({rowIndxPage:u,colIndx:a})}else{n.scrollRow({rowIndxPage:u});n.scrollColumn({colIndx:a})}}n._editCell({rowIndxPage:u,colIndx:a});n._deleteBlurEditMode({timer:true,msg:"_saveAndMove"});t.preventDefault();return false};a._keyPressInEdit=function(t,n){var r=this.that,i=r.options;var s=i.editModel.indices,n=n?n:{},o=n.FK,u=s.column,a=u.dataType;if(r._trigger("editorKeyPress",t,e.extend({},s))===false){return false}if(o&&(a=="float"||a=="integer")){var f=a=="float"?"0123456789.-":"0123456789-",l=t.charCode,l=l?l:t.keyCode,c=String.fromCharCode(l);if(c&&f.indexOf(c)==-1){return false}}};a.getValText=function(t){var n=t[0].nodeName.toLowerCase(),r=["input","textarea","select"],i="text";if(e.inArray(n,r)!=-1){i="val"}return i};a._keyUpInEdit=function(t,n){var r=this.that,i=r.options,n=n?n:{},s=n.FK,o=i.editModel,u=o.indices;r._trigger("editorKeyUp",t,e.extend({},u));var a=u.column,f=a.dataType;if(s&&(f=="float"||f=="integer")){var l=e(t.target),c=f=="integer"?o.reInt:o.reFloat;var h=this.getValText(l);var p=l.data("oldVal");var d=l[h]();if(c.test(d)==false){if(c.test(p)){l[h](p)}else{var v=f=="float"?parseFloat(p):parseInt(p);if(isNaN(v)){l[h](0)}else{l[h](v)}}}}};a._keyDownInEdit=function(t){var n=this.that,r=n.options;var i=r.editModel.indices;if(!i){return}var s=e(t.target),o=e.ui.keyCode,u=r.selectionModel,a=r.editModel,f=e.extend({},i),l=f.rowIndxPage,c=f.colIndx,h=f.column,p=h.editModel,d=p?e.extend({},a,p):a;var v=this.getValText(s);s.data("oldVal",s[v]());if(n._trigger("cellEditKeyDown",t,f)==false){return false}if(n._trigger("editorKeyDown",t,f)==false){return false}if(t.keyCode==o.TAB){var f;if(t.shiftKey){f=this._decrEditIndx(l,c)}else{f=this._incrEditIndx(l,c)}return this._saveAndMove(f,t)}else{if(t.keyCode==d.saveKey){var f=this._incrEditIndx(l,c);return this._saveAndMove(f,t)}else{if(t.keyCode==o.ESCAPE){n.quitEditMode({evt:t});if(u.type=="cell"){var m=n.getCell({rowIndxPage:l,colIndx:c});m.attr("tabindex",0).focus()}else{if(u.type=="row"){var g=n.getRow({rowIndxPage:l});e(g[0]).attr("tabindex",0).focus()}}t.preventDefault();return false}else{if(t.keyCode==o.PAGE_UP||t.keyCode==o.PAGE_DOWN){t.preventDefault();return false}else{if(d.keyUpDown){if(t.keyCode==o.DOWN){var f=this._incrEditRowIndx(l,c);return this._saveAndMove(f,t)}else{if(t.keyCode==o.UP){var f=this._decrEditRowIndx(l,c);return this._saveAndMove(f,t)}}}}}}}return};a.select=function(e){var t=this.that,n=e.rowIndx,r=e.colIndx,i=t.options.selectionModel,s=e.evt;if(s.shiftKey&&i.mode!="single"){if(i.type=="row"){t.scrollRow({rowIndx:n});t.iRows.extendSelection({rowIndx:n,evt:s})}else{if(i.type=="cell"){t.scrollCell({rowIndx:n,colIndx:r});t.iCells.extendSelection({rowIndx:n,colIndx:r,evt:s})}}}else{t.setSelection({rowIndx:n,colIndx:r,evt:s,setFirst:true})}};a._bodyKeyPressDown=function(t){var n=this.that,r=this,i,s,o=n.rowIndxOffset,u=this.options,a=n.colModel,f=u.selectionModel,l=u.editModel,c,h;var p=e.ui.keyCode;if(l.indices){n.$div_focus.find(".pq-cell-focus").focus();return}else{if(f.type=="row"){if(t.ctrlKey){s=n.iRows.getFocusSelection({old:true})}else{s=n.iRows.getFocusSelection({old:false})}if(s==null){return}var c=s.rowIndx,d=c-o;if(c==null){return}if(n._trigger("rowKeyDown",t,{rowData:n.data[d],rowIndx:c,rowIndxPage:d})==false){return false}}else{if(f.type=="cell"){if(t.ctrlKey){i=n.iCells.getFocusSelection({old:true})}else{i=n.iCells.getFocusSelection({old:false})}if(i==null){return}var v=i,c=v.rowIndx,d=c-o,m=v.dataIndx,h=n.getColIndx({dataIndx:m});if(c==null||h==null){return}if(n._trigger("cellKeyDown",t,{rowData:n.data[d],rowIndx:c,rowIndxPage:d,colIndx:h,dataIndx:m,column:a[h]})==false){return false}if(t.cancelBubble){return}}else{return}}}if(t.keyCode==p.LEFT){var v=this._decrIndx(d,h);if(v){c=v.rowIndxPage+o;this.select({rowIndx:c,colIndx:v.colIndx,evt:t})}t.preventDefault();return}else{if(t.keyCode==p.RIGHT){var v=this._incrIndx(d,h);if(v){c=v.rowIndxPage+o;this.select({rowIndx:c,colIndx:v.colIndx,evt:t})}t.preventDefault();return}else{if(t.keyCode==p.UP){d=this._decrRowIndx(d);if(d!=null){c=d+o;this.select({rowIndx:c,colIndx:h,evt:t})}t.preventDefault();return}else{if(t.keyCode==p.DOWN){d=this._incrRowIndx(d);if(d!=null){c=d+o;this.select({rowIndx:c,colIndx:h,evt:t})}t.preventDefault();return}else{if(t.keyCode==p.PAGE_DOWN||t.keyCode==p.SPACE){var g=this.pageDown(d);if(g){d=g.rowIndxPage;if(d!=null){c=d+o;this.select({rowIndx:c,colIndx:h,evt:t})}}t.preventDefault();return}else{if(t.keyCode==p.PAGE_UP){var y=this.pageUp(d);if(y){d=y.rowIndxPage;if(d!=null){c=d+o;this.select({rowIndx:c,colIndx:h,evt:t})}}t.preventDefault();return}else{if(t.keyCode==p.HOME){if(f.type=="row"||t.ctrlKey){c=n._getFirstVisibleRowIndxPage(n.data)+o;this.select({rowIndx:c,colIndx:h,evt:t})}else{if(f.type=="cell"){h=n._getFirstVisibleColIndx();this.select({rowIndx:c,colIndx:h,evt:t})}}t.preventDefault();return}else{if(t.keyCode==p.END){if(f.type=="row"||t.ctrlKey){c=n._getLastVisibleRowIndxPage(n.data)+o;this.select({rowIndx:c,colIndx:h,evt:t})}else{if(f.type=="cell"){h=n._getLastVisibleColIndx();this.select({rowIndx:c,colIndx:h,evt:t})}}t.preventDefault();return}else{if(t.keyCode==p.ENTER){if(f.type=="row"){var b,w;if(s!=null){n.editFirstCellInRow({rowIndx:d+o})}}else{if(i!=null){var w=n.getCell({rowIndxPage:d,colIndx:h});if(w&&w.length>0){var c=d+o,E=n.isEditableRow({rowIndx:c}),S=n.isEditableCell({rowIndx:c,colIndx:h});if(E&&S){n.editCell({rowIndxPage:d,colIndx:h})}}}}t.preventDefault();return}else{if(t.ctrlKey&&t.keyCode=="65"){if(f.type=="row"&&f.mode!="single"){n.iRows.selectAll({all:f.all})}else{if(f.type=="cell"&&f.mode!="single"){n.iCells.selectAll({all:f.all})}}t.preventDefault();return}else{}}}}}}}}}}};a.incrPageSize=function(){var t=this.that,n=t.$tbl,r=n.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),i=t.$cont[0].offsetHeight,s=parseInt(n.css("marginTop")),o=t._getScollBarHorizontalHeight(),u=i-o-s;for(var a=r.length-1;a>=0;a--){var f=r[a];if(f.offsetTop<u){break}}var l=t.getRowIndx({$tr:e(f)}).rowIndxPage;return{rowIndxPage:l}};a.pageNonVirtual=function(t,n){var r=this.that,i=r.$cont[0].offsetHeight-r._getScollBarHorizontalHeight();var s=r.getRow({rowIndxPage:t});var o=0,u=0,a,f=e(s[0])[n]("tr.pq-grid-row"),l=f.length;if(l>0){do{a=f[u];var c=a.offsetHeight;o+=c;if(o>=i){break}u++}while(u<l);u=u>0?u-1:u;do{var s=e(f[u]);t=r.getRowIndx({$tr:s}).rowIndxPage;if(t!=null){break}else{u--}}while(u>=0)}return t};a.pageDown=function(e){var t=this.that,n=t.options;var r=t.$vscroll.pqScrollBar("option"),i=r.cur_pos,s=r.num_eles,o=r.ratio;if(n.virtualY){if(i<s-1){var e=this.incrPageSize().rowIndxPage,u=t._calcCurPosFromRowIndxPage(e);if(u==null){return}t.$vscroll.pqScrollBar("option","cur_pos",u).pqScrollBar("scroll")}}else{if(e!=null){e=this.pageNonVirtual(e,"nextAll")}else{if(o<1){var a=t.$cont.data("offsetHeight")-t._getScollBarHorizontalHeight();t.iMouseSelection.updateTableY(-1*a);t._syncScrollBarVert()}}}return{rowIndxPage:e,curPos:u}};a.pageUp=function(e){var t=this.that,n=t.options;var r=t.$vscroll.pqScrollBar("option"),i=r.cur_pos,s=r.ratio;if(n.virtualY){if(i>0){var e=this.decrPageSize().rowIndxPage,o=t._calcCurPosFromRowIndxPage(e);if(o==null){return}t.$vscroll.pqScrollBar("option","cur_pos",o).pqScrollBar("scroll")}}else{if(e!=null){e=this.pageNonVirtual(e,"prevAll")}else{if(s>0){var u=t.$cont[0].offsetHeight-t._getScollBarHorizontalHeight();t.iMouseSelection.updateTableY(u);t._syncScrollBarVert()}}}return{rowIndxPage:e,curPos:o}};a.decrPageSize=function(){var t=this.that,n=t.$tbl,r=n.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),i=t.options.freezeRows,s=0;if(r.length){var o,u;if(i){o=r.filter("tr.pq-last-freeze-row");if(o.length){o=o.next()}}else{if(r.length>=2){o=e(r[1])}}if(o&&o.length){var s=t.getRowIndx({$tr:o}).rowIndxPage;s=s-t.pageSize+4;if(s<0){s=0}}}return{rowIndxPage:s}};i._calcNumHiddenFrozens=function(){var e=0,t=this.options.freezeCols;for(var n=0;n<t;n++){if(this.colModel[n].hidden){e++}}return e};i._calcNumHiddenUnFrozens=function(e){var t=0,n=this.options.freezeCols;var r=e!=null?e:this.colModel.length;for(var i=n;i<r;i++){if(this.colModel[i].hidden){t++}}return t};i._setScrollHLength=function(){var e=this.options;if(!e.scrollModel.horizontal){this.$hscroll.css("visibility","hidden");this.$hvscroll.css("visibility","hidden");return}else{this.$hscroll.css("visibility","");this.$hvscroll.css("visibility","")}var t=this.$cont[0].offsetWidth;var n=this.colModel;var r=this._getSBWidth();if(r==0){this.$hscroll.css("right",0)}else{this.$hscroll.css("right","")}t-=r;this.$hscroll.pqScrollBar("option","length",t)};i._setScrollHNumEles=function(){var e=this.options,t=e.scrollModel,n=0;if(!e.flexWidth){if(t.lastColumn=="fullScroll"){n=this.colModel.length-e.freezeCols-this._calcNumHiddenUnFrozens()}else{n=this.calcColsOutsideCont(this.colModel)+1}}this.$hscroll.pqScrollBar("option","num_eles",n)};i.calcColsOutsideCont=function(e){var t=this.options.numberCell,n=this.$tbl?this.$tbl[this.$tbl.length-1]:null,r=n?n.scrollWidth:0,i=this.options.freezeCols,s=this.$cont[0].offsetWidth-this._getSBWidth();r=0;if(t.show){r+=t.outerWidth}for(var o=0;o<e.length;o++){var u=e[o];if(!u.hidden){r+=u.outerWidth}}var a=0,f=0;var l=r;if(l>s){f++}for(o=i;o<e.length;o++){u=e[o];if(!u.hidden){a+=u.outerWidth;l=r-a;if(l>s){f++}else{break}}}return f};i._getScollBarHorizontalHeight=function(){var e=17,t=this.$hscroll;if(t.css("visibility")=="hidden"||this.options.scrollModel.horizontal==false||t.css("display")=="none"){e=0}return e};i._getSBWidth=function(){var e=17,t=this.$vscroll;if(this.initV==null||t.css("visibility")=="hidden"||this.options.flexHeight||t.css("display")=="none"){e=0}return e};i._setScrollVNumEles=function(t){var n=this,r=this.$vscroll,i=this.iHierarchy?true:false,s=r.pqScrollBar("option"),o=parseInt(s.num_eles),u=parseInt(s.cur_pos),a=this.options;var f=this._getScollBarHorizontalHeight(),l=this.$cont[0].offsetHeight,c=l-f+1,h=a.groupModel,p=h?this.dataGM:this.data;var d=p?this.totalVisibleRows:0;var v,m,g=0;if(this.$tbl&&this.$tbl.length>0){v=this.$tbl[this.$tbl.length-1];g=v.offsetHeight;m=e(v)}if(g>0&&g>c){var y=m.children().children("tr");var b=0,w=0;for(var E=0;E<y.length;E++){var S=y[E];b+=S.offsetHeight;if(b>=c){if(i&&e(S).hasClass("pq-detail-child")){w--;w=w>1?w-1:1}else{w=w>1?w-1:0}break}else{if(i){if(e(S).hasClass("pq-detail-child")==false){w++}}else{w++}}}if(w==0){w=y.length-1}o=d-w+1}else{o=u+1}if(o>d){o=d}if(t){n.$vscroll.pqScrollBar("option","num_eles",o)}else{n.$vscroll.pqScrollBar("setNumEles",o)}return o};i._getFirstVisibleRowIndxPage=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t].pq_hidden;if(!r){return t}}};i._getLastVisibleRowIndxPage=function(e){for(var t=e.length-1;t>=0;t--){var n=e[t].pq_hidden;if(!n){return t}}return null};i._getFirstVisibleColIndx=function(){var e=this.colModel,t=e.length;for(var n=0;n<t;n++){var r=e[n].hidden;if(!r){return n}}return null};i._getLastVisibleColIndx=function(){var e=this.colModel,t=e.length;for(var n=t-1;n>=0;n--){var r=e[n].hidden;if(!r){return n}}return null};i.getTotalVisibleColumns=function(){var e=this.colModel,t=e.length,n=0;for(var r=0;r<t;r++){var i=e[r],s=i.hidden;if(!s){n++}}return n};i._getTotalVisibleRows=function(e,t,n,r){var i=0,s=r?r.length:0,o=t,u=0,a=0,f=null,l=false,c=false,h=this.iHierarchy?true:false,p=this.options,d=p.detailModel.offset,v=0,m=22,g=h?this.$cont[0].offsetHeight:undefined;if(r==null||s==0){return{initV:f,finalV:f,tvRows:i,lastFrozenRow:f}}for(var y=0,b=s>t?t:s;y<b;y++){var w=r[y],E=w.pq_hidden;if(!E){f=y;i++;if(h){var S=w.pq_detail;if(S&&S.show){var x=S.height||0;if(x>d){x=d}v+=x+m}else{v+=m}}}}if(s<t){return{initV:f,finalV:f,tvRows:i,lastFrozenRow:f}}n=n-i;for(var y=t,b=s;y<b;y++){var w=r[y],E=w.pq_hidden;if(!l){if(E){o++}else{if(a==e){l=true;u=o;a=0}else{o++;a++}}}else{if(!c){if(E){u++}else{if(a==n){c=true}else{u++;a++}}}}if(!E){i++;if(h&&l){var S=w.pq_detail;if(S&&S.show){var x=S.height||0;if(x>d){x=d}v+=x+m}else{v+=m}if(v>g){c=true}}}}if(o>=s){o=s-1}if(u<o){u=o}return{initV:o,finalV:u,tvRows:i,lastFrozenRow:f}};i._setScrollVLength=function(){var e=this.$cont.height();var t=this._getScollBarHorizontalHeight();this.$vscroll.css("bottom",t);var n=e-t;this.$vscroll.pqScrollBar("option","length",n);return};i._setInnerGridHeight=function(){var e=this.options;if(e.flexHeight){return}var t=this.element.height()-(e.showTop?this.$top[0].offsetHeight:0)-this.$bottom[0].offsetHeight;this.$grid_inner.height(t+"px")};i._setRightGridHeight=function(){var e=this.options,t=this.$header,n=0;if(t){n=t[0].offsetHeight;this.$header_o.height(n-2)}else{this.$header_o.height(0)}if(e.flexHeight){return}this.$vscroll.css("visibility","");if(this.$tbl){this.$tbl.css("marginBottom",0)}var r=this.element.height()-this.$header_o[0].offsetHeight-(e.showTop?this.$top[0].offsetHeight:0)-this.$bottom[0].offsetHeight;var i=0;this.$cont.height(r-i+"px")};i._setGridHeightFromTable=function(){var e=0;var t=this._getScollBarHorizontalHeight(),n=this.$tbl;if(n&&n.length){e=n[0].offsetHeight-1;n.css("marginBottom",t)}else{e=22}var r=e+t;this.$cont.height("");this.element.height("");this.$grid_inner.height("");this.$vscroll.css("visibility","hidden")};i._setGridWidthFromTable=function(){var e;var t=this._getSBWidth();if(this.$tbl&&this.$tbl[0]&&this.$tbl[0].scrollWidth>0){e=this.$tbl[0].scrollWidth;this.element.width(e+t+"px")}else{e=f.call(this,-1,this.colModel.length);this.element.width(e+"px")}};i._bufferObj_minRowsPerGrid=function(){var e=this.$cont[0].offsetHeight;return Math.ceil(e/this.rowHeight)};i._calcCurPosFromRowIndxPage=function(e){var t=this.options,n=t.groupModel,r=n?this.dataGM:this.data,i=t.freezeRows;if(e<i){return 0}var s=0,o=i;for(var u=i,a=r.length;u<a;u++){var f=r[u];if(n&&(f.groupSummary||f.groupTitle)){}else{if(o==e){break}o++}var l=f.pq_hidden;if(!l){s++}}if(s>=a){return null}else{return s}};i._calcCurPosFromColIndx=function(e){var t=this.options,n=this.data,r=this.colModel,i=t.freezeCols;if(e<i){return 0}var s=0,o=i;for(var u=i,a=r.length;u<a;u++){var f=r[u];if(o==e){break}o++;var l=f.hidden;if(!l){s++}}if(s>=a){return null}else{return s}};i._bufferObj_calcInitFinal=function(){var e=this.options,t=e.virtualY,n=e.freezeRows,r=e.flexHeight,i=e.groupModel,s=i?true:false,o=s?this.dataGM:this.data,u=e.treeModel;if(o==null||o.length==0){var a=this._getTotalVisibleRows(l,n,c,o);this.totalVisibleRows=a.tvRows;this.initV=a.initV;this.finalV=a.finalV;this.lastFrozenRow=a.lastFrozenRow}else{if(!t){var a=this._getTotalVisibleRows(0,n,c,o);this.lastFrozenRow=a.lastFrozenRow;this.totalVisibleRows=a.tvRows;this.initV=0;this.finalV=o.length-1;return}else{var f=this.$vscroll.pqScrollBar("option"),l=parseInt(f.cur_pos);if(isNaN(l)||l<0){throw"cur_pos NA";this.initV=0}this.scrollCurPos=l;var c=this._bufferObj_minRowsPerGrid();this.pageSize=c;var a=this._getTotalVisibleRows(l,n,c,o);this.totalVisibleRows=a.tvRows;this.initV=a.initV;this.lastFrozenRow=a.lastFrozenRow;if(r){this.finalV=o.length-1}else{this.finalV=a.finalV}}}};i._bufferObj_calcInitFinalH=function(){var e=this.options,t=e.virtualX,n=this.colModel,r=n.length;if(!t){this.initH=0;this.finalH=r-1;return}var i=parseInt(this.$hscroll.pqScrollBar("option","cur_pos")),s=parseInt(e.freezeCols),o=e.flexWidth,u=s,a=0;for(var l=s;l<r;l++){if(n[l].hidden){u++}else{if(a==i){break}else{u++;a++}}}if(u>r-1){u=r-1}this.initH=u;if(o||!t){this.finalH=r-1}else{var c=f.call(this,-1,s),h=this.$cont[0].offsetWidth-this._getSBWidth();for(var l=u;l<r;l++){var p=n[l];if(!p.hidden){var d=p.outerWidth;if(!d){if(e.debug){throw"outerwidth N/A"}}c+=d;if(c>h){break}}}var v=l;if(v>r-1){v=r-1}this.finalH=v}};var f=function(e,t,n){var r=0,i=this.options,s=i.columnBorders,o=s?1:0,u=i.numberCell,a=this.colModel;if(e==-1){if(u.show){if(n){r+=parseInt(u.width)+1}else{r+=u.outerWidth}}e=0}if(n){for(var f=e;f<t;f++){var l=a[f],c=l.hidden;if(!c){if(!l._width){throw"assert failed"}r+=l._width+o}}}else{for(var f=e;f<t;f++){var l=a[f];if(l&&!l.hidden){r+=l.outerWidth}}}return r};e.paramquery.pqgrid.calcWidthCols=f;i.calcHeightFrozenRows=function(){var t=this.$tbl,n=0;if(t&&t.length){var r=e(t[0]).find("tr.pq-last-freeze-row");if(r&&r.length){var i=r[0];n=i.offsetTop+i.offsetHeight}else{n=0}}return n};i._calcRightEdgeCol=function(e){var t=0,n=0,r=this.colModel,i=this.hidearrHS,s=this.options.numberCell;if(s.show){t+=s.outerWidth;n++}for(var o=0;o<=e;o++){var u=r[o];if(!u.hidden&&i[o]==false){t+=u.outerWidth;n++}}return{width:t,cols:n}};i._refreshFreezeLine=function(){var t=this.options,n=t.numberCell,r=this.$cont_o,i=t.freezeCols;if(this.$freezeLine){this.$freezeLine.remove()}if(i){var s=f.call(this,-1,i)-1;if(isNaN(s)||s==0){}else{if(s>0&&n.show&&s==n.width){}else{this.$freezeLine=e("<div class='pq-grid-vert-freezeline' ></div>").appendTo(r);var o=r[0].offsetHeight;this.$freezeLine.css({height:o,left:s})}}}};i._getDragHelper=function(t){var n=this.options,r=parseInt(n.freezeCols),i=e(t.currentTarget);this.$cl=e("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner);this.$clleft=e("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner);var s=parseInt(i.attr("pq-grid-col-indx"));var o=this.$grid_inner.outerHeight();this.$cl.height(o);this.$clleft.height(o);var u=e("td[pq-grid-col-indx="+s+"]",this.$header)[0];var a=u.offsetLeft;if(this.pqpanes.v){if(s>=r){a+=this.$header[1].offsetLeft}}else{a+=this.$header[0].offsetLeft}this.$clleft.css({left:a});a=a+u.offsetWidth;this.$cl.css({left:a})};i._setDragLimits=function(e){var t=this,n=this.colModel,r=n[e],i=this.options,s=i.numberCell,o=t.$header_left;if(e>=i.freezeCols&&t.pqpanes.v){o=t.$header_right}var u=o.find("td[pq-grid-col-indx='"+e+"']");var a=u.offset().left+r._minWidth;if(e==-1){a=u.offset().left+s.minWidth}var f=a+r._maxWidth-r._minWidth;var l=o.find("div.pq-grid-col-resize-handle[pq-grid-col-indx="+e+"]");l.draggable("option","containment",[a,0,f,0])};i.nestedCols=function(e,t,n){var r=e.length;var i=[];if(t==null){t=1}var s=t,o=0,u=0,a=0;for(var f=0;f<r;f++){var l=e[f];if(n===true||n===false){l.hidden=n}if(l.colModel!=null&&l.colModel.length>0){var c=this.nestedCols(l.colModel,t+1,l.hidden);i=i.concat(c.colModel);if(c.colSpan>0){if(c.depth>s){s=c.depth}l.colSpan=c.colSpan;o+=c.colSpan}else{l.colSpan=0;l.hidden=true}l.childCount=c.childCount;a+=c.childCount}else{if(l.hidden){l.colSpan=0}else{l.colSpan=1;o++}l.childCount=0;a++;i.push(l)}}return{depth:s,colModel:i,colSpan:o,width:u,childCount:a}};i.getHeadersCells=function(){var e=this.options.colModel,t=this.colModel.length,n=this.depth;var r=[];for(var i=0;i<n;i++){r[i]=[];var s=0;var o=0,u=0;for(var a=0;a<t;a++){var f;if(i==0){f=e[s]}else{var l=r[i-1][a];var c=l.colModel;if(c==null||c.length==0){f=l}else{var h=a-l.leftPos;var p=0,d=0;var v=0;for(var m=0;m<c.length;m++){d+=c[m].childCount>0?c[m].childCount:1;if(h<d){v=m;break}}f=c[v]}}var g=f.childCount?f.childCount:1;if(a==u){f.leftPos=a;r[i][a]=f;u+=g;if(e[s+1]){s++}}else{r[i][a]=r[i][a-1]}}}this.headerCells=r;return r};i.getDataType=function(){var e=this.colModel;if(e&&e[0]){var t=e[0].dataIndx;if(typeof t=="string"){return"JSON"}else{if(typeof t=="number"){return"ARRAY"}}}throw"dataType unknown"};i.assignRowSpan=function(){var e=this.options.colModel,t=this.colModel.length,n=this.headerCells,r=this.depth;for(var i=0;i<t;i++){for(var s=0;s<r;s++){var o=n[s][i];if(i>0&&o==n[s][i-1]){continue}else{if(s>0&&o==n[s-1][i]){continue}}var u=1;for(var a=s+1;a<r;a++){var f=n[a][i];if(o==f){u++}}o.rowSpan=u}}return n};i._calcThisColModel=function(){var t=this.options,n=t.columnTemplate,r=t.colModel;var i=this.nestedCols(r);this.colModel=i.colModel;this.depth=i.depth;if(n){var s=this.colModel;for(var o=0,u=s.length;o<u;o++){var a=s[o];s[o]=e.extend({},n,a,true)}}this.getHeadersCells();this.assignRowSpan()};var l=function(e){this.that=e};var c=l.prototype;c._computeOuterWidths=function(){var e=this.that,t=e.options,n=t.columnBorders,r=n?1:0,i=t.numberCell,s=e.colModel,o=e.outerWidths,u=s.length;for(var a=0;a<u;a++){var f=s[a];f.outerWidth=f._width+r}if(i.show){i.outerWidth=i.width+1}};c.autoFit=function(){var e=this.that,t=e.options,n=t.columnBorders?1:0,r=e.colModel,i=e.$cont,s=r.length;var o=f.call(e,-1,s,true);var u=i[0].offsetWidth-e._getSBWidth();if(o!=u){var a=o-u,l,c=[];for(var h=0;h<s;h++){var p=r[h],d=p._percent,v=p.resizable!==false,m=p._resized,g=p.hidden;if(!g&&!d&&!m){var y;if(a<0){y=p._maxWidth-p._width;if(y){c.push({availWd:-1*y,colIndx:h})}}else{y=p._width-p._minWidth;if(y){c.push({availWd:y,colIndx:h})}}}if(m){l=p;delete p._resized}}c.sort(function(e,t){if(e.availWd>t.availWd){return 1}else{if(e.availWd<t.availWd){return-1}else{return 0}}});for(var h=0,b=c.length;h<b;h++){var w=c[h],y=w.availWd,E=w.colIndx,S=Math.round(a/(b-h)),p=r[E],x,T=p._width;if(Math.abs(y)>Math.abs(S)){x=T-S;a=a-S}else{x=T-y;a=a-y}p.width=p._width=x}if(a!=0&&l){var x=l._width-a;if(x>l._maxWidth){x=l._maxWidth}else{if(x<l._minWidth){x=l._minWidth}}l.width=l._width=x}}};c.autoLastColumn=function(){var e=this.that,t=e.options,n=t.columnBorders?1:0,r=e.colModel,i=r.length,s=t.freezeCols,o=e.$cont,u=o[0].offsetWidth-e._getSBWidth(),a=f.call(e,-1,s,true);var l=u-a,c=false,h=e._getLastVisibleColIndx();if(h==null){return}var p=r[h];if(p._percent){return}var d=p._width,v,m=p._minWidth,g=p._maxWidth;for(var y=i-1;y>=s;y--){var b=r[y];if(b.hidden){continue}var w=b._width+n;l=l-w;if(l<0){c=true;if(d+l>=m){v=d+l}else{v=d+w+l}break}}if(!c){v=d+l}if(v>g){v=g}else{if(v<m){v=m}}p.width=p._width=v};c.numericVal=function(e,t){if((e+"").indexOf("%")>-1){return parseInt(e)*t/100}else{return parseInt(e)}};c.refreshColumnWidths=function(){var e=this.that,t=e.options,n=t.numberCell,r=t.flexWidth,i=t.columnBorders,s=i?1:0,o=e.colModel,u=t.scrollModel,a=u.lastColumn,f=u.autoFit,l=e.$cont,c=o.length,h=e._getSBWidth(),p=t._minColWidth,d=t._maxColWidth;if(!l||!l[0].offsetWidth){return}var v=l[0].offsetWidth;var m=0;if(n.show){if(n.width<n.minWidth){n.width=n.minWidth}n.outerWidth=n.width+1;m=n.outerWidth}var g=v-h-m,p=Math.floor(this.numericVal(p,g)),d=Math.ceil(this.numericVal(d,g)),y=0;if(g<5||isNaN(g)){if(t.debug){throw"availWidth N/A"}return}delete e.percentColumn;for(var b=0;b<c;b++){var w=o[b],E=w.hidden;if(E){continue}var S=w.width,x=(S+"").indexOf("%")>-1?true:null,T=w.minWidth,N=w.maxWidth,T=T?this.numericVal(T,g):p,N=N?this.numericVal(N,g):d;if(N<T){N=T}if(S!=undefined){var C,k=0;if(!r&&x){e.percentColumn=true;w.resizable=false;w._percent=true;C=this.numericVal(S,g)-s;k=Math.floor(C);y+=C-k;if(y>=1){k+=1;y-=1}}else{if(S){k=parseInt(S)}}if(k<T){k=T}else{if(k>N){k=N}}w._width=k}else{w._width=T}if(!x){w.width=w._width}w._minWidth=T;w._maxWidth=N}if(l&&r==false){if(f){this.autoFit()}if(a=="auto"){this.autoLastColumn()}}this._computeOuterWidths()};i._createHeader=function(){var t=this,n=this.options,r=n.hwrap,i=parseInt(n.freezeCols),s=n.numberCell,o=this.colModel,u=o.length,a=this.depth,l=n.virtualX,c=t.initH,h=t.finalH,p=n.columnBorders,d=this.headerCells,v=[],m=this.hidearrHS,g=this.$header,y=this.$header_o;if(n.showHeader===false){if(g){g.empty()}this.$header_o.css("display","none");return}else{this.$header_o.css("display","")}var b="pq-grid-header-table ";if(r){b+="pq-wrap "}else{b+="pq-no-wrap "}var w=["<table class='"+b+"' cellpadding=0 cellspacing=0 >"];if(a>=1){w.push("<tr>");if(s.show){w.push("<td style='width:"+(s.width+1)+"px;' ></td>")}for(var E=0;E<=h;E++){if(E<c&&E>=i&&l){E=c;if(E>h){throw"initH>finalH"}}var S=o[E];if(S.hidden){continue}var x=S.outerWidth;w.push("<td style='width:"+x+"px;' pq-col-indx="+E+"></td>")}w.push("</tr>")}var T="pq-grid-col ";for(var N=0;N<a;N++){w.push("<tr class='pq-grid-title-row'>");if(N==0&&s.show){w.push(["<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='",a,"'>","<div class='pq-td-div'>",s.title?s.title:"&nbsp;","</div></td>"].join(""))}for(var E=0;E<=h;E++){if(E<c&&E>=i&&l){E=c;if(E>h){throw"initH>finalH";break}}this._createHeaderCell(N,E,d,w,T,i,c,a)}w.push("</tr>")}this.ovCreateHeader(w,T);w.push("</table>");var C=w.join("");y.empty();if(this.pqpanes.v){y.append(["<span class='pq-grid-header pq-grid-header-left ui-state-default'>",C,"</span>","<span class='pq-grid-header ui-state-default'>",C,"</span>"].join(""))}else{y.append(["<span class='pq-grid-header ui-state-default'>",C,"</span>"].join(""))}var g=this.$header=e(".pq-grid-header",y);this.$tbl_header=g.children("table");var x=f.call(this,-1,i);var k=this.$header_left=e(g[0]);if(this.pqpanes.v){var k=this.$header_left=e(g[0]);var L=this.$header_right=e(g[1]);k.css({width:x,zIndex:10});var A=f.call(this,i,c);L.css({left:-1*A+"px"})}g.click(function(n){if(t.iDragColumns&&t.iDragColumns.status!="stop"){return}var r=e(n.target),i=r.closest(".pq-g-ficon");if(i.length){var s=i.attr("pq-col-indx");n.stopImmediatePropagation();return t.iHeaderIconSearch.createDOM(s,i,n)}var o=r.closest("td.pq-grid-col");if(o.length){n.stopImmediatePropagation();var s=o.attr("pq-grid-col-indx");if(s==null){return}}else{return}return t._onHeaderCellClick(s,n)});this._refreshResizeColumn(c,h,o);this._trigger("refreshHeader",null,null)};i._createHeaderCell=function(e,t,n,r,i,s,o,u){var a=n[e][t],f=a.colSpan,l=a.halign,c=a.align,h=a.title,h=h?h:"";if(e>0&&a==n[e-1][t]){return}else{if(t>0&&a==n[e][t-1]){return}}if(a.hidden){return}var p=i;if(l!=null){p+=" pq-align-"+l}else{if(c!=null){p+=" pq-align-"+c}}if(t==s-1&&u==1){p+=" pq-last-freeze-col"}if(t<=s-1){p+=" pq-left-col"}else{if(t>=o){p+=" pq-right-col"}}var d=a.cls;if(d){p=p+" "+d}var v="",m="";if(a.colModel==null||a.colModel.length==0){v="pq-grid-col-indx='"+t+"'"}var g="pq-row-indx="+e;var y="pq-col-indx="+t;r.push(["<td ",v," ",y," ",g," ",m," class='",p,"' rowspan=",a.rowSpan," colspan=",f,">","<div class='pq-td-div'>",h,"<span class='pq-col-sort-icon'>&nbsp;</span></div></td>"].join(""))};i.ovCreateHeader=function(){};i._refreshResizeColumn=function(t,n,r){var i=this,s=this.options,o=s.virtualX,u=s.filterModel.ficon?true:false,a=s.numberCell,f=i.$header.height(),l=parseInt(s.freezeCols),c=[],h=[];if(a.show&&a.resizable){var p=i.$header_left.find("td.pq-grid-number-col")[0];E=parseInt(p.offsetLeft)+(p.offsetWidth-10);c.push("<div pq-grid-col-indx='-1' style='left:",E,"px;height:",f,"px;' class='pq-grid-col-resize-handle'>&nbsp;</div>")}for(var d=0;d<=n;d++){if(d<t&&d>=l){d=t;if(d>n){throw"initH>finalH"}}var v=r[d];if(v.hidden){continue}var m=v.ficon,g=m||m==null&&u,y,b=c,p,w,E;if(v.resizable!==false||g){y=i.$header_left;if(this.pqpanes.v&&d>=l){y=i.$header_right;b=h}p=y.find("td[pq-grid-col-indx="+d+"]")[0];w=parseInt(p.offsetLeft);E=w+(p.offsetWidth-5)}if(v.resizable!==false){b.push("<div pq-grid-col-indx='",d,"' style='left:",E,"px;height:",f,"px;' class='pq-grid-col-resize-handle'>&nbsp;</div>")}}i.$header_left.append(c.join(""));if(h.length){i.$header_right.append(h.join(""))}var S,x,T;var N=i.$header.find(".pq-grid-col-resize-handle").draggable({axis:"x",helper:function(t,n){var r=e(t.target);var s=parseInt(r.attr("pq-grid-col-indx"));i._setDragLimits(s);i._getDragHelper(t,n);return r},start:function(e,t){S=t.position.left;T=parseInt(i.$cl[0].style.left)},drag:function(e,t){x=t.position.left;var n=x-S;i.$cl[0].style.left=T+n+"px"},stop:function(e,t){return i._refreshResizeColumnStop(e,t,r,S)}})};i._refreshResizeColumnStop=function(t,n,r,i){var s=this,o=this.options,u=o.numberCell;s.$clleft.remove();s.$cl.remove();var a=n.position.left;var f=a-i;var l=e(n.helper),c=parseInt(l.attr("pq-grid-col-indx")),h;if(c==-1){h=null;var p=parseInt(u.width);var d=p+f;u.width=d}else{h=r[c];var p=parseInt(h.width);var d=p+f;h.width=d;h._resized=true}s.refresh();s._trigger("columnResize",t,{colIndx:c,column:h,dataIndx:h?h.dataIndx:null,oldWidth:p,newWidth:h?h.width:u.width})};i._refreshHeaderSortIcons=function(){var e=this.options.dataModel;if(e.sortIndx==undefined){return}var t=this.$header;var n=t.find(".pq-grid-col");n.removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active");t.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");var r=e.sortIndx;var i=this.getColIndx({dataIndx:r});var s="ui-state-active pq-col-sort-"+(e.sortDir=="up"?"asc":"desc");var o="ui-icon ui-icon-triangle-1-"+(e.sortDir=="up"?"n":"s");t.find(".pq-grid-col[pq-grid-col-indx="+i+"]").addClass(s);t.find(".pq-grid-col[pq-grid-col-indx="+i+"] .pq-col-sort-icon").addClass(o)};i.createTable=function(e){this.iGenerateView.generateView(e)};e.widget("paramquery._pqGrid",e.ui.mouse,i);e.measureTime=function(e,t){var n=(new Date).getTime();e();var r=(new Date).getTime();var i=r-n}})(jQuery);(function(e){function i(t){var n=this;this.that=t;this.type="detail";this.refreshComplete=true;this.detachView=false;var r=t.widgetEventPrefix.toLowerCase(),i=t.eventNamespace;t.element.on(r+"cellclick"+i,function(e,t){if(n.belongs(e)){return n.cellClick(e,t)}});t.element.on(r+"cellkeydown"+i,function(t,r){if(n.belongs(t)&&t.keyCode==e.ui.keyCode.ENTER){return n.cellClick(t,r)}});t.element.on(r+"aftertable"+i,function(e,t){if(n.belongs(e)){return n.aftertable(e,t)}});t.element.on(r+"beforetableview"+i,function(e,t){if(n.belongs(e)){return n.beforeTableView(e,t)}});t.element.on(r+"beforerefreshdata"+i,function(e,t){if(n.belongs(e)){return n.beforeRefreshData(e,t)}})}var t=e.paramquery.cClass;var n=e.paramquery.pqgrid.calcWidthCols;var r={};r.getFocusElement=function(){var t=document.activeElement;if(t){var n=e(t),r=n.closest(".pq-grid");if(r.length){if(r[0]==this.element[0]){return{$ae:n,$grid:r}}else{return{$ae:n,$childGrid:r}}}}};r.inViewPort=function(t){var n=this,r=n.$cont[0],i=r.offsetHeight-n._getScollBarHorizontalHeight(),s=r.offsetWidth-n._getSBWidth()+1,o=t[0],u=e(o.offsetParent),a=parseInt(u.css("marginTop")),f=parseInt(u.css("marginLeft"));if(i>=o.offsetTop+o.offsetHeight+a){if(o.nodeName.toUpperCase()=="TD"){if(s>=o.offsetLeft+o.offsetWidth+f){return true}}else{return true}}};var s=i.prototype=new t;s.aftertable=function(t,n){var r=this.that,i=r.options.detailModel.init,s=r.data;if(!this.refreshComplete){return}this.refreshComplete=false;var o=r.$tbl.children("tbody").children("tr.pq-detail-child");for(var u=0;u<o.length;u++){var a=o[u],f=e(a),l=f.attr("pq-row-indx"),c=s[l],h=c.pq_detail["child"];if(!h){if(typeof i=="function"){h=i.call(r.element[0],{rowData:c});c.pq_detail["child"]=h}}var p=h.find(".pq-header-outer");f.children("td.pq-detail-child").append(h);if(p.height()==0){try{h.pqGrid("refresh")}catch(d){}}}this.refreshComplete=true;this.detachView=false};s.beforeTableView=function(e,t){if(!this.detachView){this.detachInitView(e,t)}};s.beforeRefreshData=function(e,t){if(!this.detachView){this.detachInitView(e,t)}};s.detachInitView=function(t,n){var r=this.that,i=r.data;if(!i||!i.length){return}var s=r.$tbl.children("tbody").children("tr.pq-grid-row");var o,u,a;for(var f=0;f<s.length;f++){var l=s[f],c=e(l),h=c.attr("pq-row-indx"),p=i[h];if(h==null||h==o){continue}else{o=h}if(p.pq_detail){u=null;a=0;if(p.pq_detail["child"]){var d=c.next();if(d.hasClass("pq-detail-child")){var v=d.children("td.pq-detail-child").children();if(v.length){a=v[0].offsetHeight;u=v.detach()}}}if(u&&u.length){p.pq_detail["child"]=u;p.pq_detail["height"]=a}}}this.detachView=true};s.cellClick=function(e,t){var n=this.that,r=t.column,i=t.rowData,s=t.rowIndx,o=this.type;if(r&&r.type===o){var u="pq_detail";if(i[u]==null){n.rowExpand({rowIndx:s,scrollRow:true})}else{if(i[u]["show"]===false){n.rowExpand({rowIndx:s,scrollRow:true})}else{n.rowCollapse({rowIndx:s,scrollRow:true})}}}};r.rowExpand=function(e){var t=this.getRowData(e),n=this.options.detailModel,r="pq_detail";if(t==null){return}if(t[r]==null){t[r]={show:true}}else{if(t[r]["show"]===false){t[r]["show"]=true}}if(!n.cache){var i=t[r]["child"];if(i){i.remove();t[r]["child"]=null;t[r]["height"]=0}}this.refresh();if(e.scrollRow){var s=e.rowIndx;this.scrollRow({rowIndx:s})}};r.rowInvalidate=function(e){var t=this.getRowData(e),n="pq_detail";var r=t[n]["child"];r.remove();t[n]["child"]=null};r.rowCollapse=function(e){var t=this.getRowData(e),n=this.options.detailModel,r="pq_detail";if(t==null||t[r]==null){return}else{if(t[r]["show"]===true){if(!n.cache){var i=t[r]["child"];if(i){i.remove();t[r]["child"]=null;t[r]["height"]=0}}t[r]["show"]=false;this.refresh();if(e.scrollRow){var s=e.rowIndx;this.scrollRow({rowIndx:s})}}}};var o=function(t){function s(e,n,r){t.filter({data:[{dataIndx:e,value:n,value2:r}]})}this.that=t;var n=this;this.dataHS={};var r=t.widgetEventPrefix.toLowerCase(),i=t.eventNamespace;t.element.on(r+"headerkeydown"+i,function(t,r){if(n.belongs(t)){var i=e(t.originalEvent.target);if(i.hasClass("pq-search-hd-field")){return n.onKeyDown(t,r,i)}else{return true}}});t.element.on(r+"createheader"+i,function(e,t){if(n.belongs(e)){return n._onCreateHeader()}});this.changeListener={change:function(e,t){s(t.dataIndx,t.value,t.value2)}};this.keyupListener={keyup:function(e,t){s(t.dataIndx,t.value,t.value2)}};this.clickListener={click:function(e,t){s(t.dataIndx,t.value)}}};var u=o.prototype=new t;u.get$Ele=function(t,n){var r=this.that,i=r.options.freezeCols,s=e(r.$tbl_header[0]),o,u=".pq-search-hd-field[name='"+n+"']",a=e(r.$tbl_header[r.$tbl_header.length==2?1:0]);if(t>=i){o=a.find(u)}else{o=s.find(u)}return o};u.onKeyDown=function(t,n,r){var i=this.that,s=t.keyCode,o=e.ui.keyCode,u;if(s===o.TAB){var a=r.attr("name"),f=i.getColIndx({dataIndx:a}),l=i.colModel,c,h=t.shiftKey,p=l[f];if(p.filter.condition=="between"){i.scrollColumn({colIndx:f});var d=this.get$Ele(f,a);if(d[0]==r[0]){if(!h){c=d[1]}}else{if(h){c=d[0]}}if(c){c.focus();t.preventDefault();return false}}do{if(h){f--}else{f++}if(f<0||f>=l.length){break}var p=l[f],v=p.filter;if(p.hidden){continue}if(!v){continue}i.scrollColumn({colIndx:f});var c,a=p.dataIndx,c=this.get$Ele(f,a);if(v.condition=="between"){if(h){c=e(c[1])}else{c=e(c[0])}}if(c){c.focus();t.preventDefault();return false}else{break}}while(1===1)}else{return true}};u._bindFocus=function(){function r(r){t._fixTableViewPort();var i=e(r.target);var s=i.attr("name");if(t.scrollColumn({dataIndx:s})){var o=t.getColIndx({dataIndx:s});var u=n.get$Ele(o,s);u.focus()}}function i(e){if(e.addEventListener){e.addEventListener("focus",r,true)}else{e.onfocusin=function(){var e=window.event;e.target=e.srcElement;r(e)}}}var t=this.that,n=this;var s=t.$header.find(".pq-grid-header-search");for(var o=0;o<s.length;o++){i(s[o])}};u._onCreateHeader=function(){var t=this,n=this.that,r=n.options,i=r.columnBorders,s=r.filterModel;if(!s.header){return}this._bindFocus();var o=n.colModel,u=n.initH,a=n.finalH,f=r.freezeCols,l=r.virtualX,c=n.$tbl_header,h=e(c[0]),p=e(c[1]),d="input,select";if(c.length>1){h.find(d).css("visibility","hidden");for(var v=0;v<f;v++){var m=o[v];var g=m.dataIndx;var d="*[name='"+g+"']";h.find(d).css("visibility","visible");p.find(d).css("visibility","hidden")}}for(var v=0;v<=a;v++){if(v<u&&v>=f&&l){v=u;if(v>a){throw"initH>finalH"}}var m=o[v];if(m.hidden){continue}var y=m.filter;if(!y){continue}var b=m.dataIndx,w=h;if(v>=f&&c.length>1){w=p}var E=w.find("*[name='"+b+"']");if(E.length==0){continue}var S=y.type,x=y.value,T=y.value2;if(S=="checkbox"&&y.subtype=="triple"){E.pqval({val:x})}else{if(S=="select"){E.val(x);var N=this.getWidth(m,i);E.css({width:N})}}var C=y.init;if(C){C.call(E,{dataIndx:b,column:m})}var k=y.listeners;if(k){for(var L=0;L<k.length;L++){var A=k[L];if(typeof A=="string"){A=t[A+"Listener"]}for(var O in A){var M=A[O];(function(t,r,i){t.bind(O,function(s){var o=n.getColumn({dataIndx:i}),u=o.filter;if(u.type=="checkbox"){if(u.subtype=="triple"){x=t.pqval({incr:true})}else{x=t.is(":checked")?true:false}}else{if(u.condition=="between"){x=e(t[0]).val();T=e(t[1]).val()}else{x=t.val()}}return r.call(this,s,{column:o,dataIndx:i,value:x,value2:T})})})(E,M,b)}}}}};u.getWidth=function(e,t){var n=parseInt(e.width)+(t?1:0),n=n-15;return n};u.createDOM=function(t,n){var r=this.that,i=this,s=r.initH,o=r.finalH,u=r.options,a=u.freezeCols,f=u.virtualX,l=r.colModel,c=u.columnBorders,h=this.dataHS,p=u.numberCell;t.push("<tr class='pq-grid-header-search'>");if(p.show){t.push(["<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='1'>","<div class='pq-grid-header-table-div'>&nbsp;</div></td>"].join(""))}for(var d=0;d<=o;d++){if(d<s&&d>=a&&f){d=s;if(d>o){throw"initH>finalH"}}var v=l[d];if(v.hidden){continue}var m=n,g=v.halign;if(!g){g=v.align}if(g=="right"){m+=" pq-align-right"}else{if(g=="center"){m+=" pq-align-center"}}var y=v.cls;if(y){m=m+" "+y}var b=v.filter;if(b){var w=v.dataIndx,E=b.type,S=b.value,x=b.condition,T=this.getWidth(v,c),N=b.cls,N="pq-search-hd-field "+(N?N:""),C=b.style,C=C?C:"",k=b.attr,k=k?k:"",L="",A;if(x=="between"){var O=b.value2,O=O!=null?O:"",A=T/2-9}if(E==="textbox"){S=S?S:"";N=N+" ui-corner-all pq-search-txt";if(x=="between"){L=this._input(w,S,A,N+" pq-from",C,k);L+="-"+this._input(w,O,A,N+" pq-to",C,k)}else{L=this._input(w,S,T,N,C,k)}}else{if(E==="textarea"){S=S?S:"";N=N+" ui-corner-all pq-search-txt";if(x=="between"){L=this._textarea(w,S,A,N,C,k);L+="-"+this._textarea(w,O,A,N,C,k)}else{L=this._textarea(w,S,T,N,C,k)}}else{if(E==="select"){if(b.cache){L=b.cache}else{var M=b.options;if(typeof M==="function"){M=M.call(r.element[0],{column:v,value:S,dataIndx:w,cls:N,style:C,attr:k})}N=N+" ui-corner-all";var _=["name='",w,"' class='",N,"' style='width:",T,"px;",C,"' ",k].join("");L=e.paramquery.select({options:M,attr:_,prepend:b.prepend,valueIndx:b.valueIndx,labelIndx:b.labelIndx,groupIndx:b.groupIndx});b.cache=L}}else{if(E=="checkbox"){var D=S==null||S==false?"":"checked=checked";L=["<input ",D," name='",w,"' type=checkbox class='"+N+"' style='"+C+"' "+k+"/>"].join("")}else{if(typeof E=="string"){L=E}else{if(typeof E=="function"){L=E.call(r.element[0],{width:T,value:S,value2:O,column:v,dataIndx:w,cls:N,attr:k,style:C})}}}}}}t.push(["<td class='",m,"'><div class='pq-grid-header-table-div' style='padding:0px 2px;' >","",L,"</div></td>"].join(""))}else{t.push(["<td class='",m,"'><div class='pq-grid-header-table-div' >","&nbsp;","</div></td>"].join(""))}}t.push("</tr>")};u._input=function(e,t,n,r,i,s){return['<input value="',t,"\" name='",e,"' type=text style='width:",n,"px;"+i+"' class='"+r+"' "+s+" />"].join("")};u._textarea=function(e,t,n,r,i,s){return["<textarea name='",e,"' style='width:",n,"px;"+i+"' class='"+r+"' "+s+" >",t,"</textarea>"].join("")};e.paramquery.select=function(e){var t=e.attr,n=e.options,r=e.groupIndx,i=e.labelIndx,s=e.valueIndx,o=e.prepend,u,a;var f=["<select ",t," >"];if(o){for(var l in o){f.push('<option value="',l,'">',o[l],"</option>")}}if(r){if(n&&n.length){for(var c=0,h=n.length;c<h;c++){var p=n[c],d=p[s];if(d==null){continue}u=p[r];if(a!=u){if(a!=null){f.push("</optgroup>")}f.push('<optgroup label="',u,'">');a=u}if(s!=i){var v=p[i];f.push('<option value="',d,'">',v,"</option>")}else{f.push("<option>",d,"</option>")}}f.push("</optgroup>")}}else{if(n&&n.length){for(var c=0,h=n.length;c<h;c++){var p=n[c];if(i!=null&&s!=null){var d=p[s];if(d==null){continue}if(i==s){f.push("<option>",d,"</option>")}else{var v=p[i];f.push('<option value="',d,'">',v,"</option>")}}else{if(typeof p=="object"){for(var l in p){f.push('<option value="',l,'">',p[l],"</option>")}}else{f.push("<option>",p,"</option>")}}}}}f.push("</select>");return f.join("")};e.fn.pqval=function(e){if(e){if(e.incr){var t=this.data("pq_value");this.prop("indeterminate",false);if(t){t=false;this.removeAttr("checked")}else{if(t===false){t=null;this.prop("indeterminate",true);this.removeAttr("checked")}else{t=true;this.attr("checked","checked")}}this.data("pq_value",t);return t}else{var t=e.val;this.data("pq_value",t);this.prop("indeterminate",false);if(t==null){this.prop("indeterminate",true);this.removeAttr("checked")}else{if(t){this.attr("checked","checked")}else{this.removeAttr("checked")}}return this}}else{return this.data("pq_value")}};var a={};a._generateTitleRow=function(e,t,n,r){var i=this.that,s=i.options,o=s.numberCell,u=t.groupTitle,a=e.title,f=t.level,l=t.GMRowIndx,c=e.icon,c=c?c[f]:null,c=c&&c.length&&c.length==2&&typeof c.push==="function"?c:["ui-icon-minus","ui-icon-plus"];if(a&&a[f]!=null){if(a[f]===false){return}u=a[f].replace("{0}",u);u=u.replace("{1}",t.items)}else{u=u+" - "+t.items+" item(s)"}n.push(["<tr class='pq-group-row pq-grid-row",r?" pq-last-freeze-row":"","' title=\"",t.groupTitle,'" id="pq_group_',t.groupTitle,"\" level='",f,"' GMRowIndx='",l,"'>"].join(""));if(o.show){n.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>")}var h=c[0];if(t.collapsed){h=c[1]}n.push("<td class='pq-grid-cell' colSpan='100' >","<div class='pq-td-div' style='margin-left:",f*16,"px;'>","<span class='ui-icon ",h,"'></span>",u,"</div></td>");n.push("</tr>")};a._generateSummaryRow=function(e,t,n,r){var i="pq-summary-row pq-grid-row"+(r?" pq-last-freeze-row":""),s=this.that,o=s.options,u=o.virtualX,a=s.initH,f=s.finalH,l=o.freezeCols,c=o.numberCell,h=o.columnBorders,p=o.wrap,d=this.offset;var v="pq-grid-cell ";var m="<tr class='"+i+"'>";n.push(m);if(c.show){n.push(["<td class='pq-grid-number-cell ui-state-default'>","&nbsp;</td>"].join(""))}for(var g=0;g<=f;g++){if(g<a&&g>=l&&u){g=a;if(g>f){throw"initH>finalH"}}var y=t[g],b=y.dataIndx;if(y.hidden){continue}var w="";var E=v;if(y.align=="right"){E+=" pq-align-right"}else{if(y.align=="center"){E+=" pq-align-center"}}if(g==l-1&&h){E+=" pq-last-freeze-col"}if(y.cls){E=E+" "+y.cls}var S=e[b]==null?"&nbsp;":e[b];var x=["<td class='",E,"' style='",w,"' >",S,"</td>"].join("");n.push(x)}n.push("</tr>");return n};a._generateDetailRow=function(e,t,n,r,i,s){var o="pq-grid-row pq-detail-child";if(s){o+=" pq-last-freeze-row"}var u=this.that,a=u.options,f=a.numberCell,l=n.length,c=this.offset;var h="pq-grid-cell ";if(!a.wrap||i){h+="pq-wrap-text "}if(a.stripeRows&&t/2==parseInt(t/2)){o+=" pq-grid-oddRow"}if(e.pq_rowselect){o+=" pq-row-select ui-state-highlight"}var p=e.pq_rowcls;if(p!=null){o+=" "+p}r.push("<tr pq-row-indx='"+t+"' class='"+o+"' >");if(f.show){r.push(["<td class='pq-grid-number-cell ui-state-default'>","&nbsp;</td>"].join(""))}r.push("<td class='"+h+" pq-detail-child' colSpan='20'></td>");r.push("</tr>");return r};var f=function(e){this.that=e};var l=f.prototype;l._refreshDataFromDataModel=function(){this._groupData();this.initcollapsed()};l.bindEvents=function(){var e=this;this.that.$cont.on("click","tr.pq-group-row",function(t){return e.onClickGroupRow(t)})};l.showHideRows=function(e,t,n){var r=[],i=this.that,s=i.dataGM;for(var o=e,u=s.length;o<u;o++){var a=s[o],f=a;if(f.groupSummary){if(a.level<t){break}else{a.pq_hidden=n}}else{if(f.groupTitle){if(a.collapsed){r.push({indx:o,level:a.level})}if(a.level<=t){break}else{a.pq_hidden=n}}else{a.pq_hidden=n}}}return r};l.onClickGroupRow=function(t){var n=e(t.currentTarget),r=this.that;var i=parseInt(n.attr("level")),s=parseInt(n.attr("GMRowIndx")),o=r.dataGM,u=true,a=o[s];if(!a.collapsed){a.collapsed=true;u=true}else{a.collapsed=false;u=false}if(u){this.showHideRows(s+1,i,true)}else{var f=this.showHideRows(s+1,i,false);for(var l=0;l<f.length;l++){var c=f[l].indx;var i=f[l].level;this.showHideRows(c+1,i,true)}}r.refresh()};l.initcollapsed=function(){var e=this.that,t=e.dataGM;if(!t){return}for(var n=0,r=t.length;n<r;n++){var i=t[n],s=i.groupTitle;if(s!==undefined){var o=i.level,u=i.collapsed;if(u){this.showHideRows(n+1,o,true)}}}};l.max=function(e,t){var n;if(t=="integer"||t=="float"){n=Math.max.apply(Math,e);if(t==="float"){n=n.toFixed(2)}}else{if(t=="date"){e=e.sort(function(e,t){e=Date.parse(e);t=Date.parse(t);return e-t});n=e[e.length-1]}else{e=e.sort();n=e[e.length-1]}}return n};l.min=function(e,t){var n;if(t=="integer"||t=="float"){n=Math.min.apply(Math,e);if(t==="float"){n=n.toFixed(2)}}else{if(t=="date"){e=e.sort(function(e,t){e=Date.parse(e);t=Date.parse(t);return e-t});n=e[0]}else{e=e.sort();n=e[0]}}return n};l.count=function(e){return e.length};l.sum=function(e,t){var n=0,r;if(t==="float"){r=parseFloat}else{if(t==="integer"){r=parseInt}else{r=function(e){return e}}}for(var i=0,s=e.length;i<s;i++){n+=r(e[i])}if(t==="float"){n=n.toFixed(2)}return n};l._groupData=function(){var t=this.that,n=t.data,r=t.options,i=r.groupModel,s=r.pageModel,o=t.colModel,u=s.type?(s.curPage-1)*s.rPP:0,a=o.length,f=i.dataIndx,l=f.length,c=i.collapsed,h=[];for(var p=0;p<l;p++){h[p]=false;for(var d=0;d<a;d++){var v=o[d],m=v.summary;if(!m){continue}var g=m.type;if(!g||typeof g.push!="function"){continue}if(g[p]){h[p]=true;break}}}if(i&&n&&n.length>0){var y=[],b=[],w=[],E=[],S=[];for(var p=0;p<l;p++){E[p]="";w[p]="";S[p]={}}for(var x=0,T=n.length;x<=T;x++){var N=n[x];var C=false,k=null;for(var p=0;p<l;p++){w[p]=x<T?e.trim(N[f[p]]):"";if(E[p]!=w[p]){C=true}if(C&&k==null){k=p}}if(C){for(var L=0;L<l;L++){E[L]=w[L]}if(x>0){for(var p=l-1;p>=k;p--){if(h[p]){var A=[];for(var O=0;O<a;O++){var v=o[O],m=v.summary,g=m?m.type?m.type[p]:null:null;if(g){var M=v.dataIndx,_="",D=m.title?m.title[p]:null,P="{0}";if(typeof g=="function"){_=g(S[p][M],v.dataType)}else{P=g+": {0}";_=this[g](S[p][M],v.dataType)}if(D){P=D}A[M]=P.replace("{0}",_)}}y.push({groupSummary:true,level:p,data:A})}}for(var H=k;H<l;H++){y[b[H]].items=S[H][o[0].dataIndx].length}}if(x==T){break}for(var B=l-1;B>=k;B--){for(var j=0;j<a;j++){var v=o[j];S[B][v.dataIndx]=[]}}for(var H=k;H<l;H++){y.push({groupTitle:w[H],level:H,GMRowIndx:y.length,collapsed:c&&c[H]!=null?c[H]:false});b[H]=y.length-1}}N.rowIndx=x+u;N.pq_hidden=false;y.push(N);for(var F=0;F<a;F++){var v=o[F],M=v.dataIndx;for(var p=0;p<l;p++){S[p][M].push(N[M])}}}t.dataGM=y}else{t.dataGM=null}};var c=function(t){this.that=t;this.$drag_helper=null;var n=t.options.dragColumns,r=n.topIcon,i=n.bottomIcon,s=this;this.status="stop";this.$arrowTop=e("<div class='pq-arrow-down ui-icon "+r+"'></div>").appendTo(t.element);this.$arrowBottom=e("<div class='pq-arrow-up ui-icon "+i+"' ></div>").appendTo(t.element);this.hideArrows();if(n&&n.enabled){t.$header_o.on("mousedown","td.pq-grid-col",function(t,n){if(e(t.target).is("input,select,textarea")){return}if(!t.pq_composed){s.setDraggables(t,n);t.pq_composed=true;var r=e.Event("mousedown",t);e(t.target).trigger(r)}})}};var h=c.prototype;h.showFeedback=function(e,t){var n=this.that;var r=e[0];var i=r.offsetParent.offsetParent;var s=r.offsetLeft+i.offsetLeft+(!t?r.offsetWidth:0)-8;var o=n.$grid_inner[0].offsetTop+r.offsetTop-16;var u=n.$grid_inner[0].offsetTop+n.$header[0].offsetHeight;this.$arrowTop.css({left:s,top:o,display:""});this.$arrowBottom.css({left:s,top:u,display:""})};h.showArrows=function(){this.$arrowTop.show();this.$arrowBottom.show()};h.hideArrows=function(){this.$arrowTop.hide();this.$arrowBottom.hide()};h.updateDragHelper=function(e){var t=this.that,n=t.options.dragColumns,r=n.acceptIcon,i=n.rejectIcon,s=this.$drag_helper;if(!s){return}if(e){s.children("span.pq-drag-icon").addClass(r).removeClass(i);s.removeClass("ui-state-error")}else{s.children("span.pq-drag-icon").removeClass(r).addClass(i);s.addClass("ui-state-error")}};h.setDraggables=function(t,n){var r=e(t.currentTarget),i=this.that,s=i.options.dragColumns,o=s.rejectIcon,u=this;if(r.hasClass("ui-draggable")){return}if(!i.getHeaderColumnFromTD(r)){return}r.draggable({distance:10,cursorAt:{top:-18,left:-10},helper:function(){var t=e(this);u.status="helper";u._setupDroppables(t);i.$header.find(".pq-grid-col-resize-handle").hide();var n=t.attr("pq-col-indx");var r=t.attr("pq-row-indx");t.droppable("destroy");var s=i.headerCells[r][n];var a=e("<div class='pq-col-drag-helper ui-widget-content ui-corner-all' ><span class='pq-drag-icon ui-icon "+o+"'></span>"+s.title+"</div>");u.$drag_helper=a;return a[0]},zIndex:"1000",appendTo:i.element,revert:"invalid",drag:function(t,n){u.status="drag";var r=e("td.pq-drop-hover",i.$header);if(r.length>0){u.showArrows();u.updateDragHelper(true);var s=r.width();var o=t.clientX-r.offset().left+e(document).scrollLeft();if(o<s/2){u.leftDrop=true;u.showFeedback(r,true)}else{u.leftDrop=false;u.showFeedback(r,false)}}else{u.hideArrows();if(i.$toolbar.hasClass("pq-drop-hover")){u.updateDragHelper(true)}else{u.updateDragHelper()}}},stop:function(e,t){u.status="stop";i.$header.find(".pq-grid-col-resize-handle").show();u.hideArrows()}})};h._columnIndexOf=function(e,t){for(var n=0,r=e.length;n<r;n++){if(e[n]==t){return n}}return-1};h._setupDroppables=function(t){var n=this.that,r=n.options,i=this;var s={hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(t,r){if(n.dropPending){return}var s=parseInt(r.draggable.attr("pq-col-indx"));var o=parseInt(r.draggable.attr("pq-row-indx"));var u=parseInt(e(this).attr("pq-col-indx"));var a=e(this).attr("pq-row-indx");var f=n.options.colModel;var l=n.headerCells;var c=l[o][s];var h,p;if(o==0){h=f}else{h=l[o-1][s].colModel}if(a==0){p=f}else{p=l[a-1][u].colModel}var d=l[a][u];var v=i._columnIndexOf(h,c);var m=h.splice(v,1)[0];var g=i._columnIndexOf(p,d);var y=i.leftDrop?1:0;p.splice(g+1-y,0,m);n.dropPending=true;window.setTimeout(function(){n._calcThisColModel();n.refresh();n.dropPending=false},0)}};var o=n.$header_left.find("td.pq-left-col");var u=n.pqpanes.v?n.$header_right.find("td.pq-right-col"):n.$header_left.find("td.pq-right-col");o=o.add(u);o.each(function(t,n){var r=e(n);if(r.hasClass("ui-droppable")){return}r.droppable(s)});return};r.options={detailModel:{cache:true,offset:100,expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},dragColumns:{enabled:true,acceptIcon:"ui-icon-check",rejectIcon:"ui-icon-closethick",topIcon:"ui-icon-circle-arrow-s",bottomIcon:"ui-icon-circle-arrow-n"},track:false,treeModel:{collapsed:true,indent:15,leafIcon:"ui-icon-radio-off",expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},filterModel:{on:true,mode:"AND",header:false}};r._create=function(){e.extend(e.paramquery.cGenerateView.prototype,a);var t=this,n=this.options;this.iGroupView=new f(this);this.iHeaderSearch=new o(this);this.iUCData=new e.paramquery.cUCData(this);this.iMouseSelection=new e.paramquery.cMouseSelection(this);this._super.apply(this);this.iGroupView.bindEvents();this.iDragColumns=new c(this);this._createToolbar();this.refreshHeader();this.refreshDataAndView({header:false});this.refresh({table:true});var r=t.widgetEventPrefix.toLowerCase(),i=t.widgetName;t.element.one(r+"load."+i,function(e,n){t.refresh({header:false})})};r._createToolbar=function(){var t=this,n=this.options,r=n.toolbar;if(r){var i=r,s=i.cls,s=s?s:"",o=i.style,o=o?o:"",u=i.attr,u=u?u:"",a=i.items;var f=e("<div class='"+s+"' style='"+o+"' "+u+" ></div>").appendTo(e(".pq-grid-top",this.element));f.pqToolbar({items:a,gridInstance:this});if(!n.showToolbar){f.css("display","none")}this.$toolbar=f}};r.isLeftOrRight=function(e){var t=this.options,n=this.freezeCols;if(e>n){return"right"}else{return"left"}};r.ovCreateHeader=function(e,t){if(this.options.filterModel.header){this.iHeaderSearch.createDOM(e,t)}};r._createHeader=function(){this._super.apply(this);if(this.options.showHeader){this._trigger("createHeader")}};r.exportExcel=function(t){t.format="xml";return e.paramquery.pqgrid.exportToExcel.call(this,t)};r.exportCsv=function(t){t.format="csv";return e.paramquery.pqgrid.exportToExcel.call(this,t)};r.filter=function(t){var n=this,r=this.options,i=t.apply===undefined?true:t.apply,s=t.sort===undefined?true:t.sort,o=r.dataModel,u=r.filterModel;if(t!=undefined){var a=t.oper=="replace"?true:false,f=t.data,l=this.colModel,l=!i?e.extend(true,[],l):l,c=0,h=l.length,p=f.length;for(var d=0;d<h;d++){var v=l[d],m=false;for(var g=0;g<p;g++){if(c==p){break}var y=f[g];if(y.dataIndx==v.dataIndx){m=true;c++;var b=v.filter,w=y.condition,E=y.value;if(!b){b=v.filter={on:true}}else{b.on=true}if(w){b.condition=w}w=b.condition;b.value=E;if(w=="between"){b.value2=y.value2}else{if(w=="range"){var S=[];if(E){if(typeof E=="string"){var x=b.options;var T=E.indexOf('"');var N=E.lastIndexOf('"');E=E.substr(T,N+1);E=JSON.parse("["+E+"]");if(x){for(var C=0,k=x.length;C<k;C++){var L=x[C];if(e.inArray(L,E)!=-1){S.push(L)}}}else{S=E.split(",s*")}}else{if(typeof E.push=="function"){S=E}}}b.value=S}}break}}if(a&&!m&&v.filter){v.filter.on=false}}}var A={header:false,apply:i,sort:s,CM:l};if(o.location=="remote"&&u.type!="local"){this.remoteRequest({apply:i,CM:l,callback:function(){return n._onDataAvailable(A)}})}else{return n._onDataAvailable(A)}};r._initTypeColumns=function(){var t=this.colModel;for(var n=0,r=t.length;n<r;n++){var s=t[n];if(s.type==="checkBoxSelection"){new e.paramquery.cCheckBoxColumn(this,s.dataIndx)}else{if(s.type==="detail"){s.dataIndx="pq_detail";this.iHierarchy=new i(this)}}}};r.refreshHeader=function(){this._createHeader()};r.refreshDataFromDataModel=function(){this._super.apply(this);var e=this.options,t=e.groupModel,n=t?true:false;if(n){this.iGroupView._refreshDataFromDataModel()}};var p=e.paramquery.cSort=function(e){this.that=e};var d=p.prototype;d._refreshSorters=function(t){var n=this.that,r=n.options,i=r.dataModel,s=i.sortIndx,o=e.isArray(s),u=r.groupModel,a=u?u.dataIndx:null,f=u?u.dir:null,l=-1,c=[];if(u){for(var h=0;h<a.length;h++){var p=a[h];if(p==t){l=h}c.push({dataIndx:p,dir:f&&f[h]?f[h]:"up"})}}if(l!==-1){var d=c[l].dir;var v=d==="up"?"down":"up";c[l].dir=v;f[l]=v}else{if(t!=null){if(o){var m=e.inArray(t,i.sortIndx);if(m!=-1){if(i.sortDir[m]=="up"){i.sortDir[m]="down"}else{if(s.length==1){i.sortDir[m]="up"}else{i.sortIndx.splice(m,1);i.sortDir.splice(m,1)}}}else{var g=i.sortIndx.length;i.sortIndx[g]=t;i.sortDir[g]="up"}}else{if(i.sortIndx==t){i.sortDir=i.sortDir=="up"?"down":"up"}else{i.sortIndx=t;i.sortDir="up"}}}}if(i.sortIndx!=null){if(o){for(var h=0;h<s.length;h++){var y=s[h];if(this.inSorters(c,y)==-1){c.push({dataIndx:y,dir:i.sortDir[h]})}}}else{if(this.inSorters(c,i.sortIndx)==-1){c.push({dataIndx:i.sortIndx,dir:i.sortDir})}}}this.sorters=c};d.inSorters=function(e,t){var n=-1;for(var r=0;r<e.length;r++){var i=e[r];if(i.dataIndx==t){n=r;break}}return n};d._sortLocalData=function(e){var t=this.that,n=t.options,r=n.dataModel,i=t.colModel,s=this.sorters;for(var o=0;o<s.length;o++){var u=s[o],a=u.dataIndx,f=t.getColIndx({dataIndx:a}),l=i[f].dataType;u.dataType=l}return this.__sortLocalData(s,e)};d.__sortLocalData=function(t,n){function r(e,t,n,r){var i=e[n];var s=t[n];i=i?parseInt(i,10):0;s=s?parseInt(s,10):0;return(i-s)*r}function i(e,t,n,r){var i=e[n];var s=t[n];i=i?Date.parse(i):0;s=s?Date.parse(s):0;return(i-s)*r}function s(e,t,n,r,i){var s=e[n];var o=t[n];return i(s,o)*r}function o(e,t,n,r){var i=(e[n]+"").replace(/,/g,"");var s=(t[n]+"").replace(/,/g,"");i=i?parseFloat(i):0;s=s?parseFloat(s):0;return(i-s)*r}function u(e,t,n,r){var i=e[n];var s=t[n];i=i?i:"";s=s?s:"";var o=0;if(i>s){o=1}else{if(i<s){o=-1}}return o*r}function a(e,t,n,r){var i=e[n];var s=t[n];i=i?i.toUpperCase():"";s=s?s.toUpperCase():"";var o=0;if(i>s){o=1}else{if(i<s){o=-1}}return o*r}function f(e,t,n,r){var i=e[n];var s=t[n];var o=0;if(i&&!s||i===false&&s===null){o=1}else{if(s&&!i||s===false&&i===null){o=-1}}return o*r}function l(){function p(t,n){var r=0;for(var i=0;i<h;i++){r=e[i](t,n,l[i],c[i]);if(r!=0){break}}return r}var e=[],l=[],c=[],h=t.length;for(var d=0;d<h;d++){var v=t[d],m=v.dataIndx,g=v.dir=="up"?1:-1,y=v.dataType;l[d]=m;c[d]=g;if(y=="integer"){e[d]=r}else{if(y=="float"){e[d]=o}else{if(typeof y=="function"){e[d]=function(e){return function(t,n,r,i){return s(t,n,r,i,e)}}(y)}else{if(y=="date"){e[d]=i}else{if(y=="stringi"){e[d]=a}else{if(y=="bool"){e[d]=f}else{e[d]=u}}}}}}}n=n.sort(p)}if(n==null||n.length==0){return}if(!t||!t.length){return n}e.measureTime(l,"innerSort");return n};r._refreshHeaderSortIcons=function(){var e=this.options,t=e.dataModel,n=this.iSort.sorters,r=this.colModel;var i=this.$header;if(!i){return}var s=i.find(".pq-grid-col");s.removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active");i.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");for(var o=0;o<n.length;o++){var u=n[o];var a=u.dataIndx;var f=this.getColIndx({dataIndx:a});var l=u.dir;var c="ui-state-active pq-col-sort-"+(l=="up"?"asc":"desc");var h="ui-icon ui-icon-triangle-1-"+(l=="up"?"n":"s");i.find(".pq-grid-col[pq-grid-col-indx="+f+"]").addClass(c);i.find(".pq-grid-col[pq-grid-col-indx="+f+"] .pq-col-sort-icon").addClass(h)}};r.getHeaderColumnFromTD=function(e){var t=e.attr("pq-grid-col-indx");if(t==null){return}var n=this.colModel[t];return n};r.getIndxInSorters=function(e){var t=this.sorters;for(var n=0,r=t.length;n<r;n++){if(t[n].dataIndx==e){return n}}return-1};r.getLargestRowCol=function(e){var t,n;for(var r=0;r<e.length;r++){var i=e[r];var s=i.rowIndx;if(t==null){t=i.rowIndx}else{if(s>t){t=s}}t=i.rowIndx}};r.bringCellToView=function(e){this._bringCellToView(e)};r._setUrl=function(e){this.options.dataModel.getUrl=function(){return{url:this.url+(e!=null?e:"")}}};r.getDataPage=function(){return this.data};r.getData=function(e){var t=e.dataIndx,n=t.length,r=e.data,i=this.options.dataModel,s=i.data,o=i.dataUF,u=[],a=function(e){for(var r=0,i=e.length;r<i;r++){var s=e[r];var o={};for(var a=0;a<n;a++){var f=t[a];o[f]=s[f]}u.push(o)}};if(r){a(r)}else{if(s){a(s)}if(o){a(o)}}var f=[];for(var l=0;l<n;l++){var c=t[l];var h=this.getColumn({dataIndx:c});f.push({dataIndx:c,dir:"up",dataType:h.dataType})}u=this.iSort.__sortLocalData(f,u);var p=[],d=undefined;for(var v=0;v<u.length;v++){var m=u[v];var g=JSON.stringify(m);if(g!==d){p.push(m);d=g}}return p};r.getFilterData=function(t){var n=t.CM;if(!n){throw"CM N/A"}var r=n.length,i=t.location,s=this.options.filterModel,o=s.multiple,u=e.paramquery.filter.getAllConditions,a=e.paramquery.filter.getTRConditions,f=[],l=function(t,n,r){if(t=="between"){if((n==null||n==="")&&(r==null||r==="")){return false}else{return true}}else{if(e.inArray(t,u)!=-1){if(n==null||n===""){if(e.inArray(t,a)!=-1){return false}}return true}else{return true}}},c=function(e,t){if(i=="remote"){e=e==null?"":e;return e.toString()}else{return v.convert(e,t)}};for(var h=0;h<r;h++){var p=n[h],d=p.dataIndx,m=p.dataType,m=!m||typeof m=="function"?"string":m,g=p.filter;if(o){var y=p.filterModel;if(y&&y.on){var b=[],w=y.mode,E=y.filters;for(var S=0;S<E.length;S++){var g=E[S],x=g.value,T=g.condition;if(l(T,x)){x=c(x,m);b.push({value:x,condition:T})}}f.push({dataIndx:d,mode:w,dataType:m,filters:b})}}else{if(g&&g.on){var x=g.value,N=g.value2,T=g.condition;if(l(T,x,N)){if(T=="between"){if(x===""||x==null){T="lte";x=c(N,m)}else{if(N===""||N==null){T="gte";x=c(x,m)}else{x=c(x,m);N=c(N,m)}}}else{if(T=="regexp"){if(i=="remote"){x=x.toString()}else{if(typeof x=="string"){try{var C=g.modifiers,C=C?C:"gi";x=new RegExp(x,C)}catch(k){x=/.*/}}}}else{if(T=="range"){if(x==null){continue}else{if(typeof x=="string"){x=c(x,m);x=x.split(/\s*,\s*/)}else{if(x&&typeof x.push=="function"){if(x.length==0){continue}x=x.slice();for(var S=0,L=x.length;S<L;S++){x[S]=c(x[S],m)}}}}}else{x=c(x,m)}}}f.push({dataIndx:d,value:x,value2:N,condition:T,dataType:m,cbFn:i=="remote"?"":v.conditions[T]})}}}}return f};var v=function(e){this.that=e};var m=v.prototype;v.conditions={equal:function(e,t){if(e==t){return true}},contain:function(e,t){if(e.indexOf(t)!=-1){return true}},notcontain:function(e,t){if(e.indexOf(t)==-1){return true}},empty:function(e){if(e.length==0){return true}},notempty:function(e){if(e.length>0){return true}},begin:function(e,t){if(e.indexOf(t)==0){return true}},notbegin:function(e,t){if(e.indexOf(t)!=0){return true}},end:function(e,t){var n=e.lastIndexOf(t);if(n!=-1&&n+t.length==e.length){return true}},notend:function(e,t){var n=e.lastIndexOf(t);if(n!=-1&&n+t.length==e.length){}else{return true}},regexp:function(e,t){if(t.test(e)){t.lastIndex=0;return true}},notequal:function(e,t){if(e!=t){return true}},great:function(e,t){if(e>t){return true}},gte:function(e,t){if(e>=t){return true}},between:function(e,t,n){if(e>=t&&e<=n){return true}},range:function(t,n){if(e.inArray(t,n)!=-1){return true}},less:function(e,t){if(e<t){return true}},lte:function(e,t){if(e<=t){return true}}};v.convert=function(t,n){t=t==null?"":t;if(n=="string"){t=e.trim(t).toUpperCase()}else{if(n=="date"){t=Date.parse(t)}else{if(n=="integer"){t=parseInt(t)}else{if(n=="float"){t=parseFloat(t)}else{if(n=="bool"){t=String(t).toLowerCase()}}}}}return t};m.isMatchCellSingle=function(e,t){var n=e.dataIndx,r=e.dataType,i=e.value,s=e.value2,o=e.condition,u=e.cbFn,a=t[n];if(o=="regexp"){a=a==null?"":a}else{a=v.convert(a,r)}var f=u(a,i,s)?true:false;return f};m.isMatchCellMultiple=function(e,t){var n=e.dataIndx,r=e.dataType,i=e.mode,s=e.filters,o=s.length;if(o==0){return true}for(var u=0;u<o;u++){var a=s[u],f=a.value,l=a.condition,c=t[n],h=this.isMatchRule(c,l,f,r);if(i=="OR"&&h){return true}if(i=="AND"&&!h){return false}}if(o===1){return h}else{if(i=="AND"){return true}else{if(i=="OR"){return false}}}};m.isMatchRow=function(e,t,n){if(t.length==0){return true}for(var r=0;r<t.length;r++){var i=t[r],s=this.isMatchCell(i,e);if(n=="OR"&&s){return true}if(n=="AND"&&!s){return false}}if(n=="AND"){return true}else{if(n=="OR"){return false}}};r.filterLocalData=function(e){e=e?e:{};var t=e.apply,n=t===false?e.CM:this.colModel,r=this.getFilterData({CM:n}),i=this.options,s=i.dataModel,o=s.data,u=s.dataUF,a=[],f=[],l=i.filterModel,c=l.multiple,h=l?l.mode:null;var p=new v;if(c){p.isMatchCell=p.isMatchCellMultiple}else{p.isMatchCell=p.isMatchCellSingle}if(l.on&&h){if(o){for(var d=0,m=o.length;d<m;d++){var g=o[d];if(p.isMatchRow(g,r,h)){a.push(g)}else{f.push(g)}}}if(u){for(var d=0,m=u.length;d<m;d++){var g=u[d];if(p.isMatchRow(g,r,h)){a.push(g)}else{f.push(g)}}}}else{if(o){for(var d=0,m=o.length;d<m;d++){var g=o[d];a.push(g)}}if(u){for(var d=0,m=u.length;d<m;d++){var g=u[d];a.push(g)}}}if(t){s.data=a;s.dataUF=f;this._trigger("filter",null,{type:"local",dataModel:s,colModel:n,filterModel:l})}return{data:a,dataUF:f}};r._onDataAvailable=function(e){e=e?e:{};var t=this.options,n=e.apply,r=e.sort,i=[],s=t.filterModel,o=t.dataModel,u=o.location;if(n!==false){this._trigger("dataAvailable",e.evt,{dataModel:o})}if(s&&s.on&&(u=="local"&&s.type!="remote"||u=="remote"&&s.type=="local")){i=this.filterLocalData(e).data}else{i=o.data}if(o.sorting&&o.sorting=="local"){if(r!==false){i=this.iSort._sortLocalData(i)}}if(n===false){return i}else{o.data=i}this.refreshView(e)};r.sort=function(e){var t=this,n=this.options,r=e.colIndx,i=n.editModel,s=e.dataIndx,o=e.evt,u=n.dataModel;if(r==null&&s==null){s=u.sortIndx;if(s==null){return}}r=r==null?this.getColIndx({dataIndx:s}):r;var a=this.colModel[r];s=s==null?a.dataIndx:s;if(t._trigger("beforeSort",o,{dataModel:u,column:a,dataIndx:s})==false){return}if(i.indices){t.blurEditor({force:true})}this.iSort._refreshSorters(s);if(u.sorting=="local"){this.iSort._sortLocalData(u.data);this.refreshView()}else{if(u.sorting=="remote"){this.remoteRequest({callback:function(){t._trigger("sort",o,{dataModel:u,column:a,dataIndx:s});t._onDataAvailable()}})}}};r._setScrollVLength=function(e){var t=this.options.groupModel;e=t?this.dataGM:e;this._super.call(this,e)};e.widget("paramquery.pqGrid",e.paramquery._pqGrid,r);e.paramquery.pqGrid.regional={};e.paramquery.pqGrid.regional.en=r._regional})(jQuery);(function(e){e.paramquery=e.paramquery==null?{}:e.paramquery;e.paramquery.pqgrid=e.paramquery.pqgrid==null?{}:e.paramquery.pqgrid;e.paramquery.pqgrid.exportToExcel=function(t){var n=this,r=t.urlPost===undefined?t.url:t.urlPost,i=t.url,s=t.sheetName==null?"pqGrid":t.sheetName,o=t.format,u=function(){var e=n.colModel,t=e.length,r=n.options,i=r.dataModel,o=i.data,u=o.length,a=[];var f=[];for(var l=0;l<t;l++){var c=e[l];if(!c.hidden){f.push('<Column ss:AutoFitWidth="1"  ss:Width="'+c._width+'" />')}}f.push("<Row>");for(var l=0;l<t;l++){var c=e[l];if(!c.hidden){f.push('<Cell><Data ss:Type="String">'+c.title+"</Data></Cell>")}}f.push("</Row>");f=f.join("\n");for(var l=0;l<u;l++){var h=o[l];a.push("<Row>");for(var p=0;p<t;p++){var c=e[p];if(!c.hidden){var d=c.dataIndx;a.push('<Cell><Data ss:Type="String"><![CDATA['+h[d]+"]]></Data></Cell>")}}a.push("</Row>")}a=a.join("\n");var v=['<?xml version="1.0"?>','<?mso-application progid="Excel.Sheet"?>','<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:o="urn:schemas-microsoft-com:office:office"',' xmlns:x="urn:schemas-microsoft-com:office:excel"',' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:html="http://www.w3.org/TR/REC-html40">','<Worksheet ss:Name="',s,'">',"<Table>",f,a,"</Table>","</Worksheet>","</Workbook>"];return v.join("\n")},a=function(){var e=n.colModel,t=e.length,r=n.options,i=r.dataModel,s=i.data,o=s.length,u=[],a=[],f=[];for(var l=0;l<t;l++){var c=e[l];if(!c.hidden){var h=c.title.replace(/\"/g,'""');a.push('"'+h+'"')}}u.push(a.join(","));for(var l=0;l<o;l++){var p=s[l];for(var d=0;d<t;d++){var c=e[d];if(!c.hidden){var v=c.dataIndx;var m=p[v]+"";m=m.replace(/\"/g,'""');f.push('"'+m+'"')}}u.push(f.join(","));f=[]}return u.join("\n")};var f=o=="xml"?u():a();e.ajax({url:r,type:"POST",cache:false,data:{extension:o,excel:f},success:function(t){var n=i+((i.indexOf("?")>0?"&":"?")+"filename="+t);e(document.body).append("<iframe height='0' width='0' frameborder='0'  src="+n+"></iframe>")}})}})(jQuery);(function(e){var t=e.paramquery.cUCData=function(e){this.that=e;this.udata=[];this.ddata=[];this.adata=[];var t=this,n=e.eventNamespace,r=e.widgetEventPrefix.toLowerCase();e.element.on(r+"dataavailable"+n,function(e,n){if(t.belongs(e)){t.udata=[];t.ddata=[];t.adata=[]}})};var n=t.prototype=new e.paramquery.cClass;n.add=function(e){var t=this.that,n=this.adata,r=e.rowData,i=t.getRecId({rowData:r});for(var s=0,o=n.length;s<o;s++){var u=n[s];if(i!=null&&u.recId==i){throw"primary key violation"}if(u.rowData==r){throw"same data can't be added twice."}}var e={recId:i,rowData:r};n.push(e)};n.update=function(e){var t=this.that,n=t.getRowData(e),r=t.getRecId({rowData:n}),i=e.dataIndx,s=e.oldVal,o=e.newVal,u=this.udata,a=false;if(r==null){return}for(var f=0,l=u.length;f<l;f++){var c=u[f];if(c.rowData==n&&c.dataIndx==i){a=true;if(c.oldVal==o){u.splice(f,1);var h={rowData:n,dataIndx:i,cls:"pq-cell-dirty"};t.removeClass(h)}else{c.newVal=o}break}}if(!a){var h={rowData:n,recId:r,dataIndx:i,newVal:o,oldVal:s};u.push(h);var h={rowData:n,dataIndx:i,cls:"pq-cell-dirty"};t.addClass(h)}};n["delete"]=function(e){var t=this.that,n=e.rowIndx,r=e.rowIndxPage,i=t.rowIndxOffset,n=n==null?r+i:n,r=r==null?n-i:r,s=t.options.pageModel.type,o=s=="remote"?r:n,u=this.adata,a=this.ddata,f=t.getRowData(e);for(var l=0,c=u.length;l<c;l++){if(u[l].rowData==f){u.splice(l,1);return}}a.push({indx:o,rowData:f})};n.isDirty=function(){var e=this.that,t=this.udata,n=this.adata,r=this.ddata;if(t.length||n.length||r.length){return true}else{return false}};n.getChangesValue=function(){var t=this.that,n=this.udata,r=this.adata,i=this.ddata,s={updateList:[],addList:[],deleteList:[]},o=[],u=[],a=[],f=[],l=[];for(var c=0,h=i.length;c<h;c++){var p=i[c],d=p.rowData,v={};f.push(d);for(var m in d){if(m.indexOf("pq_")!=0){v[m]=d[m]}}l.push(v)}for(var c=0;c<n.length;c++){var p=n[c],d=p.rowData;if(e.inArray(d,f)!=-1){continue}if(e.inArray(d,o)==-1){var v={};for(var m in d){if(m.indexOf("pq_")!=0){v[m]=d[m]}}o.push(d);u.push(v)}}for(var c=0;c<r.length;c++){var p=r[c],d=p.rowData,v={};for(var m in d){if(m.indexOf("pq_")!=0){v[m]=d[m]}}a.push(v)}s.updateList=u;s.addList=a;s.deleteList=l;return s};n.getChanges=function(){var t=this.that,n=this.udata,r=this.adata,i=this.ddata,s={updateList:[],addList:[],deleteList:[]},o=[],u=[],a=[];for(var f=0,l=i.length;f<l;f++){var c=i[f],h=c.rowData;a.push(h)}for(var f=0;f<n.length;f++){var c=n[f],h=c.rowData;if(e.inArray(h,a)!=-1){continue}if(e.inArray(h,o)==-1){o.push(h)}}for(var f=0;f<r.length;f++){var c=r[f],h=c.rowData;u.push(h)}s.updateList=o;s.addList=u;s.deleteList=a;return s};n.getChangesRaw=function(){var e=this.that,t=this.udata,n=this.adata,r=this.ddata,i={updateList:[],addList:[],deleteList:[]};i.updateList=t;i.addList=n;i.deleteList=r;return i};n.getVal=function(e,t){if(t=="float"){e=e==null?null:parseFloat(e)}else{if(t=="integer"){e=e==null?null:parseInt(e)}else{if(t=="date"){e=e==null?null:Date.parse(e)}}}return e};n.commitAdd=function(t,n){var r=this.that.colModel,i=r.length,s=this.adata,o=s.length,u=t.length,a=[];for(var f=0;f<u;f++){var l=t[f];for(var c=0;c<o;c++){var h=s[c].rowData,p=true;for(var d=0;d<i;d++){var v=r[d],m=v.hidden,g=v.dataType,y=v.dataIndx;if(m||y==n){continue}var b=h[y],b=this.getVal(b,g),w=l[y],w=this.getVal(w,g);if(b!=w){p=false;break}}if(p){h[n]=l[n];a.push(h)}}}var E=[];for(var c=0;c<o;c++){var h=s[c].rowData;if(e.inArray(h,a)==-1){E.push(s[c])}}this.adata=E};n.commitUpdate=function(t,n){var r=this.that,i=r.colModel,s=i.length,o=this.udata,u=o.length,a=t.length,f=[];for(var l=0;l<u;l++){var c=o[l].rowData;if(e.inArray(c,f)!=-1){continue}for(var h=0;h<a;h++){var p=t[h];if(c[n]==p[n]){f.push(c);for(var d=0;d<s;d++){var v=i[d],m=v.hidden,g=v.dataIndx;if(p[g]!==undefined){c[g]=p[g]}r.removeClass({rowData:c,dataIndx:g,cls:"pq-cell-dirty",refresh:false})}}}}var y=[];for(var l=0;l<u;l++){var c=o[l].rowData;if(e.inArray(c,f)==-1){y.push(o[l])}}this.udata=y};n.commitDelete=function(t,n){var r=this.ddata,i=r.length,s=t.length,o=[];for(var u=0;u<i;u++){var a=r[u].rowData;for(var f=0;f<s;f++){var l=t[f];if(a[n]==l[n]){o.push(a)}}}var c=[];for(var u=0;u<i;u++){var a=r[u].rowData;if(e.inArray(a,o)==-1){c.push(r[u])}}this.ddata=c};n.commitUpdateAll=function(){var e=this.that,t=this.udata;for(var n=0,r=t.length;n<r;n++){var i=t[n],s=i.dataIndx,o=i.rowData;e.removeClass({rowData:o,dataIndx:s,cls:"pq-cell-dirty"})}this.udata=[]};n.commitAddAll=function(){this.adata=[]};n.commitDeleteAll=function(){this.ddata=[]};n.commit=function(e){var t=this.that,n=t.options.dataModel,r=n.recIndx;if(e==null){this.commitAddAll();this.commitUpdateAll();this.commitDeleteAll()}else{var i=e.type,s=e.rows;if(i=="add"){if(s){this.commitAdd(s,r)}else{this.commitAddAll()}}else{if(i=="update"){if(s){this.commitUpdate(s,r)}else{this.commitUpdateAll()}}else{if(i=="delete"){if(s){this.commitDelete(s,r)}else{this.commitDeleteAll()}}}}}t.refreshView()};n.rollbackAdd=function(e,t){var n=this.adata,r=e.type;for(var i=0,s=n.length;i<s;i++){var o=n[i],u=o.rowData;for(var a=0,f=t.length;a<f;a++){if(t[a]==u){var l=t.splice(a,1);if(l&&l.length&&r=="remote"){e.totalRecords--}break}}}this.adata=[]};n.rollbackDelete=function(e,t){var n=this.ddata,r=e.type;for(var i=n.length-1;i>=0;i--){var s=n[i],o=s.indx,u=s.rowData;t.splice(o,0,u);if(r=="remote"){e.totalRecords++}}this.ddata=[]};n.rollbackUpdate=function(e,t){var n=this.that,r=this.udata;for(var i=0,s=r.length;i<s;i++){var o=r[i],u=o.recId,a=o.rowData,f=o.dataIndx;if(u==null){continue}a[f]=o.oldVal;n.removeClass({rowData:a,dataIndx:f,cls:"pq-cell-dirty",refresh:false})}this.udata=[]};n.rollback=function(e){var t=this.that,n=t.options.dataModel,r=t.options.pageModel,i=e&&e.refresh!=null?e.refresh:true,s=e&&e.type!=null?e.type:null,o=n.data;if(s==null||s=="update"){this.rollbackUpdate(r,o)}if(s==null||s=="delete"){this.rollbackDelete(r,o)}if(s==null||s=="add"){this.rollbackAdd(r,o)}if(i){t.refreshView()}};var r=e.paramquery.pqGrid.prototype;r.getChanges=function(e){this.blurEditor({force:true});if(e){var t=e.format;if(t){if(t=="byVal"){return this.iUCData.getChangesValue()}else{if(t=="raw"){return this.iUCData.getChangesRaw()}}}}return this.iUCData.getChanges()};r.rollback=function(e){this.blurEditor({force:true});this.iUCData.rollback(e)};r.isDirty=function(){return this.iUCData.isDirty()};r.commit=function(e){this.blurEditor({force:true});this.iUCData.commit(e)};r._getRowIndx=function(){var e=this;var t=e.selection({type:"row",method:"getSelection"});if(t&&t.length>0){var n=t[0].rowIndx,r=e.rowIndxOffset,i=e.options.pageModel,s=i.type,o=n-r,u=i.rPP;if(s){if(o>=0&&o<u){return n}}else{return n}}else{return null}};r.updateRow=function(e){var t=this,n=t.options,r=n.track,r=e.track!=null?e.track:r,i=e.rowIndx,s=e.row,o=false,u=t.getRowData({rowIndx:i});var a={rowData:u};for(var f in s){var l=u[f],c=s[f];if(c!==l){o=true;if(r){a.dataIndx=f;a.oldVal=l;a.newVal=c;this.iUCData.update(a)}u[f]=c}}if(o){t.refreshRow({rowIndx:i})}};r._fillForm=function(e){var t=this,n=t.options.dataModel,r=t.options.pageModel,i=r.type,s=n.data,o=t.colModel,u=t.rowIndxOffset,a=e.rowIndxPage==null?e.rowIndx-u:e.rowIndxPage,f=e.rowIndx==null?a+u:e.rowIndx,l=i=="remote"?a:f,c=s[l];this.rowData=c;this.$crudDialog.dialog("option","title","Edit Record ("+(f+1)+")");var h=this.$crudForm;for(var p=0;p<o.length;p++){var d=o[p],v=d.dataIndx,m=c[v];h.find("*[name='"+v+"']").val(m)}};r.getRecId=function(e){var t=this,n=t.options.dataModel;e.dataIndx=n.recIndx;var r=t.getCellData(e);return r};r.getCellData=function(e){var t=this.getRowData(e),n=e.dataIndx;return t[n]};r.getRowData=function(e){var t=e.rowData;if(t!=null){return t}var n=this.options,r=n.dataModel,i=n.pageModel,s=i.type,o=r.recIndx,u=e.recId,a=r.data;if(u!=null){for(var f=0,l=a.length;f<l;f++){var c=a[f];if(c[o]==u){return c}}}else{var h=e.rowIndx,p=e.rowIndxPage,d=this.rowIndxOffset,h=h!=null?h:p+d,p=p!=null?p:h-d,v=s=="remote"?p:h,c=a[v];return c}};r.deleteRow=function(e){var t=this,n=e.rowIndx,r=e.effect,i=t.options,s=i.dataModel,o=i.pageModel,u=o.type;if(n!=null){var a=u=="remote"?n-this.rowIndxOffset:n,f=s.data,l=i.track,l=e.track!=null?e.track:l;if(l){this.iUCData["delete"]({rowIndx:n})}if(r){var t=this,c=this.getRow({rowIndx:n});if(c){c.effect("fade",null,350,function(){var n=e.complete;if(n&&typeof n=="function"){n.call(t.element[0])}var r=f.splice(a,1);if(r&&r.length&&u=="remote"){o.totalRecords--}t.refreshView()})}}else{var h=f.splice(a,1);if(h&&h.length&&u=="remote"){o.totalRecords--}this.refreshView()}}};r.addRow=function(e){var t=this;return t._addLocal(e)};r._addLocal=function(e){var t=this,n=e.rowData,r=e.rowIndx,i=e.rowIndxPage,s=t.options,o=s.dataModel,u=s.pageModel,a=u.type,f=s.track,f=e.track!=null?e.track:f,l=o.data;if(n==null){return null}if(l==null){o.data=[];l=o.data}if(f){this.iUCData.add({rowData:n})}if(r==null&&i==null){l.push(n)}else{var c=this.rowIndxOffset,r=r==null?i+c:r,i=i==null?r-c:i,h=a=="remote"?i:r;l.splice(h,0,n)}if(a=="remote"){u.totalRecords++}if(!e.refresh!==false){this.refreshView()}if(r==null){return l.length-1}else{return r}};r._addRemote=function(e){var t=this,n=e.rowData;n.pq_oper="add";t.options.dataModel.postDataOnce=n}})(jQuery);(function(e){var t={};t.options={items:[],gridInstance:null};t._create=function(){var t=this,n=this.options,r=n.gridInstance,i=r.colModel,s=n.items,o=this.element,u=o.closest(".pq-grid");o.addClass("pq-toolbar");for(var a=0,f=s.length;a<f;a++){var l=s[a],c=l.type,h=l.icon,n=l.options,p=l.label,d=l.listeners,v=l.cls,m="ui-corner-all "+(v?v:""),g=l.style,y=g?'style="'+g+'"':"",b=l.attr,w=b?b:"",E;if(c=="textbox"){E=e("<input type='text' class='"+m+"' "+w+" "+y+">").appendTo(o)}else{if(c=="checkbox"){E=e("<input type='checkbox' class='"+m+"' "+w+" "+y+">").appendTo(o)}else{if(c=="separator"){e("<span class='pq-separator '"+m+"' "+w+" "+y+"></span>").appendTo(o)}else{if(c=="button"){E=e("<button type='button' class='"+m+"' "+w+" "+y+">"+p+"</button>").button({text:p?true:false,icons:{primary:h}}).appendTo(o)}else{if(c=="select"){var n=l.options?l.options:[];if(typeof n==="function"){n=n.call(r.element[0],{colModel:i})}S=e.paramquery.select({options:n,attr:" class='"+m+"' "+w+" "+y,prepend:l.prepend,groupIndx:l.groupIndx,valueIndx:l.valueIndx,labelIndx:l.labelIndx});E=e(S).appendTo(o)}else{if(typeof c=="string"){E=e(c).appendTo(o)}else{if(typeof c=="function"){var S=c.call(r.element[0],{colModel:i,cls:m});E=e(S).appendTo(o)}}}}}}}if(d){for(var x=0;x<d.length;x++){var T=d[x];for(var N in T){E.bind(N,T[N])}}}}};t._destroy=function(){this.element.empty().removeClass("pq-toolbar").enableSelection()};t._disable=function(){if(this.$disable==null){this.$disable=e("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element)}};t._enable=function(){if(this.$disable){this.element[0].removeChild(this.$disable[0]);this.$disable=null}};t._setOption=function(e,t){if(e=="disabled"){if(t==true){this._disable()}else{this._enable()}}};e.widget("paramquery.pqToolbar",t)})(jQuery);(function(e){var t=function(){this.focusSelection=null};var n=t.prototype;n.getOldRowSel=function(){var e=this.that,t;if((t=this.focusSelection)&&this.isSelected(t)){var n=e.getRowIndx(t);n.rowData=t.rowData;return n}};n.getOldCellSel=function(){var e=this.that,t;if((t=this.focusSelection)&&this.isSelected(t)){var n=t.rowData;var r=e.getRowIndx({rowData:n});r.rowData=n;r.dataIndx=t.dataIndx;return r}};n.getNewRowSel=function(){var t=this.that,n=document.activeElement?e(document.activeElement):null;if(n&&n.hasClass("pq-grid-row")){var r=n.closest(".pq-grid");if(r[0]==t.element[0]){var i=t.getRowIndx({$tr:n});i.$tr=n;return i}}};n.getNewCellSel=function(){var t=this.that,n=document.activeElement?e(document.activeElement):null;if(n&&n.hasClass("pq-grid-cell")){var r=n.closest(".pq-grid");if(r[0]==t.element[0]){var i=t.getCellIndices({$td:n});i.$td=n;return i}}};n.getFocusSelection=function(e){if(this instanceof r){if(e&&e.old===true){return this.getOldRowSel()}else{return this.getNewRowSel()}}else{if(this instanceof i){if(e&&e.old===true){return this.getOldCellSel()}else{return this.getNewCellSel()}}}};n.getFirstSelection=function(){var e=this.firstSelection;if(e&&this.isSelected(e)){return e}else{this.refresh();var t=this.selection;if(t.length){this.firstSelection=t[0];return t[0]}}};n.getLastSelection=function(){var e=this.lastSelection;if(e){var t=this.that,n=e.rowData,r=t.getRowData({rowIndx:rowIndx});if(n==r&&this.isSelected(e)){return e}else{return false}}else{return null}};n.getLastSelectionCurPage=function(){var e=this.lastSelection;if(e&&this.isSelected(e)){var t=e.rowIndx,n=this.that.options.pageModel;if(n.type){var r=n.curPage,i=n.rPP;if(Math.ceil((t+1)/i)==r){return e}else{return null}}else{return e}}else{return null}};n.getSelection=function(){this.refresh();return this.selection};n.getSelectionCurPage=function(){var e=this.that,t=this.getSelection(),n=[],r=e.options,i=r.dataModel,s=r.pageModel;if(s.type){var o=i.curPage,u=i.rPP;for(var a=0;a<t.length;a++){var f=t[a],l=f.rowIndx;if(Math.ceil((l+1)/u)==o){n.push(f)}}return n}else{return t}};n.inViewRow=function(e){var t=this.that,n=this.options,r=n.groupModel,i=t.rowIndxOffset,s=n.freezeRows;var o=t.initV,u=t.finalV;if(e<s){return true}if(r){var a=t.dataGM;if(a&&a.length){for(var f=o;f<u;f++){var l=a[f],c=l.rowIndx-i;if(c!=null&&c==e){return true}}}return false}else{return e>=o&&e<=u}};n.setDirty=function(){};var r=function(e){this.that=e;this.options=e.options;this.selection=[]};e.paramquery.cRows=r;var i=function(e){this.options=e.options;this.that=e;this.selection=[]};e.paramquery.cCells=i;var s=i.prototype=new t;var o=r.prototype=new t;o.extendSelection=function(e){var t=this.that,n=e.rowIndx,r=t.options.selectionModel.mode,i=e.evt;var s=this.getFirstSelection();if(s==null){t.setSelection({rowIndx:n});return}if(r!="single"){var o=s.rowIndx,u=o,a=n;if(o>n){u=n;a=o}this.selectRange({initRowIndx:u,finalRowIndx:a,evt:i});this.add({rowIndx:n})}};o.refresh=function(){this.selection=[];var e=this.that,t=e.options,n=t.dataModel,r=t.pageModel,i=r.type,s=i=="remote"?true:false,o=e.rowIndxOffset,u=n.data;if(!u){return}for(var a=0,f=u.length;a<f;a++){var l=u[a];if(l.pq_rowselect){var c=s?a+o:a;this.selection.push({rowIndx:c,rowData:l})}}};o.replace=function(e){var t=e.rowIndx,n=e.offset==null?this.that.getRowIndxOffset():e.offset,r=t-n,i=e.$tr,s=e.evt;e.offset=n;e.rowIndxPage=r;this.removeAll({raiseEvent:true});this.add(e)};o.indexOf=function(e){this.refresh();var t=e.rowIndx,n=this.selection;for(var r=0;r<n.length;r++){if(n[r].rowIndx==t){return r}}return-1};o.isSelected=function(e){var t=this.that,n=t.getRowData(e);return n?n.pq_rowselect==null?false:n.pq_rowselect:null};o._boundRow=function(e){var t=e.rowIndxPage,n=this.that,r=e.$tr==null?n.getRow({rowIndxPage:t}):e.$tr;if(r==null||r.length==0){return false}r.addClass("pq-row-select ui-state-highlight");return r};o.selectRange=function(e){var t=this.that,n=e.initRowIndx,r=e.finalRowIndx,i=e.evt,s=this.getSelection(),o=s.slice(0);for(var u=0;u<o.length;u++){var a=o[u],f=a.rowIndx;if(f<n||f>r){this.remove({rowIndx:f})}}if(n>r){var l=n;n=r;r=l}for(var f=n;f<=r;f++){this.add({rowIndx:f,focus:false})}};s._addToData=function(e){var t=e.dataIndx,n=this.that.getRowData(e);if(!n.pq_cellselect){n.pq_cellselect={}}n.pq_cellselect[t]=true};s.extendSelection=function(e){var t=this.that,n=this.getFirstSelection(),r=e.rowIndx,i=e.colIndx,s=t.options.selectionModel.mode,o=e.evt;if(n==null){t.setSelection({rowIndx:r,colIndx:i});return}var u=n.rowIndx,a=t.getColIndx({dataIndx:n.dataIndx}),f=u,l=r,c=a,h=i;if(u>r){f=r;l=u}if(s=="range"){if(u>r){c=i;h=a}if(r==u&&i<a){c=i;h=a}this.selectRange({initRowIndx:f,initColIndx:c,finalRowIndx:l,finalColIndx:h,evt:o});this.add({rowIndx:r,colIndx:i})}else{if(s=="block"){if(a>i){c=i;h=a}this.selectBlock({initRowIndx:f,initColIndx:c,finalRowIndx:l,finalColIndx:h,evt:o});this.add({rowIndx:r,colIndx:i})}}};s._removeFromData=function(e){var t=e.rowData;if(t&&t.pq_cellselect){delete t.pq_cellselect[e.dataIndx]}};s.removeAll=function(){this.refresh();var e=this.selection.slice(0);this.remove({cells:e});this.lastSelection=null};o.removeAll=function(e){var t=this.that,n=e?e.page:false;this.refresh();var r=this.selection.slice(0);if(n){var i=[],s=t.rowIndxOffset,o=t.data,u=o?o.length:0;for(var a=0,f=r.length;a<f;a++){var l=r[a],c=l.rowIndx,h=c-s;if(h>=0){if(h<u){i.push(l)}else{break}}}this.remove({rows:i})}else{this.remove({rows:r});this.lastSelection=null}};s.isSelected=function(e){var t=this.that,n=t.getRowData(e),r=e.dataIndx,r=r==null?t.colModel[e.colIndx].dataIndx:r;if(n==null){return null}if(n.pq_cellselect){if(n.pq_cellselect[r]){return true}}return false};s.refresh=function(){this.selection=[];var e=this.that,t=e.options.dataModel,n=e.options.pageModel,r=t.data,i=n.type,s=i=="remote"?true:false,o=e.rowIndxOffset;if(!r){return}for(var u=0,a=r.length;u<a;u++){var f=r[u];var l=f.pq_cellselect;if(l){var c=s?u+o:u;for(var h in l){if(l[h]){this.selection.push({rowIndx:c,rowData:f,dataIndx:h})}}}}this.isDirty=false};s.replace=function(e){var t=e.rowIndx,n=e.colIndx,r=e.offset==null?this.that.getRowIndxOffset():e.offset,i=t-r,s=e.$td,o=e.evt;e.rowIndxPage=i;e.offset=r;this.removeAll({raiseEvent:true});this.add(e)};s.inViewCell=function(e,t){var n=this.that,r=this.options,i=r.freezeCols;if(this.inViewRow(e)){return t<i||t>=n.initH&&t<=n.finalH}else{return false}};s._add=function(e){var t=this.that,n=e.rowIndx,r=e.rowIndxPage,i=e.rowData,s=t.rowIndxOffset,o,n=n==null?r+s:n,r=r==null?n-s:r,i=i==null?t.getRowData(e):i,u=e.colIndx,a=e.dataIndx,u=u==null?t.getColIndx({dataIndx:a}):u,f=t.colModel[u],a=a==null?f.dataIndx:a,l=e.evt,c=this.isSelected({rowData:i,dataIndx:a});if(c==null){return false}var h=this.inViewCell(r,u);if(c===false){if(h){var p=t.getCell({rowIndxPage:r,colIndx:u});if(p){p.addClass("pq-cell-select ui-state-highlight")}}this._addToData({rowData:i,dataIndx:a});if(e.trigger!==false){t._trigger("cellSelect",l,{rowIndx:n,rowIndxPage:r,colIndx:u,dataIndx:a,column:f,rowData:i})}o=true}this.lastSelection={rowIndx:n,dataIndx:a,rowData:i};if(e.focus!==false&&h){if(!p||!p.length){p=t.getCell({rowIndxPage:r,dataIndx:a})}if(p&&p.length){p.attr("tabindex","0");p.focus();t._fixTableViewPort();this.focusSelection={rowData:i,rowIndx:n,dataIndx:a}}}if(e.setFirst){this.firstSelection={rowIndx:n,rowData:i,dataIndx:a}}if(o){return{rowIndx:n,rowData:i,dataIndx:a,colIndx:u,column:f}}};o._add=function(t){var n=this.that,r,i=t.rowIndx,s=t.rowIndxPage,o=n.rowIndxOffset,i=i==null?s+o:i,s=s==null?i-o:s,u=u==null?n.getRowData(t):u,a=t.$tr,f=t.evt,l=this.isSelected({rowData:u});t.rowIndxPage=s;if(l==null){return false}var c=this.inViewRow(s);if(l===false){if(c){var h=this._boundRow(t),a=h}u.pq_rowselect=true;if(t.trigger!==false){n._trigger("rowSelect",f,{rowIndx:i,rowIndxPage:s,rowData:u,$tr:a})}r=true}this.lastSelection={rowIndx:i,rowData:u};if(t.focus!==false&&c){if(!a||!a.length){a=n.getRow({rowIndxPage:s})}if(a){a=e(a[0]);a.attr("tabindex","0");a.focus();n._fixTableViewPort();this.focusSelection={rowData:u,rowIndx:i}}}if(t.setFirst){this.firstSelection={rowIndx:i,rowData:u}}if(r){return{rowIndx:i,rowData:u}}};s.add=function(e){var t=this.that,n=e.evt,r=e.cells,i=[];if(r&&typeof r.push=="function"){for(var s=0,o=r.length;s<o;s++){var u=r[s];u.trigger=false;var a=this._add(u);if(a){i.push(a)}}if(i.length){t._trigger("cellSelect",n,{cells:i})}}else{this._add(e)}t._fixIE()};o.add=function(e){var t=this.that,n=e.evt,r=e.rows,i=[];if(r&&typeof r.push=="function"){for(var s=0,o=r.length;s<o;s++){var u=r[s];u.trigger=false;var a=this._add(u);if(a){i.push(a)}}if(i.length){t._trigger("rowSelect",n,{rows:i})}}else{this._add(e)}};s._remove=function(e){var t=this.that,n=e.rowIndx,r=e.rowIndxPage,i=t.rowIndxOffset,n=n==null?r+i:n,r=r==null?n-i:r,s=e.rowData,s=s==null?t.getRowData(e):s,o=e.colIndx,u=e.dataIndx,o=o==null?t.getColIndx({dataIndx:u}):o,a=t.colModel[o],u=u==null?a.dataIndx:u,f=e.evt,l=this.isSelected({rowData:s,dataIndx:u});if(l){if(this.inViewCell(r,o)){var c=t.getCell({rowIndxPage:r,colIndx:o,all:true});if(c){c.removeClass("pq-cell-select ui-state-highlight");c.removeAttr("tabindex")}}this._removeFromData({rowData:s,dataIndx:u});if(e.trigger!==false){t._trigger("cellUnSelect",f,{rowIndx:n,colIndx:o,dataIndx:u,rowData:s})}return{rowIndx:n,rowData:s,dataIndx:u,colIndx:o,column:a}}};o._remove=function(e){var t=this.that,n=e.rowIndx,r=e.rowIndxPage,i=t.rowIndxOffset,n=n==null?r+i:n,r=r==null?n-i:r,s=e.rowData,s=s==null?t.getRowData(e):s,o=e.$tr,u=e.evt,a=this.isSelected({rowData:s});if(a){if(this.inViewRow(r)){var o=t.getRow({rowIndxPage:r});if(o){o.removeClass("pq-row-select ui-state-highlight");o.removeAttr("tabindex")}}s.pq_rowselect=false;if(e.trigger!==false){t._trigger("rowUnSelect",u,{rowIndx:n,rowData:s,$tr:o})}return{rowIndx:n,rowData:s}}};s.remove=function(e){var t=e.cells;if(t&&typeof t.push=="function"){var n=[];for(var r=0,i=t.length;r<i;r++){var s=t[r];s.trigger=false;var o=this._remove(s);if(o){n.push(o)}}if(n.length){this.that._trigger("cellUnSelect",e.evt,{cells:n})}}else{this._remove(e)}};o.remove=function(e){var t=e.rows;if(t&&typeof t.push=="function"){var n=[];for(var r=0,i=t.length;r<i;r++){var s=t[r];s.trigger=false;var o=this._remove(s);if(o){n.push(o)}}if(n.length){this.that._trigger("rowUnSelect",e.evt,{rows:n})}}else{this._remove(e)}};s.indexOf=function(e){this.refresh();var t=e.rowIndx,n=this.that,r=e.dataIndx==null?n.colModel[e.colIndx].dataIndx:e.dataIndx;e.dataIndx=r;var i=this.selection;for(var s=0;s<i.length;s++){var o=i[s];if(o.rowIndx==t&&o.dataIndx==r){return s}}return-1};s.selectAll=function(e){var t=this.that,n=e&&e.all?true:false,r=n?this.options.dataModel.data:t.data,i=t.rowIndxOffset,s=t.colModel,o=s.length,u=[],a=function(e,t){for(var n=0;n<o;n++){var r=s[n];if(r.hidden){continue}var i={rowIndx:t,rowData:e,colIndx:n,dataIndx:r.dataIndx,focus:false};u.push(i)}};if(!r){return}for(var f=0,l=r.length;f<l;f++){var c=r[f]}if(n){var h=this.options.pageModel.type,p=h=="remote"?true:false;for(var f=0,l=r.length;f<l;f++){var c=r[f],d=f;if(p){d=f+i}a(c,d)}}else{for(var f=0,l=r.length;f<l;f++){var c=r[f],v=f,d=v+i;a(c,d)}}this.add({cells:u})};o.selectAll=function(e){var t=this.that,n=e&&e.all?true:false,r=n?this.options.dataModel.data:t.data,i=[];if(!r){return}if(n){var s=this.options.pageModel.type,o=s=="remote"?true:false;for(var u=0,a=r.length;u<a;u++){var f={rowData:r[u],focus:false};if(o){f.rowIndxPage=u}else{f.rowIndx=u}i.push(f)}}else{for(var u=0,a=r.length;u<a;u++){var l=r[u];i.push({rowIndxPage:u,rowData:l,focus:false})}}this.add({rows:i})};s.selectRange=function(e){var t=this.that,n=e.initRowIndx,r=e.initColIndx,i=e.finalRowIndx,s=e.finalColIndx,o=this.getSelection(),u=o.slice(0);for(var a=0;a<u.length;a++){var f=u[a],l=f.rowIndx,c=f.dataIndx,h=t.getColIndx({dataIndx:c});if(l<n||l>i){this.remove({rowIndx:l,colIndx:h,dataIndx:c})}else{if(l==n&&h<r){this.remove({rowIndx:l,colIndx:h,dataIndx:c})}else{if(l==i&&h>s){this.remove({rowIndx:l,colIndx:h,dataIndx:c})}}}}for(var h=0;h<t.colModel.length;h++){var p=t.colModel[h];if(p.hidden){continue}var c=p.dataIndx;var l=n;do{if(l==n&&h<r){}else{if(l==i&&h>s){break}else{this.add({rowIndx:l,colIndx:h,dataIndx:c,focus:false})}}l++}while(l<=i)}};s.selectBlock=function(e){var t=this.that,n=e.initRowIndx,r=e.initColIndx,i=e.finalRowIndx,s=e.finalColIndx,o=this.getSelection(),u=o.slice(0);for(var a=0;a<u.length;a++){var f=u[a],l=f.rowIndx,c=f.dataIndx,h=t.getColIndx({dataIndx:c});if(h<r||h>s){this.remove({rowIndx:l,dataIndx:c,colIndx:h})}else{if(l<n||l>i){this.remove({rowIndx:l,dataIndx:c,colIndx:h})}}}var p=[],d=t.colModel;for(var h=r;h<=s;h++){var v=d[h];var c=v.dataIndx;if(v.hidden){continue}var l=n;do{p.push({rowIndx:l,colIndx:h,dataIndx:c,focus:false});l++}while(l<=i);this.add({cells:p})}}})(jQuery);(function(e){var t=e.paramquery.cCheckBoxColumn=function(e,t){var n=this;this.that=e;this.options=e.options;this.type="checkBoxSelection";this.cbDataIndx=t;var r=e.widgetEventPrefix.toLowerCase(),i=e.element,s=e.eventNamespace;i.on(r+"dataavailable"+s,function(e,t){if(n.belongs(e)){return n._onDataAvailable(e,t)}});i.on(r+"cellclick"+s,function(e,t){if(n.belongs(e)){return n.cellClick(e,t)}});i.on(r+"rowselect"+s,function(e,t){if(n.belongs(e)){return n.rowSelect(e,t)}});i.on(r+"rowunselect"+s,function(e,t){if(n.belongs(e)){return n.rowUnSelect(e,t)}});i.on(r+"cellkeydown"+s,function(e,t){if(n.belongs(e)){return n.cellKeyDown(e,t)}});i.on(r+"refreshheader"+s,function(e,t){if(n.belongs(e)){return n.refreshHeader(e,t)}})};var n=t.prototype=new e.paramquery.cClass;n.hasHeaderChkBox=function(){var e=this.options.selectionModel;if(e.cbHeader===false){return false}else{return true}};n.setValCBox=function(){if(!this.hasHeaderChkBox()){return}var e=this.that,t=this.options,n=t.selectionModel.cbAll,r=n?t.dataModel.data:e.data,i=null,s=0,o=0;for(var u=0,a=r.length;u<a;u++){var f=r[u];if(f.pq_rowselect){s++}else{o++}}if(s==a){i=true}else{if(o==a){i=false}}this.$inp.pqval({val:i})};n.refreshHeader=function(t,n){if(!this.hasHeaderChkBox()){return}var r=this.that,i=r.data;if(!i){return}var s=this,o=r.getCellHeader({dataIndx:this.cbDataIndx});o.html("<input type='checkbox'/>");var u=this.$inp=o.find("input").click(function(t){if(e(this).is(":checked")){s.selectAllRows()}else{s.unSelectAllRows()}t.stopPropagation()});this.setValCBox()};n.selectAllRows=function(){var e=this.that,t=this.options.selectionModel.cbAll;e.iRows.selectAll({all:t})};n.unSelectAllRows=function(){var e=this.that,t=this.options.selectionModel.cbAll;if(t){e.iRows.removeAll()}else{e.iRows.removeAll({page:true})}};n._onDataAvailable=function(){var e=this.that,t=this.options.dataModel.data,n=this._findSelectionIndx();if(n!=null&&t){for(var r=0,i=t.length;r<i;r++){var s=t[r];if(s[n]){s.pq_rowselect=true}}}};n._findSelectionIndx=function(){if(this.cbDataIndx){return this.cbDataIndx}};n.cellClick=function(e,t){var n=this.that,r=t.rowIndx,i=t.rowData,s=t.column,o=this.type;if(s&&s.type===o){var u=s.dataIndx;if(!i[u]){n.iRows.add({rowIndx:r})}else{n.iRows.remove({rowIndx:r})}e.stopPropagation();return false}};n.rowSelect=function(e,t){var n=this.that,r=t.rows,i=t.rowData,s=this._findSelectionIndx();if(r){for(var o=0,u=r.length;o<u;o++){var a=r[o],f=a.rowIndx,i=a.rowData;i[s]=true;n.refreshCell({rowIndx:f,dataIndx:s})}}else{if(i){i[s]=true;f=t.rowIndx,n.refreshCell({rowIndx:f,dataIndx:s})}}this.setValCBox()};n.rowUnSelect=function(e,t){var n=this.that,r=t.rows,i=t.rowData,s=this._findSelectionIndx();if(r){for(var o=0,u=r.length;o<u;o++){var a=r[o],f=a.rowIndx,i=a.rowData;i[s]=false;n.refreshCell({rowIndx:f,dataIndx:s})}}else{if(i){i[s]=false;f=t.rowIndx,n.refreshCell({rowIndx:f,dataIndx:s})}}this.setValCBox()};n.cellKeyDown=function(e,t){var n=this.that,r=t.rowIndx,i=t.column,s=s,o=this.type;if(i&&i.type===o){var u=i.dataIndx,r=t.rowIndx;if(e.keyCode==13||e.keyCode==32){if(!s[u]){n.selection({type:"row",method:"add",rowIndx:r})}else{n.selection({type:"row",method:"remove",rowIndx:r})}e.stopPropagation();e.preventDefault();return false}}}})(jQuery);(function(e){function t(e){this.that=e;var t=this,n=e.element,r=e.widgetEventPrefix.toLowerCase(),i=e.eventNamespace;n.on(r+"contmousedown"+i,function(e,n){if(t.belongs(e)){return t._onContMouseDown(e,n)}});n.on(r+"mousedrag"+i,function(e,n){if(t.belongs(e)&&t.swipedown){return t._onMouseDrag(e,n)}});n.on(r+"mousestop"+i,function(e,n){return t._onMouseStop(e,n)});n.on(r+"rowmousedown"+i,function(e,n){if(t.belongs(e)){return t._onRowMouseDown(e,n)}});n.on(r+"cellmousedown"+i,function(e,n){if(t.belongs(e)){return t._onCellMouseDown(e,n)}});n.on(r+"beforetableview"+i,function(e,n){if(t.belongs(e)){return t._beforeTableView(e,n)}});n.on(r+"refresh"+i,function(e,n){if(t.belongs(e)){return t._onRefresh(e,n)}})}e.paramquery.cMouseSelection=t;var n=t.prototype=new e.paramquery.cClass;n._beforeTableView=function(e,t){var n=this.that,r=n.getFocusElement();this.lastFocus=null;if(r&&r.$grid){var i=r.$ae;if(i.hasClass("pq-grid-row")){var s=n.getRowIndx({$tr:i});this.lastFocus=s}else{if(i.hasClass("pq-grid-cell")){var s=n.getCellIndices({$td:i});this.lastFocus=s}}}};n._onRefresh=function(e,t){var n=this.that,r=this.lastFocus,i;if(r){if(r.dataIndx!=null){i=n.getCell(r)}else{i=n.getRow(r)}if(i&&i.length){if(n.inViewPort(i)){i.attr("tabindex","0").focus()}return}}return};n._onCellMouseDown=function(e,t){var n=this.that,r=t.rowIndx,i=t.colIndx,s=n.options.selectionModel,o=s.type,u=s.mode;if(o!="cell"){return}if(i==null){return}if(e.shiftKey){n.iCells.extendSelection({rowIndx:r,colIndx:i,mode:u,evt:e});e.preventDefault()}else{if(e.ctrlKey&&u!="single"){if(n.iCells.isSelected({rowIndx:r,colIndx:i})){n.iCells.remove({rowIndx:r,colIndx:i})}else{n.setSelection({rowIndx:r,colIndx:i})}}else{this.mousedown={rowIndx:r,colIndx:i};n.setSelection(null);n.setSelection({rowIndx:r,colIndx:i,setFirst:true})}}return true};n._onRowMouseDown=function(e,t){var n=this.that,r=this,i=t.rowIndx,s=n.options.selectionModel,o=s.mode,u=s.type;if(u!="row"){return}if(i==null){return}if(e.shiftKey){n.iRows.extendSelection({rowIndx:i,evt:e});e.preventDefault()}else{if(e.ctrlKey&&o!="single"){if(n.iRows.isSelected({rowIndx:i})){n.iRows.remove({rowIndx:i})}else{n.setSelection({rowIndx:i})}}else{this.mousedown={r1:i,y1:e.pageY,x1:e.pageX};n.setSelection(null);n.setSelection({rowIndx:i,setFirst:true})}}return true};n._onContMouseDown=function(e,t){var n=this.that,r=n.options.swipeModel,i=r.on;if(i){this._stopSwipe(true);this.swipedown={x:e.pageX,y:e.pageY}}return true};n._stopSwipe=function(e){var t=this;if(e){t.swipedown=null;t.swipedownPrev=null}window.clearInterval(t.intID);t.intID=null};n._onMouseStop=function(t,n){var r=this,i=this.that,s=e.paramquery;if(this.swipedownPrev){var o=i.options.swipeModel,u=this.swipedownPrev,a=u.ts,f=(new Date).getTime(),l=f-a,c=u.x,h=u.y,p=t.pageX,d=t.pageY,v=p-c,m=d-h,g=Math.sqrt(v*v+m*m),y=g/l;if(y>o.ratio){var b=0,w=o.repeat;r._stopSwipe();r.intID=window.setInterval(function(){b+=o.speed;w--;if(w<=0){r._stopSwipe(true)}var e=p+b*v/l,t=d+b*m/l;r._onMouseDrag({pageX:e,pageY:t})},50)}else{r.swipedown=null;r.swipedownPrev=null}}};n._onMouseDrag=function(t,n){var r=this.that,i=e.paramquery,s=r.options;if(this.swipedown){var o=this.swipedown,u=o.x,a=o.y,f=t.pageX,l=t.pageY;this.swipedownPrev={x:u,y:a,ts:(new Date).getTime()};if(r.$td_edit){r.quitEditMode({silent:true})}if(!s.virtualY){this._scrollVertSmooth(a,l);r._syncScrollBarVert()}if(!s.virtualX){this._scrollHorSmooth(u,f);r._syncScrollBarHor()}o.x=f;o.y=l}return true};n.updateTableY=function(e){if(e==0){return false}var t=this.that,n=t.getTableForVertScroll(),r=t.$cont,i=t._getScollBarHorizontalHeight(),s=r.data("offsetHeight")-i;if(!n||!n.length){return false}var o=n.data("offsetHeight"),u=parseInt(n.css("marginTop"))+e;if(u>=0){n.css({marginTop:-1})}else{if(e<0&&s-o-u>0){if(s-n[0].offsetHeight-u>0){var a=s-n[0].offsetHeight;if(a<0){n.css({marginTop:a})}}else{n.css({marginTop:u})}}else{n.css({marginTop:u})}}return true};n._scrollVertSmooth=function(e,t){if(e==t){return}this.updateTableY(t-e)};n._scrollHorSmooth=function(e,t){if(e==t){return}var n=this.that,r=t-e,i=n.getTableForHorScroll(),s=n.getTableHeaderForHorScroll(),o=n.$cont,u=n._getSBWidth(),a=o.data("offsetWidth")-u;if(!i&&!s){return}var f=i?i:s,l=f.data("scrollWidth"),c=parseInt(f.css("marginLeft"))+r;if(c>0){if(i){i.css({marginLeft:0})}if(s){s.css({marginLeft:0})}}else{if(a-l-c>0){if(a-l<=0){if(i){i.css("marginLeft",a-l)}if(s){s.css("marginLeft",a-l)}}}else{if(i){i.css("marginLeft",c)}if(s){s.css("marginLeft",c)}}}}})(jQuery);(function(e){var t=function(e,t){this.that=e;this.$ae=t};var n=t.prototype;n.createClipBoard=function(){var t=this.$ae,n=e("textarea#pq-grid-excel");if(n.length==0){n=e("<textarea id='pq-grid-excel' />").appendTo(document.body)}var r=t.offset(),i=r.left,s=r.top;n.css({position:"absolute",left:i,top:s,display:"",height:1,width:1,borderWidth:0});n.focus()};n.destroyClipBoard=function(){var t=e("textarea#pq-grid-excel");if(t.length){var n=document.activeElement;if(n==t[0]){this.$ae.focus()}t.css("display","none")}};n.clearClipBoard=function(){var t=e("textarea#pq-grid-excel");t.val("")};n.copy=function(){var t=e("textarea#pq-grid-excel");var n=this.that,r=n.colModel,i=r.length,s=n.options.selectionModel.type,o=[],u=[];o=n.iRows.getSelection();for(var a=0,f=o.length;a<f;a++){var l=o[a],c=n.getRowData(l),h=[];for(var p=0;p<i;p++){var d=r[p];if(d.hidden){continue}h.push(c[d.dataIndx])}var v=h.join("	");u.push(v)}o=n.iCells.getSelection();var c=null,m=null,g=null,h=[];for(var a=0,f=o.length;a<f;a++){var l=o[a],m=l.rowIndx;if(m==g){continue}var c=n.getRowData(l);for(var p=0;p<i;p++){var d=r[p];if(d.hidden){continue}var y=d.dataIndx;if(n.iCells.isSelected({rowData:c,dataIndx:y})){h.push(c[y])}else{}}var v=h.join("	");h=[];u.push(v);g=m}t.val(u.join("\n"));t.select()};var r=null;e(window).unbind(".pqExcel").bind("keydown.pqExcel",function(n){if(n.ctrlKey){var i=e(document.activeElement);if(!i.hasClass("pq-grid-row")&&!i.hasClass("pq-grid-cell")&&!i.is("textarea#pq-grid-excel")){return}var s=i.closest(".pq-grid");if(r||i.length&&s.length){if(!r){try{var o=s.pqGrid("getThis").that}catch(u){return true}r=new t(o,i);r.createClipBoard()}if(n.keyCode=="67"||n.keyCode=="99"){r.copy()}else{var a=e("textarea#pq-grid-excel");if(a.length){var f=document.activeElement;if(f==a[0]){r.that._onKeyPressDown(n)}}}}}}).bind("keyup.pqExcel",function(e){if(r&&!e.ctrlKey&&e.keyCode==17){r.destroyClipBoard();r=null}})})(jQuery);(function(e){var t=e.ui.autocomplete.prototype;var n=t._renderMenu;var r=t._renderItem;t._renderMenu=function(t,r){n.call(this,t,r);var i=this.options,s=i.selectItem;if(s&&s.on){var o=s.cls,o=o===undefined?"ui-state-highlight":o;var u=this.element.val();if(u&&o){e("a",t).filter(function(){return e(this).text()===u}).addClass(o)}}};t._renderItem=function(e,t){var n=r.call(this,e,t);var i=this.options,s=i.highlightText;if(s&&s.on){var o=this.element.val();if(o){var u=new RegExp("("+o+")","i"),a=t.label;if(u.test(a)){var f=s.style,f=f===undefined?"font-weight:bold;":f,l=s.cls,l=l===undefined?"":l;a=a.replace(u,"<span style='"+f+"' class='"+l+"'>$1</span>");n.find("a").html(a)}}}return n}})(jQuery)